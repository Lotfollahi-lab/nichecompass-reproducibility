Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8838; val_auprc_score: 0.9712; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 294567.7912; train_edge_recon_loss: 1181771.2045; train_gene_expr_recon_loss: 44288766.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45765105.6364; train_optim_loss: 45765105.6364; val_kl_reg_loss: 269660.0312; val_edge_recon_loss: 1210934.4167; val_gene_expr_recon_loss: 44013385.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45493980.0000; val_optim_loss: 45493980.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8646; val_auprc_score: 0.9660; val_best_acc_score: 0.8612; val_best_f1_score: 0.9254; train_kl_reg_loss: 9306867.0284; train_edge_recon_loss: 1174988.8494; train_gene_expr_recon_loss: 284566091.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 295047950.5455; train_optim_loss: 295047950.5455; val_kl_reg_loss: 627265.7292; val_edge_recon_loss: 1113254.0000; val_gene_expr_recon_loss: 54188714.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55929234.6667; val_optim_loss: 55929234.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8533; val_auprc_score: 0.9595; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 865860.9545; train_edge_recon_loss: 1156859.4006; train_gene_expr_recon_loss: 54299126.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56321846.1818; train_optim_loss: 56321846.1818; val_kl_reg_loss: 1029698.8542; val_edge_recon_loss: 1167173.5000; val_gene_expr_recon_loss: 52191084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54387956.0000; val_optim_loss: 54387956.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8398; val_auprc_score: 0.9553; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 1397956.4432; train_edge_recon_loss: 1195700.4176; train_gene_expr_recon_loss: 60405022.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62998680.0000; train_optim_loss: 62998680.0000; val_kl_reg_loss: 1644520.4583; val_edge_recon_loss: 1155369.0000; val_gene_expr_recon_loss: 53106193.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55906082.6667; val_optim_loss: 55906082.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8433; val_auprc_score: 0.9560; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 1705425.9261; train_edge_recon_loss: 1198859.1989; train_gene_expr_recon_loss: 52469732.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55374018.1818; train_optim_loss: 55374018.1818; val_kl_reg_loss: 1675842.3333; val_edge_recon_loss: 1163007.6667; val_gene_expr_recon_loss: 52179660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55018510.6667; val_optim_loss: 55018510.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8287; val_auprc_score: 0.9518; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 1682554.1080; train_edge_recon_loss: 1192715.6648; train_gene_expr_recon_loss: 52071271.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54946541.2727; train_optim_loss: 54946541.2727; val_kl_reg_loss: 1657214.0417; val_edge_recon_loss: 1131012.2083; val_gene_expr_recon_loss: 52170852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54959078.6667; val_optim_loss: 54959078.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8345; val_auprc_score: 0.9526; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 1667315.8693; train_edge_recon_loss: 1224404.2898; train_gene_expr_recon_loss: 52015439.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54907159.4545; train_optim_loss: 54907159.4545; val_kl_reg_loss: 1655272.2500; val_edge_recon_loss: 1192895.6250; val_gene_expr_recon_loss: 52089528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54937696.0000; val_optim_loss: 54937696.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8449; val_auprc_score: 0.9552; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 1649622.5455; train_edge_recon_loss: 1205127.2102; train_gene_expr_recon_loss: 51999557.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54854307.2727; train_optim_loss: 54854307.2727; val_kl_reg_loss: 1625740.1250; val_edge_recon_loss: 1203930.7500; val_gene_expr_recon_loss: 51975037.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54804709.3333; val_optim_loss: 54804709.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8307; val_auprc_score: 0.9508; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 1634572.9148; train_edge_recon_loss: 1210766.6932; train_gene_expr_recon_loss: 51968371.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54813711.4545; train_optim_loss: 54813711.4545; val_kl_reg_loss: 1620755.8750; val_edge_recon_loss: 1205955.0000; val_gene_expr_recon_loss: 52008969.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54835681.3333; val_optim_loss: 54835681.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 5 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
val AUROC score: 0.8885
val AUPRC score: 0.9732
val best accuracy score: 0.8517
val best F1 score: 0.9199
val target rna MSE score: 25.2973
val source rna MSE score: 28.3700
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 1 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1482, n_latent: 1472, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1472, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1472, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9008; val_auprc_score: 0.9747; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 10733305.4088; train_edge_recon_loss: 1118682.7585; train_gene_expr_recon_loss: 353020548.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364872533.6364; train_optim_loss: 364872533.6364; val_kl_reg_loss: 403194.1979; val_edge_recon_loss: 1206126.5417; val_gene_expr_recon_loss: 60075857.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61685178.6667; val_optim_loss: 61685178.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8838; val_auprc_score: 0.9704; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 464948.2017; train_edge_recon_loss: 1197962.1932; train_gene_expr_recon_loss: 57032374.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58695284.9091; train_optim_loss: 58695284.9091; val_kl_reg_loss: 503910.3333; val_edge_recon_loss: 1184877.7917; val_gene_expr_recon_loss: 54900086.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56588876.0000; val_optim_loss: 56588876.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9056; val_auprc_score: 0.9771; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 514684.1420; train_edge_recon_loss: 1196520.8750; train_gene_expr_recon_loss: 53509744.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55220949.8182; train_optim_loss: 55220949.8182; val_kl_reg_loss: 507496.0000; val_edge_recon_loss: 1177326.7500; val_gene_expr_recon_loss: 52629853.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54314676.0000; val_optim_loss: 54314676.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8905; val_auprc_score: 0.9725; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 499699.7514; train_edge_recon_loss: 1183707.9858; train_gene_expr_recon_loss: 51598787.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53282194.9091; train_optim_loss: 53282194.9091; val_kl_reg_loss: 486357.2500; val_edge_recon_loss: 1166951.9167; val_gene_expr_recon_loss: 50759025.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52412334.6667; val_optim_loss: 52412334.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8986; val_auprc_score: 0.9759; val_best_acc_score: 0.8583; val_best_f1_score: 0.9237; train_kl_reg_loss: 477817.6946; train_edge_recon_loss: 1192301.0966; train_gene_expr_recon_loss: 49645303.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51315421.8182; train_optim_loss: 51315421.8182; val_kl_reg_loss: 462902.7083; val_edge_recon_loss: 1117957.3542; val_gene_expr_recon_loss: 48740918.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50321778.6667; val_optim_loss: 50321778.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8834; val_auprc_score: 0.9715; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 454245.4332; train_edge_recon_loss: 1208290.9830; train_gene_expr_recon_loss: 47566260.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49228797.6364; train_optim_loss: 49228797.6364; val_kl_reg_loss: 436727.0312; val_edge_recon_loss: 1221531.2917; val_gene_expr_recon_loss: 46574840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48233097.3333; val_optim_loss: 48233097.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8925; val_auprc_score: 0.9730; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 427650.9531; train_edge_recon_loss: 1184653.3239; train_gene_expr_recon_loss: 45448253.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47060558.0000; train_optim_loss: 47060558.0000; val_kl_reg_loss: 410042.1562; val_edge_recon_loss: 1224959.4583; val_gene_expr_recon_loss: 44567696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46202696.0000; val_optim_loss: 46202696.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8984; val_auprc_score: 0.9769; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 402402.6293; train_edge_recon_loss: 1203044.7898; train_gene_expr_recon_loss: 43643344.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45248792.0000; train_optim_loss: 45248792.0000; val_kl_reg_loss: 387011.6354; val_edge_recon_loss: 1158962.5833; val_gene_expr_recon_loss: 43087270.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44633245.3333; val_optim_loss: 44633245.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8946; val_auprc_score: 0.9748; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 377359.8097; train_edge_recon_loss: 1212211.4261; train_gene_expr_recon_loss: 42360709.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43950280.9091; train_optim_loss: 43950280.9091; val_kl_reg_loss: 361455.8021; val_edge_recon_loss: 1189147.4167; val_gene_expr_recon_loss: 41995005.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43545609.3333; val_optim_loss: 43545609.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8840; val_auprc_score: 0.9734; val_best_acc_score: 0.8580; val_best_f1_score: 0.9236; train_kl_reg_loss: 353262.8366; train_edge_recon_loss: 1168425.8324; train_gene_expr_recon_loss: 41323755.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42845444.7273; train_optim_loss: 42845444.7273; val_kl_reg_loss: 344315.8958; val_edge_recon_loss: 1162843.5417; val_gene_expr_recon_loss: 41180865.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42688025.3333; val_optim_loss: 42688025.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8843; val_auprc_score: 0.9724; val_best_acc_score: 0.8487; val_best_f1_score: 0.9182; train_kl_reg_loss: 334777.3651; train_edge_recon_loss: 1200170.9034; train_gene_expr_recon_loss: 40763593.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42298541.4545; train_optim_loss: 42298541.4545; val_kl_reg_loss: 315607.7500; val_edge_recon_loss: 1214007.7500; val_gene_expr_recon_loss: 40741284.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42270898.6667; val_optim_loss: 42270898.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8910; val_auprc_score: 0.9733; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 456999.3651; train_edge_recon_loss: 1189560.1648; train_gene_expr_recon_loss: 53674922.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55321482.0000; train_optim_loss: 55321482.0000; val_kl_reg_loss: 472854.7917; val_edge_recon_loss: 1185327.3333; val_gene_expr_recon_loss: 41234904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42893086.6667; val_optim_loss: 42893086.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8822; val_auprc_score: 0.9703; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 460651.4830; train_edge_recon_loss: 1179037.3864; train_gene_expr_recon_loss: 40475329.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42115018.3636; train_optim_loss: 42115018.3636; val_kl_reg_loss: 426743.6042; val_edge_recon_loss: 1232662.1250; val_gene_expr_recon_loss: 40516202.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42175608.0000; val_optim_loss: 42175608.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8873; val_auprc_score: 0.9725; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 394578.6520; train_edge_recon_loss: 1186207.5455; train_gene_expr_recon_loss: 39996152.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41576938.7273; train_optim_loss: 41576938.7273; val_kl_reg_loss: 352923.5208; val_edge_recon_loss: 1238809.1250; val_gene_expr_recon_loss: 39982508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41574241.3333; val_optim_loss: 41574241.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8799; val_auprc_score: 0.9692; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 44718272996.5838; train_edge_recon_loss: 1155440.4318; train_gene_expr_recon_loss: 351233197.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45070663051.4545; train_optim_loss: 45070663051.4545; val_kl_reg_loss: 498848426.6667; val_edge_recon_loss: 1202797.9583; val_gene_expr_recon_loss: 193115514.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 693166762.6667; val_optim_loss: 693166762.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7237; val_auprc_score: 0.9161; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 2454543785.2045; train_edge_recon_loss: 1116169.0966; train_gene_expr_recon_loss: 634115793.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3089775802.9091; train_optim_loss: 3089775802.9091; val_kl_reg_loss: 5907405.3333; val_edge_recon_loss: 1164992.2500; val_gene_expr_recon_loss: 201321285.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 208393685.3333; val_optim_loss: 208393685.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7121; val_auprc_score: 0.9120; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 136407296101.4773; train_edge_recon_loss: 1174914.2443; train_gene_expr_recon_loss: 280531250.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 136688996270.5455; train_optim_loss: 136688996270.5455; val_kl_reg_loss: 7644346.8333; val_edge_recon_loss: 1159215.9583; val_gene_expr_recon_loss: 79638037.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88441600.0000; val_optim_loss: 88441600.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7295; val_auprc_score: 0.9147; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 7440269.9091; train_edge_recon_loss: 1201337.8068; train_gene_expr_recon_loss: 82092964.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 90734572.3636; train_optim_loss: 90734572.3636; val_kl_reg_loss: 6977154.6667; val_edge_recon_loss: 1200563.0417; val_gene_expr_recon_loss: 65826504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74004218.6667; val_optim_loss: 74004218.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7367; val_auprc_score: 0.9129; val_best_acc_score: 0.8461; val_best_f1_score: 0.9167; train_kl_reg_loss: 7036433.0455; train_edge_recon_loss: 1186233.6761; train_gene_expr_recon_loss: 64299880.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 72522548.3636; train_optim_loss: 72522548.3636; val_kl_reg_loss: 6923161.1667; val_edge_recon_loss: 1235862.0833; val_gene_expr_recon_loss: 63416153.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71575176.0000; val_optim_loss: 71575176.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7228; val_auprc_score: 0.9169; val_best_acc_score: 0.8589; val_best_f1_score: 0.9241; train_kl_reg_loss: 6969593.8409; train_edge_recon_loss: 1222565.5909; train_gene_expr_recon_loss: 62862797.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71054957.0909; train_optim_loss: 71054957.0909; val_kl_reg_loss: 6865948.0000; val_edge_recon_loss: 1143753.8750; val_gene_expr_recon_loss: 62766237.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70775938.6667; val_optim_loss: 70775938.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7251; val_auprc_score: 0.9074; val_best_acc_score: 0.8429; val_best_f1_score: 0.9147; train_kl_reg_loss: 6910098.3182; train_edge_recon_loss: 1204941.9602; train_gene_expr_recon_loss: 62346782.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70461822.9091; train_optim_loss: 70461822.9091; val_kl_reg_loss: 6788865.6667; val_edge_recon_loss: 1295220.4167; val_gene_expr_recon_loss: 62320892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70404978.6667; val_optim_loss: 70404978.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7281; val_auprc_score: 0.9117; val_best_acc_score: 0.8481; val_best_f1_score: 0.9178; train_kl_reg_loss: 6826239.7500; train_edge_recon_loss: 1170372.7074; train_gene_expr_recon_loss: 61915504.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69912116.3636; train_optim_loss: 69912116.3636; val_kl_reg_loss: 6745476.0000; val_edge_recon_loss: 1238562.3333; val_gene_expr_recon_loss: 61966973.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69951010.6667; val_optim_loss: 69951010.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 11 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
val AUROC score: 0.8888
val AUPRC score: 0.9730
val best accuracy score: 0.8529
val best F1 score: 0.9206
val target rna MSE score: 21.1540
val source rna MSE score: 17.2247
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 1 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1483, n_latent: 1473, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8972; val_auprc_score: 0.9748; val_best_acc_score: 0.8450; val_best_f1_score: 0.9160; train_kl_reg_loss: 667929.9603; train_edge_recon_loss: 1087186.4609; train_gene_expr_recon_loss: 177070925.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 178826038.0000; train_optim_loss: 178826038.0000; val_kl_reg_loss: 210273.1250; val_edge_recon_loss: 1249912.4375; val_gene_expr_recon_loss: 60875012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62335198.0000; val_optim_loss: 62335198.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8849; val_auprc_score: 0.9727; val_best_acc_score: 0.8579; val_best_f1_score: 0.9235; train_kl_reg_loss: 304763.7832; train_edge_recon_loss: 1168126.3906; train_gene_expr_recon_loss: 56799150.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58272041.0000; train_optim_loss: 58272041.0000; val_kl_reg_loss: 361079.2188; val_edge_recon_loss: 1164856.5000; val_gene_expr_recon_loss: 53306740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54832676.0000; val_optim_loss: 54832676.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8986; val_auprc_score: 0.9781; val_best_acc_score: 0.8622; val_best_f1_score: 0.9260; train_kl_reg_loss: 395599.4785; train_edge_recon_loss: 1214548.3828; train_gene_expr_recon_loss: 52333106.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53943254.2500; train_optim_loss: 53943254.2500; val_kl_reg_loss: 408212.4531; val_edge_recon_loss: 1130248.3750; val_gene_expr_recon_loss: 51958480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53496940.0000; val_optim_loss: 53496940.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8798; val_auprc_score: 0.9699; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 417002.7363; train_edge_recon_loss: 1214236.2188; train_gene_expr_recon_loss: 51328924.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52960163.5000; train_optim_loss: 52960163.5000; val_kl_reg_loss: 414995.6250; val_edge_recon_loss: 1193712.4375; val_gene_expr_recon_loss: 50322632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51931340.0000; val_optim_loss: 51931340.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8831; val_auprc_score: 0.9723; val_best_acc_score: 0.8583; val_best_f1_score: 0.9237; train_kl_reg_loss: 413605.5391; train_edge_recon_loss: 1195927.0938; train_gene_expr_recon_loss: 49835243.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51444776.0000; train_optim_loss: 51444776.0000; val_kl_reg_loss: 402546.8125; val_edge_recon_loss: 1150347.5625; val_gene_expr_recon_loss: 49481708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51034604.0000; val_optim_loss: 51034604.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8865; val_auprc_score: 0.9716; val_best_acc_score: 0.8504; val_best_f1_score: 0.9191; train_kl_reg_loss: 424701.4062; train_edge_recon_loss: 1195110.5781; train_gene_expr_recon_loss: 49019904.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50639716.7500; train_optim_loss: 50639716.7500; val_kl_reg_loss: 436559.7812; val_edge_recon_loss: 1219007.1875; val_gene_expr_recon_loss: 48514678.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50170246.0000; val_optim_loss: 50170246.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8871; val_auprc_score: 0.9732; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 445300.8867; train_edge_recon_loss: 1197108.1484; train_gene_expr_recon_loss: 48023381.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49665790.2500; train_optim_loss: 49665790.2500; val_kl_reg_loss: 438982.2812; val_edge_recon_loss: 1174505.1250; val_gene_expr_recon_loss: 47522108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49135596.0000; val_optim_loss: 49135596.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8893; val_auprc_score: 0.9751; val_best_acc_score: 0.8593; val_best_f1_score: 0.9243; train_kl_reg_loss: 439269.7480; train_edge_recon_loss: 1185420.7344; train_gene_expr_recon_loss: 46944215.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48568906.0000; train_optim_loss: 48568906.0000; val_kl_reg_loss: 428387.3125; val_edge_recon_loss: 1147690.6250; val_gene_expr_recon_loss: 46411156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47987234.0000; val_optim_loss: 47987234.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8872; val_auprc_score: 0.9730; val_best_acc_score: 0.8494; val_best_f1_score: 0.9185; train_kl_reg_loss: 426337.8223; train_edge_recon_loss: 1193264.8828; train_gene_expr_recon_loss: 45710182.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47329785.5000; train_optim_loss: 47329785.5000; val_kl_reg_loss: 413809.9531; val_edge_recon_loss: 1230149.3125; val_gene_expr_recon_loss: 45123200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46767160.0000; val_optim_loss: 46767160.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8879; val_auprc_score: 0.9749; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 412256.5254; train_edge_recon_loss: 1208050.8281; train_gene_expr_recon_loss: 44436241.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46056548.5000; train_optim_loss: 46056548.5000; val_kl_reg_loss: 401161.0000; val_edge_recon_loss: 1171027.6875; val_gene_expr_recon_loss: 43824392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45396580.0000; val_optim_loss: 45396580.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8705; val_auprc_score: 0.9690; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 398041.5176; train_edge_recon_loss: 1196499.1328; train_gene_expr_recon_loss: 43144830.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44739371.5000; train_optim_loss: 44739371.5000; val_kl_reg_loss: 388489.3594; val_edge_recon_loss: 1195229.6250; val_gene_expr_recon_loss: 42618024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44201744.0000; val_optim_loss: 44201744.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8636; val_auprc_score: 0.9649; val_best_acc_score: 0.8487; val_best_f1_score: 0.9182; train_kl_reg_loss: 384592.9453; train_edge_recon_loss: 1185002.5156; train_gene_expr_recon_loss: 41931701.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43501296.7500; train_optim_loss: 43501296.7500; val_kl_reg_loss: 371895.1094; val_edge_recon_loss: 1229100.1875; val_gene_expr_recon_loss: 41381872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42982868.0000; val_optim_loss: 42982868.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8830; val_auprc_score: 0.9718; val_best_acc_score: 0.8458; val_best_f1_score: 0.9164; train_kl_reg_loss: 370646.7207; train_edge_recon_loss: 1190835.6328; train_gene_expr_recon_loss: 40895607.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42457089.2500; train_optim_loss: 42457089.2500; val_kl_reg_loss: 359398.2812; val_edge_recon_loss: 1246397.6875; val_gene_expr_recon_loss: 40515454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42121250.0000; val_optim_loss: 42121250.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8689; val_auprc_score: 0.9695; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 357401.8164; train_edge_recon_loss: 1186667.8359; train_gene_expr_recon_loss: 40057394.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41601464.2500; train_optim_loss: 41601464.2500; val_kl_reg_loss: 348690.6562; val_edge_recon_loss: 1210961.7500; val_gene_expr_recon_loss: 39765014.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41324666.0000; val_optim_loss: 41324666.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8599; val_auprc_score: 0.9660; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 346565.1465; train_edge_recon_loss: 1194005.0469; train_gene_expr_recon_loss: 39417995.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40958565.7500; train_optim_loss: 40958565.7500; val_kl_reg_loss: 336017.1250; val_edge_recon_loss: 1207358.2500; val_gene_expr_recon_loss: 39238586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40781962.0000; val_optim_loss: 40781962.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8730; val_auprc_score: 0.9707; val_best_acc_score: 0.8470; val_best_f1_score: 0.9171; train_kl_reg_loss: 334029.6328; train_edge_recon_loss: 1189983.0898; train_gene_expr_recon_loss: 38908114.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40432127.2500; train_optim_loss: 40432127.2500; val_kl_reg_loss: 322939.0312; val_edge_recon_loss: 1238957.4375; val_gene_expr_recon_loss: 38862926.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40424822.0000; val_optim_loss: 40424822.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8688; val_auprc_score: 0.9708; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 325535.1055; train_edge_recon_loss: 1190377.7500; train_gene_expr_recon_loss: 38630341.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40146253.7500; train_optim_loss: 40146253.7500; val_kl_reg_loss: 316508.0469; val_edge_recon_loss: 1185483.7500; val_gene_expr_recon_loss: 38460888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39962880.0000; val_optim_loss: 39962880.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8796; val_auprc_score: 0.9713; val_best_acc_score: 0.8473; val_best_f1_score: 0.9174; train_kl_reg_loss: 346692.7559; train_edge_recon_loss: 1205589.4531; train_gene_expr_recon_loss: 39920087.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41472370.2500; train_optim_loss: 41472370.2500; val_kl_reg_loss: 366436.1719; val_edge_recon_loss: 1234644.0000; val_gene_expr_recon_loss: 39057252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40658334.0000; val_optim_loss: 40658334.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8560; val_auprc_score: 0.9668; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 376120.1211; train_edge_recon_loss: 1201892.8203; train_gene_expr_recon_loss: 38340049.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39918062.2500; train_optim_loss: 39918062.2500; val_kl_reg_loss: 367982.3750; val_edge_recon_loss: 1188955.0625; val_gene_expr_recon_loss: 38168554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39725490.0000; val_optim_loss: 39725490.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8660; val_auprc_score: 0.9690; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 360840.3711; train_edge_recon_loss: 1209625.4609; train_gene_expr_recon_loss: 37862832.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39433298.0000; train_optim_loss: 39433298.0000; val_kl_reg_loss: 359153.1406; val_edge_recon_loss: 1217091.8750; val_gene_expr_recon_loss: 37906696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39482942.0000; val_optim_loss: 39482942.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8641; val_auprc_score: 0.9708; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 412194.0781; train_edge_recon_loss: 1193223.6094; train_gene_expr_recon_loss: 56448645.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58054062.7500; train_optim_loss: 58054062.7500; val_kl_reg_loss: 321459.4688; val_edge_recon_loss: 1158289.5625; val_gene_expr_recon_loss: 38025540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39505288.0000; val_optim_loss: 39505288.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8559; val_auprc_score: 0.9652; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 362704.8828; train_edge_recon_loss: 1189730.5625; train_gene_expr_recon_loss: 37855758.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39408193.5000; train_optim_loss: 39408193.5000; val_kl_reg_loss: 375346.7812; val_edge_recon_loss: 1221422.2500; val_gene_expr_recon_loss: 37659760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39256530.0000; val_optim_loss: 39256530.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8676; val_auprc_score: 0.9677; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 381322.7188; train_edge_recon_loss: 1198783.9766; train_gene_expr_recon_loss: 42982044.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44562151.0000; train_optim_loss: 44562151.0000; val_kl_reg_loss: 3275636.1250; val_edge_recon_loss: 1209977.1875; val_gene_expr_recon_loss: 44521312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49006926.0000; val_optim_loss: 49006926.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8139; val_auprc_score: 0.9466; val_best_acc_score: 0.8601; val_best_f1_score: 0.9248; train_kl_reg_loss: 504214586.9688; train_edge_recon_loss: 1108354.8008; train_gene_expr_recon_loss: 801766595.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1307089550.0000; train_optim_loss: 1307089550.0000; val_kl_reg_loss: 11847465.0000; val_edge_recon_loss: 1135749.0000; val_gene_expr_recon_loss: 175544960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 188528168.0000; val_optim_loss: 188528168.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8198; val_auprc_score: 0.9450; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 3248192.5781; train_edge_recon_loss: 1182426.5938; train_gene_expr_recon_loss: 150587885.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 155018506.0000; train_optim_loss: 155018506.0000; val_kl_reg_loss: 2723842.6250; val_edge_recon_loss: 1189763.0625; val_gene_expr_recon_loss: 66497152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70410756.0000; val_optim_loss: 70410756.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8168; val_auprc_score: 0.9441; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 2693639.2344; train_edge_recon_loss: 1201023.3125; train_gene_expr_recon_loss: 82683741.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86578402.7500; train_optim_loss: 86578402.7500; val_kl_reg_loss: 2543418.6250; val_edge_recon_loss: 1188355.1875; val_gene_expr_recon_loss: 62955692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66687466.0000; val_optim_loss: 66687466.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8138; val_auprc_score: 0.9422; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 2562358.9688; train_edge_recon_loss: 1184376.0312; train_gene_expr_recon_loss: 63038866.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66785601.7500; train_optim_loss: 66785601.7500; val_kl_reg_loss: 2527268.8750; val_edge_recon_loss: 1201032.3750; val_gene_expr_recon_loss: 61983736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65712038.0000; val_optim_loss: 65712038.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8270; val_auprc_score: 0.9450; val_best_acc_score: 0.8464; val_best_f1_score: 0.9168; train_kl_reg_loss: 2538208.7031; train_edge_recon_loss: 1199959.2734; train_gene_expr_recon_loss: 61458749.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65196917.0000; train_optim_loss: 65196917.0000; val_kl_reg_loss: 2498617.6250; val_edge_recon_loss: 1236970.9375; val_gene_expr_recon_loss: 61310972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65046560.0000; val_optim_loss: 65046560.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8166; val_auprc_score: 0.9486; val_best_acc_score: 0.8628; val_best_f1_score: 0.9263; train_kl_reg_loss: 2509463.0000; train_edge_recon_loss: 1209921.1797; train_gene_expr_recon_loss: 60972730.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64692114.5000; train_optim_loss: 64692114.5000; val_kl_reg_loss: 2470697.2500; val_edge_recon_loss: 1108119.5625; val_gene_expr_recon_loss: 60887044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64465860.0000; val_optim_loss: 64465860.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8238; val_auprc_score: 0.9471; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 2486502.3906; train_edge_recon_loss: 1215320.4766; train_gene_expr_recon_loss: 60617131.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64318954.7500; train_optim_loss: 64318954.7500; val_kl_reg_loss: 2439575.7500; val_edge_recon_loss: 1175951.0625; val_gene_expr_recon_loss: 60571134.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64186660.0000; val_optim_loss: 64186660.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 29 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.8576
val AUPRC score: 0.9679
val best accuracy score: 0.8538
val best F1 score: 0.9211
val target rna MSE score: 23.5948
val source rna MSE score: 27.5696
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 1 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1483, n_latent: 1473, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9089; val_auprc_score: 0.9790; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 5814061.4011; train_edge_recon_loss: 1070192.1172; train_gene_expr_recon_loss: 450939563.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 457823823.0000; train_optim_loss: 457823823.0000; val_kl_reg_loss: 333340.3281; val_edge_recon_loss: 1189897.1875; val_gene_expr_recon_loss: 65175730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66698968.0000; val_optim_loss: 66698968.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8940; val_auprc_score: 0.9738; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 459979.4219; train_edge_recon_loss: 1183530.3047; train_gene_expr_recon_loss: 64263286.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65906796.0000; train_optim_loss: 65906796.0000; val_kl_reg_loss: 555534.8125; val_edge_recon_loss: 1175037.4375; val_gene_expr_recon_loss: 60067748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61798320.0000; val_optim_loss: 61798320.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8891; val_auprc_score: 0.9711; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 608065.0117; train_edge_recon_loss: 1203753.5625; train_gene_expr_recon_loss: 58371659.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60183478.2500; train_optim_loss: 60183478.2500; val_kl_reg_loss: 637562.2188; val_edge_recon_loss: 1222785.3750; val_gene_expr_recon_loss: 57157646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59017994.0000; val_optim_loss: 59017994.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8935; val_auprc_score: 0.9727; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 653557.3398; train_edge_recon_loss: 1188328.0156; train_gene_expr_recon_loss: 56432612.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58274498.0000; train_optim_loss: 58274498.0000; val_kl_reg_loss: 650606.6875; val_edge_recon_loss: 1221496.4375; val_gene_expr_recon_loss: 55804774.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57676878.0000; val_optim_loss: 57676878.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8845; val_auprc_score: 0.9704; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 649755.3477; train_edge_recon_loss: 1197829.2969; train_gene_expr_recon_loss: 55260754.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57108339.0000; train_optim_loss: 57108339.0000; val_kl_reg_loss: 636644.8125; val_edge_recon_loss: 1191178.8750; val_gene_expr_recon_loss: 54819392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56647214.0000; val_optim_loss: 56647214.0000
Run timestamp: 26082023_183700_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1482, n_latent: 1472, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1472, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1472, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9217; val_auprc_score: 0.9827; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 2119809.3933; train_edge_recon_loss: 1051700.5000; train_gene_expr_recon_loss: 174267392.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 177438904.6667; train_optim_loss: 177438904.6667; val_kl_reg_loss: 125644.8594; val_edge_recon_loss: 1177540.8750; val_gene_expr_recon_loss: 62774624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64077808.0000; val_optim_loss: 64077808.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8941; val_auprc_score: 0.9734; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 632591.4609; train_edge_recon_loss: 1191663.8984; train_gene_expr_recon_loss: 54279149.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56103404.2500; train_optim_loss: 56103404.2500; val_kl_reg_loss: 614217.7812; val_edge_recon_loss: 1201632.6875; val_gene_expr_recon_loss: 53725064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55540914.0000; val_optim_loss: 55540914.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9103; val_auprc_score: 0.9793; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 186569.6211; train_edge_recon_loss: 1132130.1042; train_gene_expr_recon_loss: 61060268.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62378968.0000; train_optim_loss: 62378968.0000; val_kl_reg_loss: 271118.2812; val_edge_recon_loss: 1189955.7500; val_gene_expr_recon_loss: 59431908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60892984.0000; val_optim_loss: 60892984.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8832; val_auprc_score: 0.9706; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 610766.5742; train_edge_recon_loss: 1185574.2031; train_gene_expr_recon_loss: 53142572.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54938912.7500; train_optim_loss: 54938912.7500; val_kl_reg_loss: 591731.9375; val_edge_recon_loss: 1185087.6250; val_gene_expr_recon_loss: 52522598.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54299416.0000; val_optim_loss: 54299416.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8912; val_auprc_score: 0.9729; val_best_acc_score: 0.8556; val_best_f1_score: 0.9222; train_kl_reg_loss: 588547.0312; train_edge_recon_loss: 1177187.3281; train_gene_expr_recon_loss: 51783316.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53549050.5000; train_optim_loss: 53549050.5000; val_kl_reg_loss: 571009.2812; val_edge_recon_loss: 1170184.5000; val_gene_expr_recon_loss: 51027124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52768318.0000; val_optim_loss: 52768318.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9050; val_auprc_score: 0.9765; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 335025.1927; train_edge_recon_loss: 1194325.8542; train_gene_expr_recon_loss: 58204122.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59733473.3333; train_optim_loss: 59733473.3333; val_kl_reg_loss: 411386.0938; val_edge_recon_loss: 1182526.3750; val_gene_expr_recon_loss: 56821296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58415208.0000; val_optim_loss: 58415208.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8963; val_auprc_score: 0.9730; val_best_acc_score: 0.8477; val_best_f1_score: 0.9176; train_kl_reg_loss: 565905.1992; train_edge_recon_loss: 1196956.4375; train_gene_expr_recon_loss: 50277605.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52040467.0000; train_optim_loss: 52040467.0000; val_kl_reg_loss: 548818.3750; val_edge_recon_loss: 1241683.2500; val_gene_expr_recon_loss: 49515316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51305816.0000; val_optim_loss: 51305816.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9080; val_auprc_score: 0.9783; val_best_acc_score: 0.8590; val_best_f1_score: 0.9242; train_kl_reg_loss: 454786.6927; train_edge_recon_loss: 1218493.9583; train_gene_expr_recon_loss: 57197569.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58870850.0000; train_optim_loss: 58870850.0000; val_kl_reg_loss: 490750.3750; val_edge_recon_loss: 1146380.5000; val_gene_expr_recon_loss: 53519404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55156536.0000; val_optim_loss: 55156536.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8910; val_auprc_score: 0.9735; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 542832.0508; train_edge_recon_loss: 1202888.6250; train_gene_expr_recon_loss: 48681274.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50426995.0000; train_optim_loss: 50426995.0000; val_kl_reg_loss: 524748.2188; val_edge_recon_loss: 1169243.5000; val_gene_expr_recon_loss: 47909588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49603580.0000; val_optim_loss: 49603580.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9021; val_auprc_score: 0.9764; val_best_acc_score: 0.8609; val_best_f1_score: 0.9252; train_kl_reg_loss: 518273.6510; train_edge_recon_loss: 1194298.1042; train_gene_expr_recon_loss: 55849910.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57562481.3333; train_optim_loss: 57562481.3333; val_kl_reg_loss: 544312.9375; val_edge_recon_loss: 1131313.5000; val_gene_expr_recon_loss: 55669440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57345068.0000; val_optim_loss: 57345068.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8821; val_auprc_score: 0.9719; val_best_acc_score: 0.8574; val_best_f1_score: 0.9233; train_kl_reg_loss: 519756.3730; train_edge_recon_loss: 1223772.1172; train_gene_expr_recon_loss: 47225908.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48969436.7500; train_optim_loss: 48969436.7500; val_kl_reg_loss: 501720.4062; val_edge_recon_loss: 1162728.0000; val_gene_expr_recon_loss: 46638012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48302460.0000; val_optim_loss: 48302460.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9056; val_auprc_score: 0.9754; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 574106.4479; train_edge_recon_loss: 1196089.1250; train_gene_expr_recon_loss: 55276095.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57046291.3333; train_optim_loss: 57046291.3333; val_kl_reg_loss: 598030.5625; val_edge_recon_loss: 1202310.5000; val_gene_expr_recon_loss: 54741376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56541716.0000; val_optim_loss: 56541716.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8824; val_auprc_score: 0.9731; val_best_acc_score: 0.8624; val_best_f1_score: 0.9261; train_kl_reg_loss: 498251.3184; train_edge_recon_loss: 1197563.8672; train_gene_expr_recon_loss: 46123615.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47819429.7500; train_optim_loss: 47819429.7500; val_kl_reg_loss: 482801.5938; val_edge_recon_loss: 1111560.7500; val_gene_expr_recon_loss: 45751372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47345734.0000; val_optim_loss: 47345734.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8999; val_auprc_score: 0.9730; val_best_acc_score: 0.8475; val_best_f1_score: 0.9174; train_kl_reg_loss: 623230.5729; train_edge_recon_loss: 1186994.5833; train_gene_expr_recon_loss: 54237342.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56047568.0000; train_optim_loss: 56047568.0000; val_kl_reg_loss: 639386.0000; val_edge_recon_loss: 1240321.8750; val_gene_expr_recon_loss: 54006180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55885888.0000; val_optim_loss: 55885888.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8777; val_auprc_score: 0.9692; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 477501.6035; train_edge_recon_loss: 1205968.2031; train_gene_expr_recon_loss: 45338013.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47021483.7500; train_optim_loss: 47021483.7500; val_kl_reg_loss: 463837.9688; val_edge_recon_loss: 1207175.1250; val_gene_expr_recon_loss: 45114912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46785926.0000; val_optim_loss: 46785926.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8958; val_auprc_score: 0.9731; val_best_acc_score: 0.8573; val_best_f1_score: 0.9232; train_kl_reg_loss: 659170.9375; train_edge_recon_loss: 1193697.5417; train_gene_expr_recon_loss: 53574211.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55427079.3333; train_optim_loss: 55427079.3333; val_kl_reg_loss: 665688.0000; val_edge_recon_loss: 1160136.1250; val_gene_expr_recon_loss: 53373488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55199312.0000; val_optim_loss: 55199312.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8964; val_auprc_score: 0.9762; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 457857.7168; train_edge_recon_loss: 1180647.0312; train_gene_expr_recon_loss: 44795564.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46434068.7500; train_optim_loss: 46434068.7500; val_kl_reg_loss: 440829.0625; val_edge_recon_loss: 1163294.3750; val_gene_expr_recon_loss: 44613412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46217536.0000; val_optim_loss: 46217536.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8842; val_auprc_score: 0.9718; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 438858.9258; train_edge_recon_loss: 1184088.4688; train_gene_expr_recon_loss: 44424848.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46047795.7500; train_optim_loss: 46047795.7500; val_kl_reg_loss: 424195.7188; val_edge_recon_loss: 1223849.2500; val_gene_expr_recon_loss: 44332280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45980326.0000; val_optim_loss: 45980326.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9006; val_auprc_score: 0.9750; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 673314.0208; train_edge_recon_loss: 1200949.1458; train_gene_expr_recon_loss: 53156745.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55031008.6667; train_optim_loss: 55031008.6667; val_kl_reg_loss: 666831.3750; val_edge_recon_loss: 1150138.2500; val_gene_expr_recon_loss: 53268192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55085160.0000; val_optim_loss: 55085160.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8702; val_auprc_score: 0.9698; val_best_acc_score: 0.8579; val_best_f1_score: 0.9235; train_kl_reg_loss: 420647.0938; train_edge_recon_loss: 1186364.2266; train_gene_expr_recon_loss: 44153796.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45760808.0000; train_optim_loss: 45760808.0000; val_kl_reg_loss: 408484.5000; val_edge_recon_loss: 1157068.1875; val_gene_expr_recon_loss: 44131910.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45697462.0000; val_optim_loss: 45697462.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9039; val_auprc_score: 0.9758; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 672907.7188; train_edge_recon_loss: 1208500.7292; train_gene_expr_recon_loss: 53045852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54927260.6667; train_optim_loss: 54927260.6667; val_kl_reg_loss: 666218.1250; val_edge_recon_loss: 1178805.7500; val_gene_expr_recon_loss: 53114384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54959408.0000; val_optim_loss: 54959408.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8853; val_auprc_score: 0.9725; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 404250.3496; train_edge_recon_loss: 1195598.4688; train_gene_expr_recon_loss: 43939637.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45539486.2500; train_optim_loss: 45539486.2500; val_kl_reg_loss: 391292.7656; val_edge_recon_loss: 1219121.6875; val_gene_expr_recon_loss: 100372556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 101982972.0000; val_optim_loss: 101982972.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8972; val_auprc_score: 0.9726; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 673535.5312; train_edge_recon_loss: 1204584.2500; train_gene_expr_recon_loss: 52839334.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54717454.0000; train_optim_loss: 54717454.0000; val_kl_reg_loss: 667186.1250; val_edge_recon_loss: 1199844.0000; val_gene_expr_recon_loss: 52748716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54615748.0000; val_optim_loss: 54615748.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8314; val_auprc_score: 0.9439; val_best_acc_score: 0.8404; val_best_f1_score: 0.9133; train_kl_reg_loss: 21214968.1387; train_edge_recon_loss: 1133233.5938; train_gene_expr_recon_loss: 457394431.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 479742641.0000; train_optim_loss: 479742641.0000; val_kl_reg_loss: 2740037120.0000; val_edge_recon_loss: 1301682.1250; val_gene_expr_recon_loss: 184415464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2925754240.0000; val_optim_loss: 2925754240.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9053; val_auprc_score: 0.9766; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 673222.3125; train_edge_recon_loss: 1197837.9583; train_gene_expr_recon_loss: 52390556.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54261616.6667; train_optim_loss: 54261616.6667; val_kl_reg_loss: 666525.1250; val_edge_recon_loss: 1148886.5000; val_gene_expr_recon_loss: 52325664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54141076.0000; val_optim_loss: 54141076.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7806; val_auprc_score: 0.9316; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 303310797.7031; train_edge_recon_loss: 1187746.9844; train_gene_expr_recon_loss: 316780948.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 621279485.5000; train_optim_loss: 621279485.5000; val_kl_reg_loss: 3480810.3750; val_edge_recon_loss: 1195164.6250; val_gene_expr_recon_loss: 81364896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86040872.0000; val_optim_loss: 86040872.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8980; val_auprc_score: 0.9746; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 672251.0833; train_edge_recon_loss: 1201427.1667; train_gene_expr_recon_loss: 52136500.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54010179.3333; train_optim_loss: 54010179.3333; val_kl_reg_loss: 664052.1250; val_edge_recon_loss: 1153891.0000; val_gene_expr_recon_loss: 52266536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54084480.0000; val_optim_loss: 54084480.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7727; val_auprc_score: 0.9275; val_best_acc_score: 0.8483; val_best_f1_score: 0.9180; train_kl_reg_loss: 3550687.1875; train_edge_recon_loss: 1199551.8984; train_gene_expr_recon_loss: 70479637.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 75229876.7500; train_optim_loss: 75229876.7500; val_kl_reg_loss: 3466557.5000; val_edge_recon_loss: 1221383.1875; val_gene_expr_recon_loss: 59032676.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63720618.0000; val_optim_loss: 63720618.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8997; val_auprc_score: 0.9738; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 671781.1875; train_edge_recon_loss: 1183991.7917; train_gene_expr_recon_loss: 52114998.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53970770.0000; train_optim_loss: 53970770.0000; val_kl_reg_loss: 664861.0000; val_edge_recon_loss: 1202310.8750; val_gene_expr_recon_loss: 52230248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54097420.0000; val_optim_loss: 54097420.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7919; val_auprc_score: 0.9409; val_best_acc_score: 0.8634; val_best_f1_score: 0.9267; train_kl_reg_loss: 3483432.2812; train_edge_recon_loss: 1179579.1484; train_gene_expr_recon_loss: 58034826.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62697838.5000; train_optim_loss: 62697838.5000; val_kl_reg_loss: 3438498.7500; val_edge_recon_loss: 1104780.8750; val_gene_expr_recon_loss: 57611692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62154972.0000; val_optim_loss: 62154972.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9042; val_auprc_score: 0.9751; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 670118.8021; train_edge_recon_loss: 1200048.2292; train_gene_expr_recon_loss: 52038055.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53908222.0000; train_optim_loss: 53908222.0000; val_kl_reg_loss: 661666.1875; val_edge_recon_loss: 1189959.5000; val_gene_expr_recon_loss: 52167900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54019524.0000; val_optim_loss: 54019524.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7910; val_auprc_score: 0.9392; val_best_acc_score: 0.8609; val_best_f1_score: 0.9253; train_kl_reg_loss: 3459190.5625; train_edge_recon_loss: 1179131.0703; train_gene_expr_recon_loss: 57346120.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61984442.5000; train_optim_loss: 61984442.5000; val_kl_reg_loss: 3402392.2500; val_edge_recon_loss: 1142808.1250; val_gene_expr_recon_loss: 57168664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61713864.0000; val_optim_loss: 61713864.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7728; val_auprc_score: 0.9288; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 3431562.8750; train_edge_recon_loss: 1175324.4609; train_gene_expr_recon_loss: 56987835.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61594723.0000; train_optim_loss: 61594723.0000; val_kl_reg_loss: 3401471.0000; val_edge_recon_loss: 1220008.8750; val_gene_expr_recon_loss: 56954148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61575628.0000; val_optim_loss: 61575628.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8998; val_auprc_score: 0.9741; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 669799.5417; train_edge_recon_loss: 1220526.6667; train_gene_expr_recon_loss: 51985030.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53875356.6667; train_optim_loss: 53875356.6667; val_kl_reg_loss: 663032.1250; val_edge_recon_loss: 1186245.7500; val_gene_expr_recon_loss: 52112720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53961996.0000; val_optim_loss: 53961996.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7943; val_auprc_score: 0.9337; val_best_acc_score: 0.8464; val_best_f1_score: 0.9168; train_kl_reg_loss: 3403484.9219; train_edge_recon_loss: 1204649.8125; train_gene_expr_recon_loss: 56732362.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61340497.7500; train_optim_loss: 61340497.7500; val_kl_reg_loss: 3347361.0000; val_edge_recon_loss: 1253456.3750; val_gene_expr_recon_loss: 56633534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61234352.0000; val_optim_loss: 61234352.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8956; val_auprc_score: 0.9718; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 669403.7708; train_edge_recon_loss: 1183852.6875; train_gene_expr_recon_loss: 51942660.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53795917.3333; train_optim_loss: 53795917.3333; val_kl_reg_loss: 661829.1875; val_edge_recon_loss: 1209700.7500; val_gene_expr_recon_loss: 52056552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53928080.0000; val_optim_loss: 53928080.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9021; val_auprc_score: 0.9755; val_best_acc_score: 0.8589; val_best_f1_score: 0.9241; train_kl_reg_loss: 669378.8750; train_edge_recon_loss: 1197523.4375; train_gene_expr_recon_loss: 51898499.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53765401.3333; train_optim_loss: 53765401.3333; val_kl_reg_loss: 660331.3750; val_edge_recon_loss: 1147634.1250; val_gene_expr_recon_loss: 51991224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53799188.0000; val_optim_loss: 53799188.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9032; val_auprc_score: 0.9740; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 667979.9896; train_edge_recon_loss: 1176769.7917; train_gene_expr_recon_loss: 51803628.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53648378.6667; train_optim_loss: 53648378.6667; val_kl_reg_loss: 661231.1250; val_edge_recon_loss: 1224432.7500; val_gene_expr_recon_loss: 51947152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53832816.0000; val_optim_loss: 53832816.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8975; val_auprc_score: 0.9723; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 667732.0104; train_edge_recon_loss: 1205550.4375; train_gene_expr_recon_loss: 51743391.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53616674.0000; train_optim_loss: 53616674.0000; val_kl_reg_loss: 659947.5000; val_edge_recon_loss: 1215846.7500; val_gene_expr_recon_loss: 51888496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53764292.0000; val_optim_loss: 53764292.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8947; val_auprc_score: 0.9725; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 667603.0312; train_edge_recon_loss: 1196351.2708; train_gene_expr_recon_loss: 51703198.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53567152.6667; train_optim_loss: 53567152.6667; val_kl_reg_loss: 659234.6875; val_edge_recon_loss: 1191197.0000; val_gene_expr_recon_loss: 51836188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53686620.0000; val_optim_loss: 53686620.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8984; val_auprc_score: 0.9733; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 666141.7500; train_edge_recon_loss: 1212346.7292; train_gene_expr_recon_loss: 51662017.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53540505.3333; train_optim_loss: 53540505.3333; val_kl_reg_loss: 658990.3750; val_edge_recon_loss: 1197375.5000; val_gene_expr_recon_loss: 51781804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53638168.0000; val_optim_loss: 53638168.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9029; val_auprc_score: 0.9748; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 665150.9896; train_edge_recon_loss: 1218358.2708; train_gene_expr_recon_loss: 51634708.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53518218.0000; train_optim_loss: 53518218.0000; val_kl_reg_loss: 659524.1250; val_edge_recon_loss: 1208470.0000; val_gene_expr_recon_loss: 51742608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53610604.0000; val_optim_loss: 53610604.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8947; val_auprc_score: 0.9730; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 664862.4375; train_edge_recon_loss: 1201987.0208; train_gene_expr_recon_loss: 51552074.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53418924.0000; train_optim_loss: 53418924.0000; val_kl_reg_loss: 659270.3750; val_edge_recon_loss: 1171350.0000; val_gene_expr_recon_loss: 51684424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53515044.0000; val_optim_loss: 53515044.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8881; val_auprc_score: 0.9705; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 662627.8125; train_edge_recon_loss: 1199075.3125; train_gene_expr_recon_loss: 51474903.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53336606.0000; train_optim_loss: 53336606.0000; val_kl_reg_loss: 657056.6250; val_edge_recon_loss: 1185006.8750; val_gene_expr_recon_loss: 51607808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53449872.0000; val_optim_loss: 53449872.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8899; val_auprc_score: 0.9715; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 662535.4375; train_edge_recon_loss: 1192186.0625; train_gene_expr_recon_loss: 51386765.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53241486.6667; train_optim_loss: 53241486.6667; val_kl_reg_loss: 656335.0000; val_edge_recon_loss: 1168861.2500; val_gene_expr_recon_loss: 51549760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53374956.0000; val_optim_loss: 53374956.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9039; val_auprc_score: 0.9742; val_best_acc_score: 0.8476; val_best_f1_score: 0.9175; train_kl_reg_loss: 663054.8750; train_edge_recon_loss: 1176267.2292; train_gene_expr_recon_loss: 51345493.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53184816.0000; train_optim_loss: 53184816.0000; val_kl_reg_loss: 655870.1875; val_edge_recon_loss: 1239102.2500; val_gene_expr_recon_loss: 51491824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53386796.0000; val_optim_loss: 53386796.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8911; val_auprc_score: 0.9703; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 661827.1875; train_edge_recon_loss: 1193135.6042; train_gene_expr_recon_loss: 51323207.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53178170.0000; train_optim_loss: 53178170.0000; val_kl_reg_loss: 653031.5625; val_edge_recon_loss: 1228106.1250; val_gene_expr_recon_loss: 51412864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53294000.0000; val_optim_loss: 53294000.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 4 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.8937
val AUPRC score: 0.9758
val best accuracy score: 0.8554
val best F1 score: 0.9221
val target rna MSE score: 24.1263
val source rna MSE score: 33.3567
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 1 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1484, n_latent: 1474, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1474, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1474, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9078; val_auprc_score: 0.9809; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 2466390.3980; train_edge_recon_loss: 1066909.5398; train_gene_expr_recon_loss: 231056341.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 234589642.5455; train_optim_loss: 234589642.5455; val_kl_reg_loss: 210314.8828; val_edge_recon_loss: 1170293.1250; val_gene_expr_recon_loss: 64595644.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65976254.0000; val_optim_loss: 65976254.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8980; val_auprc_score: 0.9756; val_best_acc_score: 0.8499; val_best_f1_score: 0.9188; train_kl_reg_loss: 300972.1648; train_edge_recon_loss: 1157976.0568; train_gene_expr_recon_loss: 65792414.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67251362.9091; train_optim_loss: 67251362.9091; val_kl_reg_loss: 366687.0625; val_edge_recon_loss: 1299846.1875; val_gene_expr_recon_loss: 64581888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66248420.0000; val_optim_loss: 66248420.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8972; val_auprc_score: 0.9730; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 661372.7188; train_edge_recon_loss: 1191463.6042; train_gene_expr_recon_loss: 51267250.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53120086.0000; train_optim_loss: 53120086.0000; val_kl_reg_loss: 653252.0000; val_edge_recon_loss: 1207239.0000; val_gene_expr_recon_loss: 51367280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53227772.0000; val_optim_loss: 53227772.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8926; val_auprc_score: 0.9762; val_best_acc_score: 0.8642; val_best_f1_score: 0.9272; train_kl_reg_loss: 405013.6506; train_edge_recon_loss: 1180034.8864; train_gene_expr_recon_loss: 60818104.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62403153.4545; train_optim_loss: 62403153.4545; val_kl_reg_loss: 429570.6406; val_edge_recon_loss: 1065622.0312; val_gene_expr_recon_loss: 58936566.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60431758.0000; val_optim_loss: 60431758.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8997; val_auprc_score: 0.9775; val_best_acc_score: 0.8590; val_best_f1_score: 0.9241; train_kl_reg_loss: 442029.7017; train_edge_recon_loss: 1193936.4432; train_gene_expr_recon_loss: 58075710.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59711676.3636; train_optim_loss: 59711676.3636; val_kl_reg_loss: 446235.0625; val_edge_recon_loss: 1119789.3750; val_gene_expr_recon_loss: 57407220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58973244.0000; val_optim_loss: 58973244.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9036; val_auprc_score: 0.9759; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 659986.0625; train_edge_recon_loss: 1199632.3125; train_gene_expr_recon_loss: 51181733.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53041352.0000; train_optim_loss: 53041352.0000; val_kl_reg_loss: 653775.6875; val_edge_recon_loss: 1157639.3750; val_gene_expr_recon_loss: 51314956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53126372.0000; val_optim_loss: 53126372.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9058; val_auprc_score: 0.9775; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 452435.9432; train_edge_recon_loss: 1211257.7045; train_gene_expr_recon_loss: 56674351.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58338044.7273; train_optim_loss: 58338044.7273; val_kl_reg_loss: 459404.4688; val_edge_recon_loss: 1218014.1875; val_gene_expr_recon_loss: 56707412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58384830.0000; val_optim_loss: 58384830.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8893; val_auprc_score: 0.9698; val_best_acc_score: 0.8392; val_best_f1_score: 0.9125; train_kl_reg_loss: 453079.1619; train_edge_recon_loss: 1188179.3523; train_gene_expr_recon_loss: 55634990.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57276248.3636; train_optim_loss: 57276248.3636; val_kl_reg_loss: 445423.1719; val_edge_recon_loss: 1344711.3750; val_gene_expr_recon_loss: 55191832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56981966.0000; val_optim_loss: 56981966.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9022; val_auprc_score: 0.9743; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 659697.4062; train_edge_recon_loss: 1182119.0833; train_gene_expr_recon_loss: 51146796.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52988612.0000; train_optim_loss: 52988612.0000; val_kl_reg_loss: 652823.0625; val_edge_recon_loss: 1212160.5000; val_gene_expr_recon_loss: 51248144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53113128.0000; val_optim_loss: 53113128.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9135; val_auprc_score: 0.9798; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 447613.4631; train_edge_recon_loss: 1213036.3068; train_gene_expr_recon_loss: 54754923.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56415572.7273; train_optim_loss: 56415572.7273; val_kl_reg_loss: 451988.2031; val_edge_recon_loss: 1185674.1875; val_gene_expr_recon_loss: 54426110.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56063772.0000; val_optim_loss: 56063772.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8937; val_auprc_score: 0.9721; val_best_acc_score: 0.8460; val_best_f1_score: 0.9166; train_kl_reg_loss: 438473.7386; train_edge_recon_loss: 1200174.7159; train_gene_expr_recon_loss: 53757835.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55396483.6364; train_optim_loss: 55396483.6364; val_kl_reg_loss: 435954.7812; val_edge_recon_loss: 1217301.6875; val_gene_expr_recon_loss: 53662104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55315360.0000; val_optim_loss: 55315360.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9062; val_auprc_score: 0.9754; val_best_acc_score: 0.8488; val_best_f1_score: 0.9182; train_kl_reg_loss: 659481.4792; train_edge_recon_loss: 1183759.6875; train_gene_expr_recon_loss: 51074009.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52917250.6667; train_optim_loss: 52917250.6667; val_kl_reg_loss: 651567.8750; val_edge_recon_loss: 1229329.6250; val_gene_expr_recon_loss: 51172256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53053152.0000; val_optim_loss: 53053152.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8846; val_auprc_score: 0.9707; val_best_acc_score: 0.8451; val_best_f1_score: 0.9160; train_kl_reg_loss: 429288.1818; train_edge_recon_loss: 1201586.2841; train_gene_expr_recon_loss: 52657544.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54288418.9091; train_optim_loss: 54288418.9091; val_kl_reg_loss: 423575.5625; val_edge_recon_loss: 1269954.6875; val_gene_expr_recon_loss: 52419318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54112848.0000; val_optim_loss: 54112848.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8909; val_auprc_score: 0.9722; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 657891.4375; train_edge_recon_loss: 1179785.3958; train_gene_expr_recon_loss: 51026682.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52864359.3333; train_optim_loss: 52864359.3333; val_kl_reg_loss: 649465.1250; val_edge_recon_loss: 1153890.7500; val_gene_expr_recon_loss: 51093800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52897156.0000; val_optim_loss: 52897156.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8864; val_auprc_score: 0.9718; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 419917.6847; train_edge_recon_loss: 1199457.7500; train_gene_expr_recon_loss: 51437559.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53056935.2727; train_optim_loss: 53056935.2727; val_kl_reg_loss: 416579.8750; val_edge_recon_loss: 1229187.4375; val_gene_expr_recon_loss: 51548504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53194272.0000; val_optim_loss: 53194272.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8818; val_auprc_score: 0.9726; val_best_acc_score: 0.8590; val_best_f1_score: 0.9241; train_kl_reg_loss: 410647.8892; train_edge_recon_loss: 1205536.7159; train_gene_expr_recon_loss: 50193654.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51809839.6364; train_optim_loss: 51809839.6364; val_kl_reg_loss: 413000.0000; val_edge_recon_loss: 1216738.6250; val_gene_expr_recon_loss: 49878404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51508144.0000; val_optim_loss: 51508144.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9018; val_auprc_score: 0.9785; val_best_acc_score: 0.8578; val_best_f1_score: 0.9234; train_kl_reg_loss: 399468.5739; train_edge_recon_loss: 1184832.6932; train_gene_expr_recon_loss: 48905447.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50489748.3636; train_optim_loss: 50489748.3636; val_kl_reg_loss: 391752.3281; val_edge_recon_loss: 1096353.5312; val_gene_expr_recon_loss: 48542690.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50030796.0000; val_optim_loss: 50030796.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8984; val_auprc_score: 0.9727; val_best_acc_score: 0.8487; val_best_f1_score: 0.9182; train_kl_reg_loss: 657611.1042; train_edge_recon_loss: 1195617.8125; train_gene_expr_recon_loss: 50952748.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52805977.3333; train_optim_loss: 52805977.3333; val_kl_reg_loss: 649337.1875; val_edge_recon_loss: 1230552.6250; val_gene_expr_recon_loss: 51040560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52920448.0000; val_optim_loss: 52920448.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8941; val_auprc_score: 0.9745; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 389488.3636; train_edge_recon_loss: 1183314.5568; train_gene_expr_recon_loss: 47732908.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49305710.9091; train_optim_loss: 49305710.9091; val_kl_reg_loss: 381517.1875; val_edge_recon_loss: 1163150.4375; val_gene_expr_recon_loss: 47346458.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48891126.0000; val_optim_loss: 48891126.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9004; val_auprc_score: 0.9765; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 377826.6080; train_edge_recon_loss: 1160364.4886; train_gene_expr_recon_loss: 46696449.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48234640.0000; train_optim_loss: 48234640.0000; val_kl_reg_loss: 376577.2188; val_edge_recon_loss: 1254739.7500; val_gene_expr_recon_loss: 45985056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47616374.0000; val_optim_loss: 47616374.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9024; val_auprc_score: 0.9754; val_best_acc_score: 0.8566; val_best_f1_score: 0.9228; train_kl_reg_loss: 656050.3333; train_edge_recon_loss: 1193029.9583; train_gene_expr_recon_loss: 50882590.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52731670.0000; train_optim_loss: 52731670.0000; val_kl_reg_loss: 648103.7500; val_edge_recon_loss: 1166370.7500; val_gene_expr_recon_loss: 50970824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52785300.0000; val_optim_loss: 52785300.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8992; val_auprc_score: 0.9754; val_best_acc_score: 0.8451; val_best_f1_score: 0.9160; train_kl_reg_loss: 367089.3438; train_edge_recon_loss: 1200601.7159; train_gene_expr_recon_loss: 45822861.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47390553.4545; train_optim_loss: 47390553.4545; val_kl_reg_loss: 358514.1250; val_edge_recon_loss: 1263159.4375; val_gene_expr_recon_loss: 45505768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47127442.0000; val_optim_loss: 47127442.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8798; val_auprc_score: 0.9736; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 355882.8040; train_edge_recon_loss: 1205446.6364; train_gene_expr_recon_loss: 45148563.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46709893.0909; train_optim_loss: 46709893.0909; val_kl_reg_loss: 354631.1562; val_edge_recon_loss: 1257042.6875; val_gene_expr_recon_loss: 44753724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46365398.0000; val_optim_loss: 46365398.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9026; val_auprc_score: 0.9761; val_best_acc_score: 0.8614; val_best_f1_score: 0.9255; train_kl_reg_loss: 655537.8750; train_edge_recon_loss: 1189974.6667; train_gene_expr_recon_loss: 50792915.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52638427.3333; train_optim_loss: 52638427.3333; val_kl_reg_loss: 648033.7500; val_edge_recon_loss: 1127536.8750; val_gene_expr_recon_loss: 50914080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52689652.0000; val_optim_loss: 52689652.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8845; val_auprc_score: 0.9729; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 346949.8636; train_edge_recon_loss: 1210418.7386; train_gene_expr_recon_loss: 44642662.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46200031.2727; train_optim_loss: 46200031.2727; val_kl_reg_loss: 339785.5625; val_edge_recon_loss: 1058288.6250; val_gene_expr_recon_loss: 44675972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46074046.0000; val_optim_loss: 46074046.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8851; val_auprc_score: 0.9757; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 335355.2216; train_edge_recon_loss: 1210956.6477; train_gene_expr_recon_loss: 44242562.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45788873.0909; train_optim_loss: 45788873.0909; val_kl_reg_loss: 327081.0000; val_edge_recon_loss: 1158557.0625; val_gene_expr_recon_loss: 44347004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45832642.0000; val_optim_loss: 45832642.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8952; val_auprc_score: 0.9741; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 654687.9271; train_edge_recon_loss: 1197054.6042; train_gene_expr_recon_loss: 50771213.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52622956.6667; train_optim_loss: 52622956.6667; val_kl_reg_loss: 647043.0000; val_edge_recon_loss: 1150138.1250; val_gene_expr_recon_loss: 50846240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52643420.0000; val_optim_loss: 52643420.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8987; val_auprc_score: 0.9776; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 413023.6648; train_edge_recon_loss: 1189122.2841; train_gene_expr_recon_loss: 47476958.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49079104.0000; train_optim_loss: 49079104.0000; val_kl_reg_loss: 354972.3750; val_edge_recon_loss: 1224859.8125; val_gene_expr_recon_loss: 44367720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45947552.0000; val_optim_loss: 45947552.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8787; val_auprc_score: 0.9713; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 377722.1250; train_edge_recon_loss: 1189186.8523; train_gene_expr_recon_loss: 43993407.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45560316.0000; train_optim_loss: 45560316.0000; val_kl_reg_loss: 403473.4375; val_edge_recon_loss: 1173064.7500; val_gene_expr_recon_loss: 43710334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45286872.0000; val_optim_loss: 45286872.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8989; val_auprc_score: 0.9721; val_best_acc_score: 0.8446; val_best_f1_score: 0.9158; train_kl_reg_loss: 653738.3646; train_edge_recon_loss: 1201637.3333; train_gene_expr_recon_loss: 50702206.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52557582.6667; train_optim_loss: 52557582.6667; val_kl_reg_loss: 646509.6250; val_edge_recon_loss: 1263413.6250; val_gene_expr_recon_loss: 50774860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52684784.0000; val_optim_loss: 52684784.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8760; val_auprc_score: 0.9681; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 392037.4176; train_edge_recon_loss: 1162072.8352; train_gene_expr_recon_loss: 43622950.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45177061.0909; train_optim_loss: 45177061.0909; val_kl_reg_loss: 390261.7031; val_edge_recon_loss: 1201666.8125; val_gene_expr_recon_loss: 43716636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45308564.0000; val_optim_loss: 45308564.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8796; val_auprc_score: 0.9731; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 382315.2131; train_edge_recon_loss: 1164880.5341; train_gene_expr_recon_loss: 43394400.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44941596.3636; train_optim_loss: 44941596.3636; val_kl_reg_loss: 374034.8438; val_edge_recon_loss: 1128450.1250; val_gene_expr_recon_loss: 43588010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45090496.0000; val_optim_loss: 45090496.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8976; val_auprc_score: 0.9719; val_best_acc_score: 0.8455; val_best_f1_score: 0.9163; train_kl_reg_loss: 652017.1458; train_edge_recon_loss: 1202141.7083; train_gene_expr_recon_loss: 50603020.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52457178.6667; train_optim_loss: 52457178.6667; val_kl_reg_loss: 644094.1250; val_edge_recon_loss: 1256138.2500; val_gene_expr_recon_loss: 50694896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52595128.0000; val_optim_loss: 52595128.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8901; val_auprc_score: 0.9750; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 366545.0881; train_edge_recon_loss: 1173008.2500; train_gene_expr_recon_loss: 43241837.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44781390.9091; train_optim_loss: 44781390.9091; val_kl_reg_loss: 360653.5625; val_edge_recon_loss: 1157414.3125; val_gene_expr_recon_loss: 43432364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44950432.0000; val_optim_loss: 44950432.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8825; val_auprc_score: 0.9752; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 349246.7017; train_edge_recon_loss: 1203550.3864; train_gene_expr_recon_loss: 43137561.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44690359.6364; train_optim_loss: 44690359.6364; val_kl_reg_loss: 341515.0781; val_edge_recon_loss: 1094900.0625; val_gene_expr_recon_loss: 43504086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44940502.0000; val_optim_loss: 44940502.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9008; val_auprc_score: 0.9743; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 652632.6979; train_edge_recon_loss: 1197378.3958; train_gene_expr_recon_loss: 50518051.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52368062.6667; train_optim_loss: 52368062.6667; val_kl_reg_loss: 643881.6250; val_edge_recon_loss: 1196140.6250; val_gene_expr_recon_loss: 50630696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52470720.0000; val_optim_loss: 52470720.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8703; val_auprc_score: 0.9729; val_best_acc_score: 0.8705; val_best_f1_score: 0.9308; train_kl_reg_loss: 333885.6080; train_edge_recon_loss: 1203612.3750; train_gene_expr_recon_loss: 43044696.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44582194.5455; train_optim_loss: 44582194.5455; val_kl_reg_loss: 3940730.5000; val_edge_recon_loss: 1028461.6875; val_gene_expr_recon_loss: 43147354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48116546.0000; val_optim_loss: 48116546.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8965; val_auprc_score: 0.9740; val_best_acc_score: 0.8566; val_best_f1_score: 0.9228; train_kl_reg_loss: 650765.6354; train_edge_recon_loss: 1195821.1458; train_gene_expr_recon_loss: 50442238.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52288826.0000; train_optim_loss: 52288826.0000; val_kl_reg_loss: 642742.0000; val_edge_recon_loss: 1166370.6250; val_gene_expr_recon_loss: 50560032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52369144.0000; val_optim_loss: 52369144.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8678; val_auprc_score: 0.9652; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 329372608.4830; train_edge_recon_loss: 1114173.6136; train_gene_expr_recon_loss: 591443657.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 921930437.0909; train_optim_loss: 921930437.0909; val_kl_reg_loss: 1925107.4375; val_edge_recon_loss: 1126989.4688; val_gene_expr_recon_loss: 122947336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 125999436.0000; val_optim_loss: 125999436.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8263; val_auprc_score: 0.9471; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 1263325.8523; train_edge_recon_loss: 1156951.9773; train_gene_expr_recon_loss: 154343054.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 156763330.1818; train_optim_loss: 156763330.1818; val_kl_reg_loss: 1423389.6875; val_edge_recon_loss: 1168909.6875; val_gene_expr_recon_loss: 91330596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 93922892.0000; val_optim_loss: 93922892.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9062; val_auprc_score: 0.9765; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 650106.1146; train_edge_recon_loss: 1184613.1667; train_gene_expr_recon_loss: 50428154.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52262873.3333; train_optim_loss: 52262873.3333; val_kl_reg_loss: 642466.4375; val_edge_recon_loss: 1170105.6250; val_gene_expr_recon_loss: 50491884.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52304456.0000; val_optim_loss: 52304456.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8310; val_auprc_score: 0.9470; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 1756716.0000; train_edge_recon_loss: 1183806.3864; train_gene_expr_recon_loss: 123430565.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 126371088.0000; train_optim_loss: 126371088.0000; val_kl_reg_loss: 1916273.1250; val_edge_recon_loss: 1161635.8750; val_gene_expr_recon_loss: 60319510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63397420.0000; val_optim_loss: 63397420.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8961; val_auprc_score: 0.9724; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 648703.2917; train_edge_recon_loss: 1159168.5417; train_gene_expr_recon_loss: 50319488.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52127360.0000; train_optim_loss: 52127360.0000; val_kl_reg_loss: 641098.3125; val_edge_recon_loss: 1209700.5000; val_gene_expr_recon_loss: 50416880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52267680.0000; val_optim_loss: 52267680.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8396; val_auprc_score: 0.9526; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 1945272.5114; train_edge_recon_loss: 1204748.3409; train_gene_expr_recon_loss: 58145466.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61295487.6364; train_optim_loss: 61295487.6364; val_kl_reg_loss: 1930104.8750; val_edge_recon_loss: 1142729.3125; val_gene_expr_recon_loss: 57000384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60073218.0000; val_optim_loss: 60073218.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8967; val_auprc_score: 0.9720; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 647695.7812; train_edge_recon_loss: 1185177.0208; train_gene_expr_recon_loss: 50225885.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52058758.0000; train_optim_loss: 52058758.0000; val_kl_reg_loss: 640087.0000; val_edge_recon_loss: 1243978.5000; val_gene_expr_recon_loss: 50349968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52234032.0000; val_optim_loss: 52234032.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8289; val_auprc_score: 0.9466; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 1920672.5341; train_edge_recon_loss: 1193578.3750; train_gene_expr_recon_loss: 56321998.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59436248.7273; train_optim_loss: 59436248.7273; val_kl_reg_loss: 1914867.6875; val_edge_recon_loss: 1193082.1875; val_gene_expr_recon_loss: 55984384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59092334.0000; val_optim_loss: 59092334.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8925; val_auprc_score: 0.9707; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 645840.3958; train_edge_recon_loss: 1192958.2917; train_gene_expr_recon_loss: 50165329.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52004127.3333; train_optim_loss: 52004127.3333; val_kl_reg_loss: 638507.1250; val_edge_recon_loss: 1203543.3750; val_gene_expr_recon_loss: 50272212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52114264.0000; val_optim_loss: 52114264.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8277; val_auprc_score: 0.9450; val_best_acc_score: 0.8472; val_best_f1_score: 0.9173; train_kl_reg_loss: 1892929.2159; train_edge_recon_loss: 1199735.0114; train_gene_expr_recon_loss: 55522272.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58614936.0000; train_optim_loss: 58614936.0000; val_kl_reg_loss: 1906014.9375; val_edge_recon_loss: 1253207.6250; val_gene_expr_recon_loss: 55622360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58781584.0000; val_optim_loss: 58781584.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8858; val_auprc_score: 0.9707; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 645984.8958; train_edge_recon_loss: 1212215.0208; train_gene_expr_recon_loss: 50115004.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51973204.6667; train_optim_loss: 51973204.6667; val_kl_reg_loss: 638194.5000; val_edge_recon_loss: 1170106.1250; val_gene_expr_recon_loss: 50201176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52009476.0000; val_optim_loss: 52009476.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8183; val_auprc_score: 0.9465; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 1866822.1932; train_edge_recon_loss: 1219936.5568; train_gene_expr_recon_loss: 55188056.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58274815.2727; train_optim_loss: 58274815.2727; val_kl_reg_loss: 1848175.1875; val_edge_recon_loss: 1204864.8125; val_gene_expr_recon_loss: 54488262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57541302.0000; val_optim_loss: 57541302.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8998; val_auprc_score: 0.9731; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 644584.8750; train_edge_recon_loss: 1176580.5417; train_gene_expr_recon_loss: 50001624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51822790.0000; train_optim_loss: 51822790.0000; val_kl_reg_loss: 636148.2500; val_edge_recon_loss: 1226881.8750; val_gene_expr_recon_loss: 50107328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51970360.0000; val_optim_loss: 51970360.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8992; val_auprc_score: 0.9738; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 643113.1458; train_edge_recon_loss: 1175577.0000; train_gene_expr_recon_loss: 49902338.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51721028.6667; train_optim_loss: 51721028.6667; val_kl_reg_loss: 635833.5625; val_edge_recon_loss: 1182527.5000; val_gene_expr_recon_loss: 50039480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51857840.0000; val_optim_loss: 51857840.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8976; val_auprc_score: 0.9736; val_best_acc_score: 0.8538; val_best_f1_score: 0.9212; train_kl_reg_loss: 642138.0521; train_edge_recon_loss: 1178526.1458; train_gene_expr_recon_loss: 49856743.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51677407.3333; train_optim_loss: 51677407.3333; val_kl_reg_loss: 634622.2500; val_edge_recon_loss: 1188722.0000; val_gene_expr_recon_loss: 49955264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51778608.0000; val_optim_loss: 51778608.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8987; val_auprc_score: 0.9741; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 641168.3438; train_edge_recon_loss: 1204395.3750; train_gene_expr_recon_loss: 49780678.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51626243.3333; train_optim_loss: 51626243.3333; val_kl_reg_loss: 634104.3750; val_edge_recon_loss: 1170105.3750; val_gene_expr_recon_loss: 49879488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51683696.0000; val_optim_loss: 51683696.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8890; val_auprc_score: 0.9726; val_best_acc_score: 0.8620; val_best_f1_score: 0.9259; train_kl_reg_loss: 639975.1146; train_edge_recon_loss: 1213027.2500; train_gene_expr_recon_loss: 49714122.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51567124.6667; train_optim_loss: 51567124.6667; val_kl_reg_loss: 632011.1250; val_edge_recon_loss: 1122494.6250; val_gene_expr_recon_loss: 49792360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51546864.0000; val_optim_loss: 51546864.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8947; val_auprc_score: 0.9728; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 637793.1250; train_edge_recon_loss: 1201023.8958; train_gene_expr_recon_loss: 49623549.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51462366.0000; train_optim_loss: 51462366.0000; val_kl_reg_loss: 629296.1250; val_edge_recon_loss: 1186245.6250; val_gene_expr_recon_loss: 49698372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51513912.0000; val_optim_loss: 51513912.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9004; val_auprc_score: 0.9732; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 635317.9271; train_edge_recon_loss: 1185109.5208; train_gene_expr_recon_loss: 49525435.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51345863.3333; train_optim_loss: 51345863.3333; val_kl_reg_loss: 630061.8750; val_edge_recon_loss: 1223207.3750; val_gene_expr_recon_loss: 49642760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51496028.0000; val_optim_loss: 51496028.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9033; val_auprc_score: 0.9753; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 635734.0521; train_edge_recon_loss: 1185162.3750; train_gene_expr_recon_loss: 49458062.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51278958.6667; train_optim_loss: 51278958.6667; val_kl_reg_loss: 628546.6250; val_edge_recon_loss: 1173836.8750; val_gene_expr_recon_loss: 49545496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51347880.0000; val_optim_loss: 51347880.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8997; val_auprc_score: 0.9755; val_best_acc_score: 0.8595; val_best_f1_score: 0.9244; train_kl_reg_loss: 634768.1771; train_edge_recon_loss: 1195486.2292; train_gene_expr_recon_loss: 49363659.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51193914.0000; train_optim_loss: 51193914.0000; val_kl_reg_loss: 626869.5000; val_edge_recon_loss: 1142620.6250; val_gene_expr_recon_loss: 49459768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51229260.0000; val_optim_loss: 51229260.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 13 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.8905
val AUPRC score: 0.9762
val best accuracy score: 0.8624
val best F1 score: 0.9261
val target rna MSE score: 23.6543
val source rna MSE score: 19.8637
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 1 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1484, n_latent: 1474, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1474, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1474, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9151; val_auprc_score: 0.9816; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 21807021.3287; train_edge_recon_loss: 1046992.7898; train_gene_expr_recon_loss: 513194213.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 536048218.9091; train_optim_loss: 536048218.9091; val_kl_reg_loss: 203878.2734; val_edge_recon_loss: 1275218.3750; val_gene_expr_recon_loss: 68319336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69798432.0000; val_optim_loss: 69798432.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8976; val_auprc_score: 0.9742; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 633059.5729; train_edge_recon_loss: 1196474.4792; train_gene_expr_recon_loss: 49283746.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51113280.6667; train_optim_loss: 51113280.6667; val_kl_reg_loss: 626403.3125; val_edge_recon_loss: 1162631.2500; val_gene_expr_recon_loss: 49381160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51170196.0000; val_optim_loss: 51170196.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8909; val_auprc_score: 0.9746; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 305510.3750; train_edge_recon_loss: 1167111.2500; train_gene_expr_recon_loss: 69073375.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70545998.1818; train_optim_loss: 70545998.1818; val_kl_reg_loss: 384087.5938; val_edge_recon_loss: 1099376.2188; val_gene_expr_recon_loss: 64868140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66351604.0000; val_optim_loss: 66351604.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8779; val_auprc_score: 0.9680; val_best_acc_score: 0.8499; val_best_f1_score: 0.9188; train_kl_reg_loss: 430904.2159; train_edge_recon_loss: 1188386.5114; train_gene_expr_recon_loss: 61433474.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63052765.4545; train_optim_loss: 63052765.4545; val_kl_reg_loss: 475540.9375; val_edge_recon_loss: 1212811.8750; val_gene_expr_recon_loss: 60759602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62447954.0000; val_optim_loss: 62447954.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8931; val_auprc_score: 0.9711; val_best_acc_score: 0.8482; val_best_f1_score: 0.9179; train_kl_reg_loss: 631578.1146; train_edge_recon_loss: 1171947.9792; train_gene_expr_recon_loss: 49169614.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50973140.6667; train_optim_loss: 50973140.6667; val_kl_reg_loss: 624469.1875; val_edge_recon_loss: 1234219.2500; val_gene_expr_recon_loss: 49291828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51150516.0000; val_optim_loss: 51150516.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8711; val_auprc_score: 0.9671; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 521116.2358; train_edge_recon_loss: 1167115.3466; train_gene_expr_recon_loss: 58908921.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60597153.0909; train_optim_loss: 60597153.0909; val_kl_reg_loss: 556705.6875; val_edge_recon_loss: 1168511.1875; val_gene_expr_recon_loss: 58155196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59880412.0000; val_optim_loss: 59880412.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8936; val_auprc_score: 0.9735; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 571276.9602; train_edge_recon_loss: 1205143.9659; train_gene_expr_recon_loss: 57571237.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59347658.5455; train_optim_loss: 59347658.5455; val_kl_reg_loss: 588317.0938; val_edge_recon_loss: 1189737.2500; val_gene_expr_recon_loss: 57093858.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58871912.0000; val_optim_loss: 58871912.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9030; val_auprc_score: 0.9738; val_best_acc_score: 0.8442; val_best_f1_score: 0.9155; train_kl_reg_loss: 629348.0521; train_edge_recon_loss: 1192207.1042; train_gene_expr_recon_loss: 49124579.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50946134.0000; train_optim_loss: 50946134.0000; val_kl_reg_loss: 622163.3750; val_edge_recon_loss: 1267045.5000; val_gene_expr_recon_loss: 49194700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51083908.0000; val_optim_loss: 51083908.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8584; val_auprc_score: 0.9602; val_best_acc_score: 0.8448; val_best_f1_score: 0.9159; train_kl_reg_loss: 587999.1761; train_edge_recon_loss: 1195204.5568; train_gene_expr_recon_loss: 56797936.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58581140.7273; train_optim_loss: 58581140.7273; val_kl_reg_loss: 585299.2812; val_edge_recon_loss: 1165068.1250; val_gene_expr_recon_loss: 56323832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58074200.0000; val_optim_loss: 58074200.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9015; val_auprc_score: 0.9749; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 630111.7396; train_edge_recon_loss: 1193870.5417; train_gene_expr_recon_loss: 49071472.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50895454.0000; train_optim_loss: 50895454.0000; val_kl_reg_loss: 621503.5000; val_edge_recon_loss: 1182527.3750; val_gene_expr_recon_loss: 49110200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50914232.0000; val_optim_loss: 50914232.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8842; val_auprc_score: 0.9704; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 588532.7841; train_edge_recon_loss: 1164812.8977; train_gene_expr_recon_loss: 56125870.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57879216.0000; train_optim_loss: 57879216.0000; val_kl_reg_loss: 578829.8125; val_edge_recon_loss: 1238436.1875; val_gene_expr_recon_loss: 55838916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57656182.0000; val_optim_loss: 57656182.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8821; val_auprc_score: 0.9690; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 581242.5341; train_edge_recon_loss: 1196488.0341; train_gene_expr_recon_loss: 55509365.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57287096.3636; train_optim_loss: 57287096.3636; val_kl_reg_loss: 574257.8125; val_edge_recon_loss: 1193079.7500; val_gene_expr_recon_loss: 55166756.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56934094.0000; val_optim_loss: 56934094.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8831; val_auprc_score: 0.9716; val_best_acc_score: 0.8596; val_best_f1_score: 0.9245; train_kl_reg_loss: 570461.5227; train_edge_recon_loss: 1229223.0000; train_gene_expr_recon_loss: 54873754.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56673438.5455; train_optim_loss: 56673438.5455; val_kl_reg_loss: 558412.6250; val_edge_recon_loss: 1138331.8750; val_gene_expr_recon_loss: 55172616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56869360.0000; val_optim_loss: 56869360.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9014; val_auprc_score: 0.9752; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 627824.8958; train_edge_recon_loss: 1191465.5833; train_gene_expr_recon_loss: 48970643.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50789934.6667; train_optim_loss: 50789934.6667; val_kl_reg_loss: 620531.5625; val_edge_recon_loss: 1170105.3750; val_gene_expr_recon_loss: 49029600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50820236.0000; val_optim_loss: 50820236.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8819; val_auprc_score: 0.9725; val_best_acc_score: 0.8658; val_best_f1_score: 0.9281; train_kl_reg_loss: 558377.7670; train_edge_recon_loss: 1163340.3636; train_gene_expr_recon_loss: 54104961.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55826679.6364; train_optim_loss: 55826679.6364; val_kl_reg_loss: 550746.8438; val_edge_recon_loss: 1108753.5625; val_gene_expr_recon_loss: 53329754.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54989256.0000; val_optim_loss: 54989256.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8931; val_auprc_score: 0.9720; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 625642.9062; train_edge_recon_loss: 1199271.5625; train_gene_expr_recon_loss: 48869168.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50694082.0000; train_optim_loss: 50694082.0000; val_kl_reg_loss: 619445.8750; val_edge_recon_loss: 1209700.5000; val_gene_expr_recon_loss: 48941872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50771020.0000; val_optim_loss: 50771020.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8993; val_auprc_score: 0.9768; val_best_acc_score: 0.8639; val_best_f1_score: 0.9270; train_kl_reg_loss: 546585.6761; train_edge_recon_loss: 1192595.7841; train_gene_expr_recon_loss: 53195151.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54934332.7273; train_optim_loss: 54934332.7273; val_kl_reg_loss: 540466.7812; val_edge_recon_loss: 1014295.4062; val_gene_expr_recon_loss: 52622686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54177448.0000; val_optim_loss: 54177448.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8842; val_auprc_score: 0.9699; val_best_acc_score: 0.8478; val_best_f1_score: 0.9176; train_kl_reg_loss: 533486.6477; train_edge_recon_loss: 1202891.7841; train_gene_expr_recon_loss: 52092339.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53828718.1818; train_optim_loss: 53828718.1818; val_kl_reg_loss: 532012.6562; val_edge_recon_loss: 1250347.8750; val_gene_expr_recon_loss: 51384002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53166362.0000; val_optim_loss: 53166362.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9005; val_auprc_score: 0.9748; val_best_acc_score: 0.8538; val_best_f1_score: 0.9212; train_kl_reg_loss: 624008.5625; train_edge_recon_loss: 1191583.7083; train_gene_expr_recon_loss: 48754709.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50570302.0000; train_optim_loss: 50570302.0000; val_kl_reg_loss: 616590.5000; val_edge_recon_loss: 1188721.7500; val_gene_expr_recon_loss: 48838488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50643800.0000; val_optim_loss: 50643800.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8867; val_auprc_score: 0.9704; val_best_acc_score: 0.8448; val_best_f1_score: 0.9159; train_kl_reg_loss: 520532.2955; train_edge_recon_loss: 1178501.2500; train_gene_expr_recon_loss: 50955838.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52654872.7273; train_optim_loss: 52654872.7273; val_kl_reg_loss: 518012.8594; val_edge_recon_loss: 1284839.3125; val_gene_expr_recon_loss: 50361682.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52164534.0000; val_optim_loss: 52164534.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8885; val_auprc_score: 0.9740; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 508143.8551; train_edge_recon_loss: 1202749.2273; train_gene_expr_recon_loss: 49887062.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51597955.2727; train_optim_loss: 51597955.2727; val_kl_reg_loss: 509292.0000; val_edge_recon_loss: 1140049.0625; val_gene_expr_recon_loss: 49199086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50848428.0000; val_optim_loss: 50848428.0000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9061; val_auprc_score: 0.9760; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 623903.4062; train_edge_recon_loss: 1167906.2500; train_gene_expr_recon_loss: 48683852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50475660.6667; train_optim_loss: 50475660.6667; val_kl_reg_loss: 615819.3125; val_edge_recon_loss: 1196140.2500; val_gene_expr_recon_loss: 48747436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50559396.0000; val_optim_loss: 50559396.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8696; val_auprc_score: 0.9680; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 494590.0227; train_edge_recon_loss: 1187276.0114; train_gene_expr_recon_loss: 48842774.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50524640.0000; train_optim_loss: 50524640.0000; val_kl_reg_loss: 478500.9062; val_edge_recon_loss: 1214506.1250; val_gene_expr_recon_loss: 47997892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49690900.0000; val_optim_loss: 49690900.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8686; val_auprc_score: 0.9670; val_best_acc_score: 0.8460; val_best_f1_score: 0.9166; train_kl_reg_loss: 481910.8239; train_edge_recon_loss: 1221751.5341; train_gene_expr_recon_loss: 47983551.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49687214.1818; train_optim_loss: 49687214.1818; val_kl_reg_loss: 472329.3438; val_edge_recon_loss: 1279147.0625; val_gene_expr_recon_loss: 47747480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49498956.0000; val_optim_loss: 49498956.0000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9035; val_auprc_score: 0.9753; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 623235.2708; train_edge_recon_loss: 1199115.3750; train_gene_expr_recon_loss: 48575588.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50397939.3333; train_optim_loss: 50397939.3333; val_kl_reg_loss: 613801.8750; val_edge_recon_loss: 1207239.0000; val_gene_expr_recon_loss: 48656692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50477732.0000; val_optim_loss: 50477732.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8802; val_auprc_score: 0.9730; val_best_acc_score: 0.8593; val_best_f1_score: 0.9243; train_kl_reg_loss: 468783.9688; train_edge_recon_loss: 1216289.6591; train_gene_expr_recon_loss: 47262912.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48947986.1818; train_optim_loss: 48947986.1818; val_kl_reg_loss: 457365.5781; val_edge_recon_loss: 1195172.3125; val_gene_expr_recon_loss: 46852816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48505354.0000; val_optim_loss: 48505354.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8834; val_auprc_score: 0.9736; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 455871.0170; train_edge_recon_loss: 1189387.5455; train_gene_expr_recon_loss: 46723330.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48368589.4545; train_optim_loss: 48368589.4545; val_kl_reg_loss: 452846.4688; val_edge_recon_loss: 1161720.2500; val_gene_expr_recon_loss: 46912504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48527072.0000; val_optim_loss: 48527072.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8762; val_auprc_score: 0.9731; val_best_acc_score: 0.8639; val_best_f1_score: 0.9270; train_kl_reg_loss: 442761.1562; train_edge_recon_loss: 1196739.1932; train_gene_expr_recon_loss: 46263666.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47903166.9091; train_optim_loss: 47903166.9091; val_kl_reg_loss: 440250.0625; val_edge_recon_loss: 1029612.3750; val_gene_expr_recon_loss: 46281376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47751238.0000; val_optim_loss: 47751238.0000
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.8906; val_auprc_score: 0.9716; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 620695.2604; train_edge_recon_loss: 1192067.4792; train_gene_expr_recon_loss: 48484917.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50297680.0000; train_optim_loss: 50297680.0000; val_kl_reg_loss: 613730.0000; val_edge_recon_loss: 1175079.3750; val_gene_expr_recon_loss: 48573232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50362040.0000; val_optim_loss: 50362040.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8689; val_auprc_score: 0.9690; val_best_acc_score: 0.8475; val_best_f1_score: 0.9174; train_kl_reg_loss: 431693.5653; train_edge_recon_loss: 1185095.9659; train_gene_expr_recon_loss: 45963958.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47580748.3636; train_optim_loss: 47580748.3636; val_kl_reg_loss: 424910.9062; val_edge_recon_loss: 1217240.5625; val_gene_expr_recon_loss: 46009904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47652056.0000; val_optim_loss: 47652056.0000
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.8982; val_auprc_score: 0.9735; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 618577.5000; train_edge_recon_loss: 1180756.6458; train_gene_expr_recon_loss: 48409434.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50208768.6667; train_optim_loss: 50208768.6667; val_kl_reg_loss: 612311.9375; val_edge_recon_loss: 1212160.2500; val_gene_expr_recon_loss: 48488392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50312864.0000; val_optim_loss: 50312864.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8689; val_auprc_score: 0.9708; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 419351.1875; train_edge_recon_loss: 1192472.9091; train_gene_expr_recon_loss: 45716963.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47328788.0000; train_optim_loss: 47328788.0000; val_kl_reg_loss: 417383.5781; val_edge_recon_loss: 1238429.5625; val_gene_expr_recon_loss: 45551896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47207708.0000; val_optim_loss: 47207708.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8686; val_auprc_score: 0.9715; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 408678.2642; train_edge_recon_loss: 1189970.7330; train_gene_expr_recon_loss: 45498574.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47097223.2727; train_optim_loss: 47097223.2727; val_kl_reg_loss: 399290.9688; val_edge_recon_loss: 1152715.5000; val_gene_expr_recon_loss: 45246248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46798254.0000; val_optim_loss: 46798254.0000
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9005; val_auprc_score: 0.9739; val_best_acc_score: 0.8488; val_best_f1_score: 0.9182; train_kl_reg_loss: 617677.7188; train_edge_recon_loss: 1195575.8750; train_gene_expr_recon_loss: 48315134.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50128388.6667; train_optim_loss: 50128388.6667; val_kl_reg_loss: 610386.6250; val_edge_recon_loss: 1229329.2500; val_gene_expr_recon_loss: 48383608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50223324.0000; val_optim_loss: 50223324.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8666; val_auprc_score: 0.9722; val_best_acc_score: 0.8590; val_best_f1_score: 0.9241; train_kl_reg_loss: 396907.2642; train_edge_recon_loss: 1150580.3409; train_gene_expr_recon_loss: 45324721.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46872209.4545; train_optim_loss: 46872209.4545; val_kl_reg_loss: 389017.4219; val_edge_recon_loss: 1249421.6875; val_gene_expr_recon_loss: 45478384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47116824.0000; val_optim_loss: 47116824.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8456; val_auprc_score: 0.9653; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 389025.4062; train_edge_recon_loss: 1167188.8864; train_gene_expr_recon_loss: 45259577.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46815790.9091; train_optim_loss: 46815790.9091; val_kl_reg_loss: 375938.1250; val_edge_recon_loss: 1187904.6250; val_gene_expr_recon_loss: 45231372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46795214.0000; val_optim_loss: 46795214.0000
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9059; val_auprc_score: 0.9749; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 616011.5000; train_edge_recon_loss: 1156040.4583; train_gene_expr_recon_loss: 48215990.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49988041.3333; train_optim_loss: 49988041.3333; val_kl_reg_loss: 609612.8125; val_edge_recon_loss: 1243978.1250; val_gene_expr_recon_loss: 48295816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50149408.0000; val_optim_loss: 50149408.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8611; val_auprc_score: 0.9659; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 2471105.7869; train_edge_recon_loss: 1126071.3068; train_gene_expr_recon_loss: 285371889.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 288969069.4545; train_optim_loss: 288969069.4545; val_kl_reg_loss: 993899.6250; val_edge_recon_loss: 1222981.0625; val_gene_expr_recon_loss: 59687866.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61904746.0000; val_optim_loss: 61904746.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8423; val_auprc_score: 0.9565; val_best_acc_score: 0.8571; val_best_f1_score: 0.9231; train_kl_reg_loss: 1991915.5341; train_edge_recon_loss: 1156389.0455; train_gene_expr_recon_loss: 228851557.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 231999858.9091; train_optim_loss: 231999858.9091; val_kl_reg_loss: 1789332.4375; val_edge_recon_loss: 1150026.6250; val_gene_expr_recon_loss: 68796680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71736040.0000; val_optim_loss: 71736040.0000
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.8975; val_auprc_score: 0.9730; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 615430.5521; train_edge_recon_loss: 1175582.3125; train_gene_expr_recon_loss: 48117482.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49908496.0000; train_optim_loss: 49908496.0000; val_kl_reg_loss: 607984.6875; val_edge_recon_loss: 1218301.6250; val_gene_expr_recon_loss: 48200104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50026392.0000; val_optim_loss: 50026392.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8193; val_auprc_score: 0.9472; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 2097083.5568; train_edge_recon_loss: 1185111.1818; train_gene_expr_recon_loss: 65302740.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68584934.5455; train_optim_loss: 68584934.5455; val_kl_reg_loss: 2310736.0000; val_edge_recon_loss: 1282923.3750; val_gene_expr_recon_loss: 60410504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64004164.0000; val_optim_loss: 64004164.0000
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9068; val_auprc_score: 0.9770; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 613998.1354; train_edge_recon_loss: 1184861.5625; train_gene_expr_recon_loss: 48027094.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49825954.0000; train_optim_loss: 49825954.0000; val_kl_reg_loss: 606035.5000; val_edge_recon_loss: 1172593.2500; val_gene_expr_recon_loss: 48102232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49880860.0000; val_optim_loss: 49880860.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8272; val_auprc_score: 0.9488; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 2372969.5227; train_edge_recon_loss: 1201023.0000; train_gene_expr_recon_loss: 58761617.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62335609.8182; train_optim_loss: 62335609.8182; val_kl_reg_loss: 2428104.6250; val_edge_recon_loss: 1154544.6875; val_gene_expr_recon_loss: 57556508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61139158.0000; val_optim_loss: 61139158.0000
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9084; val_auprc_score: 0.9770; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 611813.7604; train_edge_recon_loss: 1181639.6458; train_gene_expr_recon_loss: 47891172.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49684625.3333; train_optim_loss: 49684625.3333; val_kl_reg_loss: 604956.4375; val_edge_recon_loss: 1210930.2500; val_gene_expr_recon_loss: 48009144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49825032.0000; val_optim_loss: 49825032.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8219; val_auprc_score: 0.9450; val_best_acc_score: 0.8454; val_best_f1_score: 0.9162; train_kl_reg_loss: 2405108.8864; train_edge_recon_loss: 1210148.7955; train_gene_expr_recon_loss: 57323336.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60938594.1818; train_optim_loss: 60938594.1818; val_kl_reg_loss: 2352547.2500; val_edge_recon_loss: 1334276.3125; val_gene_expr_recon_loss: 56528540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60215364.0000; val_optim_loss: 60215364.0000
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.8997; val_auprc_score: 0.9758; val_best_acc_score: 0.8592; val_best_f1_score: 0.9243; train_kl_reg_loss: 611208.0521; train_edge_recon_loss: 1207459.5000; train_gene_expr_recon_loss: 47840521.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49659189.3333; train_optim_loss: 49659189.3333; val_kl_reg_loss: 604405.0000; val_edge_recon_loss: 1145128.1250; val_gene_expr_recon_loss: 47922248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49671780.0000; val_optim_loss: 49671780.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8384; val_auprc_score: 0.9503; val_best_acc_score: 0.8451; val_best_f1_score: 0.9160; train_kl_reg_loss: 2394767.1591; train_edge_recon_loss: 1210390.7841; train_gene_expr_recon_loss: 56829019.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60434177.0909; train_optim_loss: 60434177.0909; val_kl_reg_loss: 2388275.2500; val_edge_recon_loss: 1228586.3750; val_gene_expr_recon_loss: 56619984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60236846.0000; val_optim_loss: 60236846.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8323; val_auprc_score: 0.9536; val_best_acc_score: 0.8599; val_best_f1_score: 0.9247; train_kl_reg_loss: 2377990.1591; train_edge_recon_loss: 1196651.6705; train_gene_expr_recon_loss: 56541686.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60116328.0000; train_optim_loss: 60116328.0000; val_kl_reg_loss: 2374892.1250; val_edge_recon_loss: 1100878.6250; val_gene_expr_recon_loss: 56568468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60044240.0000; val_optim_loss: 60044240.0000
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9018; val_auprc_score: 0.9738; val_best_acc_score: 0.8445; val_best_f1_score: 0.9157; train_kl_reg_loss: 608129.4167; train_edge_recon_loss: 1180487.4375; train_gene_expr_recon_loss: 47751688.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49540306.0000; train_optim_loss: 49540306.0000; val_kl_reg_loss: 600476.4375; val_edge_recon_loss: 1264624.6250; val_gene_expr_recon_loss: 47803152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49668252.0000; val_optim_loss: 49668252.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8345; val_auprc_score: 0.9506; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 2363435.0455; train_edge_recon_loss: 1197237.2841; train_gene_expr_recon_loss: 56369899.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59930572.3636; train_optim_loss: 59930572.3636; val_kl_reg_loss: 2343274.8750; val_edge_recon_loss: 1244625.0625; val_gene_expr_recon_loss: 56340368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59928268.0000; val_optim_loss: 59928268.0000
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9021; val_auprc_score: 0.9755; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 606969.5208; train_edge_recon_loss: 1187550.1042; train_gene_expr_recon_loss: 47646926.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49441446.0000; train_optim_loss: 49441446.0000; val_kl_reg_loss: 599923.0625; val_edge_recon_loss: 1165124.0000; val_gene_expr_recon_loss: 47714024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49479072.0000; val_optim_loss: 49479072.0000
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.8992; val_auprc_score: 0.9734; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 606723.4062; train_edge_recon_loss: 1219389.9375; train_gene_expr_recon_loss: 47570426.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49396540.0000; train_optim_loss: 49396540.0000; val_kl_reg_loss: 598457.6250; val_edge_recon_loss: 1215846.0000; val_gene_expr_recon_loss: 47613320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49427624.0000; val_optim_loss: 49427624.0000
Epoch 76/400 |███-----------------| 19.0% val_auroc_score: 0.8937; val_auprc_score: 0.9732; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 604542.7917; train_edge_recon_loss: 1188745.1458; train_gene_expr_recon_loss: 47414439.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49207726.6667; train_optim_loss: 49207726.6667; val_kl_reg_loss: 596777.5000; val_edge_recon_loss: 1182527.6250; val_gene_expr_recon_loss: 47518496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49297800.0000; val_optim_loss: 49297800.0000
Epoch 77/400 |███-----------------| 19.2% val_auroc_score: 0.8940; val_auprc_score: 0.9726; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 601228.7188; train_edge_recon_loss: 1209335.0625; train_gene_expr_recon_loss: 47333256.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49143819.3333; train_optim_loss: 49143819.3333; val_kl_reg_loss: 596313.1250; val_edge_recon_loss: 1192433.1250; val_gene_expr_recon_loss: 47435928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49224676.0000; val_optim_loss: 49224676.0000
Epoch 78/400 |███-----------------| 19.5% val_auroc_score: 0.9004; val_auprc_score: 0.9753; val_best_acc_score: 0.8573; val_best_f1_score: 0.9232; train_kl_reg_loss: 600948.7812; train_edge_recon_loss: 1176096.9792; train_gene_expr_recon_loss: 47250748.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49027794.6667; train_optim_loss: 49027794.6667; val_kl_reg_loss: 593842.8750; val_edge_recon_loss: 1160135.7500; val_gene_expr_recon_loss: 47322400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49076380.0000; val_optim_loss: 49076380.0000
Epoch 79/400 |███-----------------| 19.8% val_auroc_score: 0.8995; val_auprc_score: 0.9762; val_best_acc_score: 0.8635; val_best_f1_score: 0.9268; train_kl_reg_loss: 599877.8021; train_edge_recon_loss: 1195250.1458; train_gene_expr_recon_loss: 47130861.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48925989.3333; train_optim_loss: 48925989.3333; val_kl_reg_loss: 592284.3750; val_edge_recon_loss: 1109856.6250; val_gene_expr_recon_loss: 47228768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48930908.0000; val_optim_loss: 48930908.0000
Epoch 80/400 |████----------------| 20.0% val_auroc_score: 0.8946; val_auprc_score: 0.9724; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 597996.8750; train_edge_recon_loss: 1202857.5833; train_gene_expr_recon_loss: 47082259.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48883114.0000; train_optim_loss: 48883114.0000; val_kl_reg_loss: 591742.2500; val_edge_recon_loss: 1223207.1250; val_gene_expr_recon_loss: 47142596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48957544.0000; val_optim_loss: 48957544.0000
Epoch 81/400 |████----------------| 20.2% val_auroc_score: 0.8968; val_auprc_score: 0.9738; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 595981.9271; train_edge_recon_loss: 1207338.8750; train_gene_expr_recon_loss: 46933356.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48736677.3333; train_optim_loss: 48736677.3333; val_kl_reg_loss: 588623.5625; val_edge_recon_loss: 1168860.7500; val_gene_expr_recon_loss: 47025560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48783044.0000; val_optim_loss: 48783044.0000
Epoch 82/400 |████----------------| 20.5% val_auroc_score: 0.8995; val_auprc_score: 0.9738; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 594783.5938; train_edge_recon_loss: 1195738.3333; train_gene_expr_recon_loss: 46844837.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48635360.0000; train_optim_loss: 48635360.0000; val_kl_reg_loss: 588188.7500; val_edge_recon_loss: 1223206.8750; val_gene_expr_recon_loss: 46940472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48751868.0000; val_optim_loss: 48751868.0000
