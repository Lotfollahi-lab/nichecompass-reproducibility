Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch3', 'batch4', 'batch8', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '28092023_161247_203', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 226755
Number of validation nodes: 25195
Number of training edges: 533766
Number of validation edges: 59307
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8425; val_auprc_score: 0.9173; val_best_acc_score: 0.8622; val_best_f1_score: 0.9132; train_kl_reg_loss: 26331.4092; train_edge_recon_loss: 1518553.2009; train_gene_expr_recon_loss: 4303627.5187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5848512.1376; train_optim_loss: 5848512.1376; val_kl_reg_loss: 27438.1629; val_edge_recon_loss: 1540046.5797; val_gene_expr_recon_loss: 3593684.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5161169.4224; val_optim_loss: 5161169.4224
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8451; val_auprc_score: 0.9190; val_best_acc_score: 0.8627; val_best_f1_score: 0.9135; train_kl_reg_loss: 25621.6296; train_edge_recon_loss: 1521981.6783; train_gene_expr_recon_loss: 3603835.8847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5151439.1922; train_optim_loss: 5151439.1922; val_kl_reg_loss: 26505.7698; val_edge_recon_loss: 1544489.6670; val_gene_expr_recon_loss: 3308604.7091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4879600.1379; val_optim_loss: 4879600.1379
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8417; val_auprc_score: 0.9165; val_best_acc_score: 0.8611; val_best_f1_score: 0.9123; train_kl_reg_loss: 24238.0562; train_edge_recon_loss: 1519852.4739; train_gene_expr_recon_loss: 3382020.3154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4926110.8384; train_optim_loss: 4926110.8384; val_kl_reg_loss: 25328.2715; val_edge_recon_loss: 1553724.7425; val_gene_expr_recon_loss: 3152322.9246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731375.9181; val_optim_loss: 4731375.9181
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8405; val_auprc_score: 0.9157; val_best_acc_score: 0.8605; val_best_f1_score: 0.9120; train_kl_reg_loss: 25168.5799; train_edge_recon_loss: 1517198.6571; train_gene_expr_recon_loss: 3255642.7641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798010.0081; train_optim_loss: 4798010.0081; val_kl_reg_loss: 25795.8995; val_edge_recon_loss: 1556093.7446; val_gene_expr_recon_loss: 3073684.1509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4655573.7802; val_optim_loss: 4655573.7802
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8412; val_auprc_score: 0.9154; val_best_acc_score: 0.8622; val_best_f1_score: 0.9128; train_kl_reg_loss: 25549.6855; train_edge_recon_loss: 1519468.6314; train_gene_expr_recon_loss: 3192986.4355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738004.7459; train_optim_loss: 4738004.7459; val_kl_reg_loss: 25418.9942; val_edge_recon_loss: 1551688.7651; val_gene_expr_recon_loss: 3030898.6401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4608006.3922; val_optim_loss: 4608006.3922
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8416; val_auprc_score: 0.9160; val_best_acc_score: 0.8615; val_best_f1_score: 0.9126; train_kl_reg_loss: 26653.2981; train_edge_recon_loss: 1514350.6786; train_gene_expr_recon_loss: 3151262.0532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4692266.0283; train_optim_loss: 4692266.0283; val_kl_reg_loss: 25999.9416; val_edge_recon_loss: 1553036.9817; val_gene_expr_recon_loss: 2996520.6056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4575557.5172; val_optim_loss: 4575557.5172
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8427; val_auprc_score: 0.9169; val_best_acc_score: 0.8631; val_best_f1_score: 0.9137; train_kl_reg_loss: 25281.4264; train_edge_recon_loss: 1519304.1660; train_gene_expr_recon_loss: 3122520.0561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4667105.6481; train_optim_loss: 4667105.6481; val_kl_reg_loss: 25321.1636; val_edge_recon_loss: 1541655.1832; val_gene_expr_recon_loss: 2977541.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544518.0216; val_optim_loss: 4544518.0216
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8420; val_auprc_score: 0.9162; val_best_acc_score: 0.8612; val_best_f1_score: 0.9125; train_kl_reg_loss: 27847.1831; train_edge_recon_loss: 1520136.0434; train_gene_expr_recon_loss: 3107170.2711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4655153.5005; train_optim_loss: 4655153.5005; val_kl_reg_loss: 27166.4350; val_edge_recon_loss: 1550932.2942; val_gene_expr_recon_loss: 2962310.1767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4540408.9095; val_optim_loss: 4540408.9095
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8414; val_auprc_score: 0.9160; val_best_acc_score: 0.8605; val_best_f1_score: 0.9120; train_kl_reg_loss: 25000.4096; train_edge_recon_loss: 1520425.9662; train_gene_expr_recon_loss: 3092785.5899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4638211.9588; train_optim_loss: 4638211.9588; val_kl_reg_loss: 25018.2435; val_edge_recon_loss: 1554259.4580; val_gene_expr_recon_loss: 2951596.0948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4530873.8276; val_optim_loss: 4530873.8276
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8426; val_auprc_score: 0.9161; val_best_acc_score: 0.8617; val_best_f1_score: 0.9126; train_kl_reg_loss: 26632.0857; train_edge_recon_loss: 1518268.8323; train_gene_expr_recon_loss: 3087281.6028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4632182.5216; train_optim_loss: 4632182.5216; val_kl_reg_loss: 25095.0118; val_edge_recon_loss: 1549597.2543; val_gene_expr_recon_loss: 2946263.4353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520955.7155; val_optim_loss: 4520955.7155
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8385; val_auprc_score: 0.9156; val_best_acc_score: 0.8608; val_best_f1_score: 0.9122; train_kl_reg_loss: 24664.1042; train_edge_recon_loss: 1520321.7818; train_gene_expr_recon_loss: 3076788.7332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4621774.6151; train_optim_loss: 4621774.6151; val_kl_reg_loss: 25587.0436; val_edge_recon_loss: 1549834.5625; val_gene_expr_recon_loss: 2933835.4267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509257.0302; val_optim_loss: 4509257.0302
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8449; val_auprc_score: 0.9192; val_best_acc_score: 0.8638; val_best_f1_score: 0.9143; train_kl_reg_loss: 25364.9546; train_edge_recon_loss: 1515179.8615; train_gene_expr_recon_loss: 3068023.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4608567.8806; train_optim_loss: 4608567.8806; val_kl_reg_loss: 25224.5919; val_edge_recon_loss: 1535214.5216; val_gene_expr_recon_loss: 2928748.9547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4489188.0517; val_optim_loss: 4489188.0517
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8402; val_auprc_score: 0.9153; val_best_acc_score: 0.8603; val_best_f1_score: 0.9115; train_kl_reg_loss: 25098.4499; train_edge_recon_loss: 1516828.1047; train_gene_expr_recon_loss: 3065627.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4607554.1740; train_optim_loss: 4607554.1740; val_kl_reg_loss: 26044.9879; val_edge_recon_loss: 1562941.5625; val_gene_expr_recon_loss: 2930791.8341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4519778.3922; val_optim_loss: 4519778.3922
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8430; val_auprc_score: 0.9174; val_best_acc_score: 0.8621; val_best_f1_score: 0.9130; train_kl_reg_loss: 25805.5073; train_edge_recon_loss: 1516689.6515; train_gene_expr_recon_loss: 3058024.7653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4600519.9389; train_optim_loss: 4600519.9389; val_kl_reg_loss: 24857.5953; val_edge_recon_loss: 1545784.1078; val_gene_expr_recon_loss: 2928228.6767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4498870.3664; val_optim_loss: 4498870.3664
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8411; val_auprc_score: 0.9161; val_best_acc_score: 0.8618; val_best_f1_score: 0.9129; train_kl_reg_loss: 26146.7188; train_edge_recon_loss: 1514016.4661; train_gene_expr_recon_loss: 3058117.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598280.6285; train_optim_loss: 4598280.6285; val_kl_reg_loss: 24916.3638; val_edge_recon_loss: 1546794.5151; val_gene_expr_recon_loss: 2916394.5086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4488105.4138; val_optim_loss: 4488105.4138
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8393; val_auprc_score: 0.9144; val_best_acc_score: 0.8611; val_best_f1_score: 0.9125; train_kl_reg_loss: 25088.6365; train_edge_recon_loss: 1521873.2381; train_gene_expr_recon_loss: 3053244.5956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4600206.4640; train_optim_loss: 4600206.4640; val_kl_reg_loss: 24576.6220; val_edge_recon_loss: 1549873.0248; val_gene_expr_recon_loss: 2921676.5539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4496126.1983; val_optim_loss: 4496126.1983
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8429; val_auprc_score: 0.9174; val_best_acc_score: 0.8619; val_best_f1_score: 0.9128; train_kl_reg_loss: 25600.1780; train_edge_recon_loss: 1518720.0736; train_gene_expr_recon_loss: 3048464.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4592784.8773; train_optim_loss: 4592784.8773; val_kl_reg_loss: 25071.3694; val_edge_recon_loss: 1544382.0851; val_gene_expr_recon_loss: 2917026.1703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4486479.6509; val_optim_loss: 4486479.6509
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8431; val_auprc_score: 0.9176; val_best_acc_score: 0.8614; val_best_f1_score: 0.9125; train_kl_reg_loss: 26271.9674; train_edge_recon_loss: 1518552.5659; train_gene_expr_recon_loss: 3049999.8133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4594824.3399; train_optim_loss: 4594824.3399; val_kl_reg_loss: 27191.2557; val_edge_recon_loss: 1551161.8578; val_gene_expr_recon_loss: 2912050.8599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4490403.9763; val_optim_loss: 4490403.9763
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8429; val_auprc_score: 0.9174; val_best_acc_score: 0.8613; val_best_f1_score: 0.9128; train_kl_reg_loss: 25681.5319; train_edge_recon_loss: 1518806.7164; train_gene_expr_recon_loss: 3045210.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4589698.3030; train_optim_loss: 4589698.3030; val_kl_reg_loss: 28217.2948; val_edge_recon_loss: 1543114.2662; val_gene_expr_recon_loss: 2912991.9914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4484323.5453; val_optim_loss: 4484323.5453
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8450; val_auprc_score: 0.9179; val_best_acc_score: 0.8632; val_best_f1_score: 0.9133; train_kl_reg_loss: 26248.1396; train_edge_recon_loss: 1512286.5037; train_gene_expr_recon_loss: 3045719.2548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4584253.9003; train_optim_loss: 4584253.9003; val_kl_reg_loss: 28136.1837; val_edge_recon_loss: 1546728.9203; val_gene_expr_recon_loss: 2913179.6401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4488044.7392; val_optim_loss: 4488044.7392
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8417; val_auprc_score: 0.9171; val_best_acc_score: 0.8626; val_best_f1_score: 0.9134; train_kl_reg_loss: 25805.3711; train_edge_recon_loss: 1518910.1824; train_gene_expr_recon_loss: 3042746.7440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4587462.2948; train_optim_loss: 4587462.2948; val_kl_reg_loss: 25772.4794; val_edge_recon_loss: 1542600.6810; val_gene_expr_recon_loss: 2912233.6638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4480606.8319; val_optim_loss: 4480606.8319
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8419; val_auprc_score: 0.9172; val_best_acc_score: 0.8616; val_best_f1_score: 0.9131; train_kl_reg_loss: 27995.3014; train_edge_recon_loss: 1521489.8980; train_gene_expr_recon_loss: 3040685.6196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4590170.8154; train_optim_loss: 4590170.8154; val_kl_reg_loss: 24519.3130; val_edge_recon_loss: 1540763.4860; val_gene_expr_recon_loss: 2913342.8039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4478625.6164; val_optim_loss: 4478625.6164
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8406; val_auprc_score: 0.9155; val_best_acc_score: 0.8606; val_best_f1_score: 0.9119; train_kl_reg_loss: 27083.2860; train_edge_recon_loss: 1519751.1456; train_gene_expr_recon_loss: 3040548.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4587383.1122; train_optim_loss: 4587383.1122; val_kl_reg_loss: 25189.5739; val_edge_recon_loss: 1557175.2608; val_gene_expr_recon_loss: 2907735.2004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4490100.0323; val_optim_loss: 4490100.0323
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8403; val_auprc_score: 0.9153; val_best_acc_score: 0.8612; val_best_f1_score: 0.9123; train_kl_reg_loss: 25614.5000; train_edge_recon_loss: 1520118.5780; train_gene_expr_recon_loss: 3040407.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4586140.9027; train_optim_loss: 4586140.9027; val_kl_reg_loss: 25223.1027; val_edge_recon_loss: 1553578.1929; val_gene_expr_recon_loss: 2909311.3362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4488112.6466; val_optim_loss: 4488112.6466
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8423; val_auprc_score: 0.9170; val_best_acc_score: 0.8627; val_best_f1_score: 0.9130; train_kl_reg_loss: 26533.0003; train_edge_recon_loss: 1511772.1233; train_gene_expr_recon_loss: 3038990.9092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4577296.0429; train_optim_loss: 4577296.0429; val_kl_reg_loss: 27433.1220; val_edge_recon_loss: 1549444.1864; val_gene_expr_recon_loss: 2908507.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4485384.8513; val_optim_loss: 4485384.8513
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8411; val_auprc_score: 0.9158; val_best_acc_score: 0.8613; val_best_f1_score: 0.9124; train_kl_reg_loss: 28254.4153; train_edge_recon_loss: 1509910.1083; train_gene_expr_recon_loss: 2354250.8890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3892415.4092; train_optim_loss: 3892415.4092; val_kl_reg_loss: 26659.1618; val_edge_recon_loss: 1545412.7252; val_gene_expr_recon_loss: 2318220.1810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3890292.0711; val_optim_loss: 3890292.0711
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8431; val_auprc_score: 0.9163; val_best_acc_score: 0.8619; val_best_f1_score: 0.9125; train_kl_reg_loss: 25838.7531; train_edge_recon_loss: 1507150.2037; train_gene_expr_recon_loss: 2323086.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3856075.5942; train_optim_loss: 3856075.5942; val_kl_reg_loss: 24565.2193; val_edge_recon_loss: 1551297.2522; val_gene_expr_recon_loss: 2303043.2328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3878905.6918; val_optim_loss: 3878905.6918
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8401; val_auprc_score: 0.9156; val_best_acc_score: 0.8599; val_best_f1_score: 0.9117; train_kl_reg_loss: 27699.9827; train_edge_recon_loss: 1509397.6087; train_gene_expr_recon_loss: 2309353.0372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3846450.6270; train_optim_loss: 3846450.6270; val_kl_reg_loss: 27728.7392; val_edge_recon_loss: 1552467.2694; val_gene_expr_recon_loss: 2292295.8297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3872491.8254; val_optim_loss: 3872491.8254
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8414; val_auprc_score: 0.9155; val_best_acc_score: 0.8616; val_best_f1_score: 0.9126; train_kl_reg_loss: 26807.6791; train_edge_recon_loss: 1505614.4875; train_gene_expr_recon_loss: 2302406.0544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3834828.2222; train_optim_loss: 3834828.2222; val_kl_reg_loss: 28993.1855; val_edge_recon_loss: 1548495.5991; val_gene_expr_recon_loss: 2286605.7866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3864094.5496; val_optim_loss: 3864094.5496
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8402; val_auprc_score: 0.9156; val_best_acc_score: 0.8612; val_best_f1_score: 0.9124; train_kl_reg_loss: 26694.3240; train_edge_recon_loss: 1513015.2707; train_gene_expr_recon_loss: 2296230.6826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835940.2792; train_optim_loss: 3835940.2792; val_kl_reg_loss: 24463.4513; val_edge_recon_loss: 1547274.5754; val_gene_expr_recon_loss: 2278120.4677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3849858.5000; val_optim_loss: 3849858.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8421; val_auprc_score: 0.9157; val_best_acc_score: 0.8595; val_best_f1_score: 0.9112; train_kl_reg_loss: 25183.4023; train_edge_recon_loss: 1511338.4217; train_gene_expr_recon_loss: 2291135.8754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3827657.7013; train_optim_loss: 3827657.7013; val_kl_reg_loss: 24617.9215; val_edge_recon_loss: 1562438.3944; val_gene_expr_recon_loss: 2280596.4806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867652.8082; val_optim_loss: 3867652.8082
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8396; val_auprc_score: 0.9150; val_best_acc_score: 0.8603; val_best_f1_score: 0.9118; train_kl_reg_loss: 25424.1835; train_edge_recon_loss: 1507478.8901; train_gene_expr_recon_loss: 2287669.4960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3820572.5707; train_optim_loss: 3820572.5707; val_kl_reg_loss: 24541.8413; val_edge_recon_loss: 1550464.1692; val_gene_expr_recon_loss: 2276113.0948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851119.1056; val_optim_loss: 3851119.1056
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8402; val_auprc_score: 0.9158; val_best_acc_score: 0.8611; val_best_f1_score: 0.9124; train_kl_reg_loss: 26384.6128; train_edge_recon_loss: 1506968.6836; train_gene_expr_recon_loss: 2284153.5943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3817506.8881; train_optim_loss: 3817506.8881; val_kl_reg_loss: 24364.2475; val_edge_recon_loss: 1546974.5981; val_gene_expr_recon_loss: 2271605.4591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842944.3211; val_optim_loss: 3842944.3211
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8392; val_auprc_score: 0.9140; val_best_acc_score: 0.8613; val_best_f1_score: 0.9124; train_kl_reg_loss: 26280.3961; train_edge_recon_loss: 1504516.0706; train_gene_expr_recon_loss: 2285154.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3815950.4787; train_optim_loss: 3815950.4787; val_kl_reg_loss: 25846.9915; val_edge_recon_loss: 1552779.2888; val_gene_expr_recon_loss: 2267717.6659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3846343.9591; val_optim_loss: 3846343.9591
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8399; val_auprc_score: 0.9152; val_best_acc_score: 0.8610; val_best_f1_score: 0.9124; train_kl_reg_loss: 27222.0716; train_edge_recon_loss: 1505714.6395; train_gene_expr_recon_loss: 2283935.2105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3816871.9214; train_optim_loss: 3816871.9214; val_kl_reg_loss: 24185.6219; val_edge_recon_loss: 1550001.6067; val_gene_expr_recon_loss: 2270269.3491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844456.5862; val_optim_loss: 3844456.5862
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8377; val_auprc_score: 0.9134; val_best_acc_score: 0.8590; val_best_f1_score: 0.9113; train_kl_reg_loss: 27204.4156; train_edge_recon_loss: 1509692.5031; train_gene_expr_recon_loss: 2282060.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3818957.5105; train_optim_loss: 3818957.5105; val_kl_reg_loss: 25320.0088; val_edge_recon_loss: 1557871.6681; val_gene_expr_recon_loss: 2268739.8039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851931.4871; val_optim_loss: 3851931.4871
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8399; val_auprc_score: 0.9159; val_best_acc_score: 0.8605; val_best_f1_score: 0.9120; train_kl_reg_loss: 25653.3082; train_edge_recon_loss: 1510540.3974; train_gene_expr_recon_loss: 2279585.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3815779.2354; train_optim_loss: 3815779.2354; val_kl_reg_loss: 24617.2963; val_edge_recon_loss: 1546773.5259; val_gene_expr_recon_loss: 2266791.8039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838182.6358; val_optim_loss: 3838182.6358
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8413; val_auprc_score: 0.9153; val_best_acc_score: 0.8617; val_best_f1_score: 0.9128; train_kl_reg_loss: 26318.1627; train_edge_recon_loss: 1505135.0348; train_gene_expr_recon_loss: 2278493.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3809946.7711; train_optim_loss: 3809946.7711; val_kl_reg_loss: 24006.4641; val_edge_recon_loss: 1548472.2392; val_gene_expr_recon_loss: 2266864.6509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3839343.3578; val_optim_loss: 3839343.3578
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8411; val_auprc_score: 0.9163; val_best_acc_score: 0.8608; val_best_f1_score: 0.9126; train_kl_reg_loss: 25010.9661; train_edge_recon_loss: 1504606.2438; train_gene_expr_recon_loss: 2278037.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807654.5695; train_optim_loss: 3807654.5695; val_kl_reg_loss: 28124.1378; val_edge_recon_loss: 1543054.2231; val_gene_expr_recon_loss: 2268394.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3839572.6509; val_optim_loss: 3839572.6509
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8400; val_auprc_score: 0.9159; val_best_acc_score: 0.8606; val_best_f1_score: 0.9121; train_kl_reg_loss: 27909.8888; train_edge_recon_loss: 1512969.6864; train_gene_expr_recon_loss: 2279484.6838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3820364.2565; train_optim_loss: 3820364.2565; val_kl_reg_loss: 26675.1541; val_edge_recon_loss: 1541983.0496; val_gene_expr_recon_loss: 2263437.3685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3832095.5690; val_optim_loss: 3832095.5690
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8395; val_auprc_score: 0.9145; val_best_acc_score: 0.8597; val_best_f1_score: 0.9115; train_kl_reg_loss: 25964.2293; train_edge_recon_loss: 1507578.4907; train_gene_expr_recon_loss: 2277369.3066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3810912.0302; train_optim_loss: 3810912.0302; val_kl_reg_loss: 27375.8969; val_edge_recon_loss: 1553009.2834; val_gene_expr_recon_loss: 2263849.9310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844235.1207; val_optim_loss: 3844235.1207
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8409; val_auprc_score: 0.9154; val_best_acc_score: 0.8603; val_best_f1_score: 0.9115; train_kl_reg_loss: 28183.8947; train_edge_recon_loss: 1505935.0008; train_gene_expr_recon_loss: 2277346.0472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811464.9410; train_optim_loss: 3811464.9410; val_kl_reg_loss: 28238.4989; val_edge_recon_loss: 1556514.8685; val_gene_expr_recon_loss: 2265695.0927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3850448.4526; val_optim_loss: 3850448.4526
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8424; val_auprc_score: 0.9161; val_best_acc_score: 0.8607; val_best_f1_score: 0.9116; train_kl_reg_loss: 27732.8904; train_edge_recon_loss: 1506244.5907; train_gene_expr_recon_loss: 2277530.5784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811508.0515; train_optim_loss: 3811508.0515; val_kl_reg_loss: 24779.6296; val_edge_recon_loss: 1558018.0819; val_gene_expr_recon_loss: 2266164.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3848962.1832; val_optim_loss: 3848962.1832
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8383; val_auprc_score: 0.9140; val_best_acc_score: 0.8594; val_best_f1_score: 0.9113; train_kl_reg_loss: 25586.8383; train_edge_recon_loss: 1510027.3915; train_gene_expr_recon_loss: 2276195.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811809.2694; train_optim_loss: 3811809.2694; val_kl_reg_loss: 25967.4233; val_edge_recon_loss: 1557478.4504; val_gene_expr_recon_loss: 2264295.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3847741.8125; val_optim_loss: 3847741.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8383; val_auprc_score: 0.9146; val_best_acc_score: 0.8603; val_best_f1_score: 0.9116; train_kl_reg_loss: 25640.3720; train_edge_recon_loss: 1507978.4712; train_gene_expr_recon_loss: 2275142.6556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3808761.5007; train_optim_loss: 3808761.5007; val_kl_reg_loss: 27364.4795; val_edge_recon_loss: 1553010.4558; val_gene_expr_recon_loss: 2264493.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844868.0043; val_optim_loss: 3844868.0043
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8390; val_auprc_score: 0.9153; val_best_acc_score: 0.8598; val_best_f1_score: 0.9118; train_kl_reg_loss: 25867.5426; train_edge_recon_loss: 1507574.9098; train_gene_expr_recon_loss: 2274463.7127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807906.1625; train_optim_loss: 3807906.1625; val_kl_reg_loss: 25095.1606; val_edge_recon_loss: 1551702.9300; val_gene_expr_recon_loss: 2265933.3190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3842731.4246; val_optim_loss: 3842731.4246
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8381; val_auprc_score: 0.9139; val_best_acc_score: 0.8598; val_best_f1_score: 0.9115; train_kl_reg_loss: 25195.0102; train_edge_recon_loss: 1504813.9860; train_gene_expr_recon_loss: 2275751.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3805760.3907; train_optim_loss: 3805760.3907; val_kl_reg_loss: 28494.2356; val_edge_recon_loss: 1556338.7812; val_gene_expr_recon_loss: 2261240.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3846073.8685; val_optim_loss: 3846073.8685
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8406; val_auprc_score: 0.9163; val_best_acc_score: 0.8605; val_best_f1_score: 0.9123; train_kl_reg_loss: 27451.2106; train_edge_recon_loss: 1512962.4825; train_gene_expr_recon_loss: 2275774.2971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3816187.9899; train_optim_loss: 3816187.9899; val_kl_reg_loss: 30057.3539; val_edge_recon_loss: 1541371.5119; val_gene_expr_recon_loss: 2265122.4418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3836551.3168; val_optim_loss: 3836551.3168

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 188 min 7 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.8375
val AUPRC score: 0.9140
val best accuracy score: 0.8615
val best F1 score: 0.9125
val target rna MSE score: 1.9782
val source rna MSE score: 0.7077
Val cat covariate0 mean sim diff: -0.0698
Val cat covariate1 mean sim diff: -0.0904
Val cat covariate2 mean sim diff: -0.0698

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
