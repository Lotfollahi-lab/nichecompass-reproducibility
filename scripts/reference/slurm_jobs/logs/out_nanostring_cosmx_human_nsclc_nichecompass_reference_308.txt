[True, False, True]
Run timestamp: 30092023_022140_308.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--timestamp_suffix', '_308', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', 'batch7', 'batch8', '--cat_covariates_embeds_nums', '3', '30', '5', '--contrastive_logits_pos_ratio', '0.03125', '--lambda_l1_addon', '0', '--lambda_l1_masked', '0', '--active_gp_thresh_ratio', '0.03', '--lambda_cat_covariates_contrastive', '1000000.0', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--n_sampled_neighbors', '4', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_hidden_encoder', '960', '--n_addon_gp', '100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 474107
Number of validation nodes: 52678
Number of training edges: 1120696
Number of validation edges: 124521
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8857; val_auprc_score: 0.9752; val_best_acc_score: 0.9004; val_best_f1_score: 0.9437; train_kl_reg_loss: 14678.2206; train_edge_recon_loss: 833030.6203; train_cat_covariates_contrastive_loss: 950474.6204; train_gene_expr_recon_loss: 2769829.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4568013.2669; train_optim_loss: 4568013.2669; val_kl_reg_loss: 17109.6609; val_edge_recon_loss: 833693.7357; val_cat_covariates_contrastive_loss: 950078.0917; val_gene_expr_recon_loss: 2474814.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275696.4395; val_optim_loss: 4275696.4395
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8917; val_auprc_score: 0.9749; val_best_acc_score: 0.9051; val_best_f1_score: 0.9459; train_kl_reg_loss: 19540.9387; train_edge_recon_loss: 803873.9421; train_cat_covariates_contrastive_loss: 950680.1088; train_gene_expr_recon_loss: 2314738.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4088833.3518; train_optim_loss: 4088833.3518; val_kl_reg_loss: 22301.1844; val_edge_recon_loss: 830720.1975; val_cat_covariates_contrastive_loss: 947919.8256; val_gene_expr_recon_loss: 2211949.6855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4012890.8945; val_optim_loss: 4012890.8945
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9059; val_auprc_score: 0.9785; val_best_acc_score: 0.9147; val_best_f1_score: 0.9514; train_kl_reg_loss: 21569.0319; train_edge_recon_loss: 798028.5040; train_cat_covariates_contrastive_loss: 950661.3632; train_gene_expr_recon_loss: 2158973.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3929232.2621; train_optim_loss: 3929232.2621; val_kl_reg_loss: 22870.9622; val_edge_recon_loss: 831346.2884; val_cat_covariates_contrastive_loss: 948684.6519; val_gene_expr_recon_loss: 2127595.8186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3930497.7213; val_optim_loss: 3930497.7213
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9087; val_auprc_score: 0.9792; val_best_acc_score: 0.9155; val_best_f1_score: 0.9519; train_kl_reg_loss: 22185.5396; train_edge_recon_loss: 798062.5177; train_cat_covariates_contrastive_loss: 950544.8141; train_gene_expr_recon_loss: 2101644.0950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3872436.9641; train_optim_loss: 3872436.9641; val_kl_reg_loss: 22977.3949; val_edge_recon_loss: 827606.0766; val_cat_covariates_contrastive_loss: 949279.7059; val_gene_expr_recon_loss: 2090118.4175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3889981.5881; val_optim_loss: 3889981.5881
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9093; val_auprc_score: 0.9790; val_best_acc_score: 0.9173; val_best_f1_score: 0.9528; train_kl_reg_loss: 22633.6274; train_edge_recon_loss: 794690.4565; train_cat_covariates_contrastive_loss: 950533.6381; train_gene_expr_recon_loss: 2073960.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3841817.9397; train_optim_loss: 3841817.9397; val_kl_reg_loss: 24416.8563; val_edge_recon_loss: 820973.0038; val_cat_covariates_contrastive_loss: 947881.2316; val_gene_expr_recon_loss: 2068772.7341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3862043.8279; val_optim_loss: 3862043.8279
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8937; val_auprc_score: 0.9748; val_best_acc_score: 0.9121; val_best_f1_score: 0.9500; train_kl_reg_loss: 22801.4616; train_edge_recon_loss: 795759.9872; train_cat_covariates_contrastive_loss: 950482.4940; train_gene_expr_recon_loss: 2055302.4943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3824346.4397; train_optim_loss: 3824346.4397; val_kl_reg_loss: 26872.4905; val_edge_recon_loss: 831379.3412; val_cat_covariates_contrastive_loss: 946266.0233; val_gene_expr_recon_loss: 2057303.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3861821.4590; val_optim_loss: 3861821.4590
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9187; val_auprc_score: 0.9809; val_best_acc_score: 0.9227; val_best_f1_score: 0.9557; train_kl_reg_loss: 23118.4717; train_edge_recon_loss: 791211.1801; train_cat_covariates_contrastive_loss: 950439.4673; train_gene_expr_recon_loss: 2042939.2116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807708.3323; train_optim_loss: 3807708.3323; val_kl_reg_loss: 23751.2978; val_edge_recon_loss: 827354.5768; val_cat_covariates_contrastive_loss: 948822.8911; val_gene_expr_recon_loss: 2038635.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838564.3176; val_optim_loss: 3838564.3176
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9270; val_auprc_score: 0.9838; val_best_acc_score: 0.9238; val_best_f1_score: 0.9565; train_kl_reg_loss: 23242.1533; train_edge_recon_loss: 791148.4620; train_cat_covariates_contrastive_loss: 950613.0662; train_gene_expr_recon_loss: 2032210.6972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3797214.3792; train_optim_loss: 3797214.3792; val_kl_reg_loss: 22628.6179; val_edge_recon_loss: 812719.4667; val_cat_covariates_contrastive_loss: 952369.8573; val_gene_expr_recon_loss: 2034935.1906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3822653.1352; val_optim_loss: 3822653.1352
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9279; val_auprc_score: 0.9840; val_best_acc_score: 0.9240; val_best_f1_score: 0.9566; train_kl_reg_loss: 23432.4217; train_edge_recon_loss: 790183.9809; train_cat_covariates_contrastive_loss: 950520.0543; train_gene_expr_recon_loss: 2022637.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3786774.1458; train_optim_loss: 3786774.1458; val_kl_reg_loss: 21934.0247; val_edge_recon_loss: 821945.2636; val_cat_covariates_contrastive_loss: 956276.4378; val_gene_expr_recon_loss: 2023202.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3823358.0605; val_optim_loss: 3823358.0605
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9211; val_auprc_score: 0.9825; val_best_acc_score: 0.9181; val_best_f1_score: 0.9532; train_kl_reg_loss: 23452.8763; train_edge_recon_loss: 790825.6846; train_cat_covariates_contrastive_loss: 950680.4652; train_gene_expr_recon_loss: 2013101.1549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3778060.1808; train_optim_loss: 3778060.1808; val_kl_reg_loss: 23091.0800; val_edge_recon_loss: 818050.3640; val_cat_covariates_contrastive_loss: 951951.2505; val_gene_expr_recon_loss: 2013317.5369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3806410.2275; val_optim_loss: 3806410.2275
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9212; val_auprc_score: 0.9820; val_best_acc_score: 0.9245; val_best_f1_score: 0.9569; train_kl_reg_loss: 23563.9325; train_edge_recon_loss: 789084.2353; train_cat_covariates_contrastive_loss: 950608.7206; train_gene_expr_recon_loss: 2005984.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3769240.9418; train_optim_loss: 3769240.9418; val_kl_reg_loss: 23569.9703; val_edge_recon_loss: 815120.0018; val_cat_covariates_contrastive_loss: 950317.6301; val_gene_expr_recon_loss: 2005994.6040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3795002.2152; val_optim_loss: 3795002.2152
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9215; val_auprc_score: 0.9818; val_best_acc_score: 0.9235; val_best_f1_score: 0.9561; train_kl_reg_loss: 23794.1008; train_edge_recon_loss: 793058.5505; train_cat_covariates_contrastive_loss: 950537.3332; train_gene_expr_recon_loss: 1997304.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3764694.4645; train_optim_loss: 3764694.4645; val_kl_reg_loss: 23700.5563; val_edge_recon_loss: 823438.6089; val_cat_covariates_contrastive_loss: 950097.2628; val_gene_expr_recon_loss: 2000641.1301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3797877.5635; val_optim_loss: 3797877.5635
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9218; val_auprc_score: 0.9818; val_best_acc_score: 0.9259; val_best_f1_score: 0.9576; train_kl_reg_loss: 23910.5094; train_edge_recon_loss: 788151.3273; train_cat_covariates_contrastive_loss: 950637.0483; train_gene_expr_recon_loss: 1991997.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3754696.1840; train_optim_loss: 3754696.1840; val_kl_reg_loss: 24309.1998; val_edge_recon_loss: 818757.6988; val_cat_covariates_contrastive_loss: 949245.5118; val_gene_expr_recon_loss: 1997319.3427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3789631.7510; val_optim_loss: 3789631.7510
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9247; val_auprc_score: 0.9827; val_best_acc_score: 0.9283; val_best_f1_score: 0.9591; train_kl_reg_loss: 23991.4773; train_edge_recon_loss: 789599.3785; train_cat_covariates_contrastive_loss: 950640.4087; train_gene_expr_recon_loss: 1987059.3401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3751290.6036; train_optim_loss: 3751290.6036; val_kl_reg_loss: 24050.6761; val_edge_recon_loss: 813815.1199; val_cat_covariates_contrastive_loss: 950025.1603; val_gene_expr_recon_loss: 1989821.4488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3777712.4047; val_optim_loss: 3777712.4047
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9286; val_auprc_score: 0.9841; val_best_acc_score: 0.9265; val_best_f1_score: 0.9579; train_kl_reg_loss: 24051.6221; train_edge_recon_loss: 789347.4609; train_cat_covariates_contrastive_loss: 950695.5620; train_gene_expr_recon_loss: 1981806.8009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3745901.4450; train_optim_loss: 3745901.4450; val_kl_reg_loss: 23664.7658; val_edge_recon_loss: 813325.1972; val_cat_covariates_contrastive_loss: 952016.9229; val_gene_expr_recon_loss: 1985287.5635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3774294.4426; val_optim_loss: 3774294.4426
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9150; val_auprc_score: 0.9810; val_best_acc_score: 0.9184; val_best_f1_score: 0.9533; train_kl_reg_loss: 22842.9085; train_edge_recon_loss: 790205.8319; train_cat_covariates_contrastive_loss: 950687.6399; train_gene_expr_recon_loss: 2156456.5998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3920192.9825; train_optim_loss: 3920192.9825; val_kl_reg_loss: 18469.0869; val_edge_recon_loss: 821994.8668; val_cat_covariates_contrastive_loss: 947687.5930; val_gene_expr_recon_loss: 2555053.1014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4343204.6588; val_optim_loss: 4343204.6588
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9185; val_auprc_score: 0.9806; val_best_acc_score: 0.9242; val_best_f1_score: 0.9565; train_kl_reg_loss: 22434.6521; train_edge_recon_loss: 787804.0101; train_cat_covariates_contrastive_loss: 950147.5408; train_gene_expr_recon_loss: 2298969.4315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4059355.6361; train_optim_loss: 4059355.6361; val_kl_reg_loss: 24968.8548; val_edge_recon_loss: 820864.7720; val_cat_covariates_contrastive_loss: 948749.3494; val_gene_expr_recon_loss: 2157683.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3952266.4170; val_optim_loss: 3952266.4170
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9214; val_auprc_score: 0.9819; val_best_acc_score: 0.9219; val_best_f1_score: 0.9553; train_kl_reg_loss: 24145.2807; train_edge_recon_loss: 790917.8265; train_cat_covariates_contrastive_loss: 951110.7120; train_gene_expr_recon_loss: 2100427.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3866601.1003; train_optim_loss: 3866601.1003; val_kl_reg_loss: 24836.7141; val_edge_recon_loss: 816096.6773; val_cat_covariates_contrastive_loss: 950222.5948; val_gene_expr_recon_loss: 2068353.2531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3859509.2428; val_optim_loss: 3859509.2428
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9202; val_auprc_score: 0.9813; val_best_acc_score: 0.9212; val_best_f1_score: 0.9548; train_kl_reg_loss: 24277.6439; train_edge_recon_loss: 790143.4819; train_cat_covariates_contrastive_loss: 951147.2876; train_gene_expr_recon_loss: 2033542.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3799110.9426; train_optim_loss: 3799110.9426; val_kl_reg_loss: 24804.8268; val_edge_recon_loss: 821095.6317; val_cat_covariates_contrastive_loss: 950311.7246; val_gene_expr_recon_loss: 2017936.1122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3814148.2879; val_optim_loss: 3814148.2879

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9288; val_auprc_score: 0.9836; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 24254.8774; train_edge_recon_loss: 788800.4922; train_cat_covariates_contrastive_loss: 950929.8653; train_gene_expr_recon_loss: 1984408.7108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3748393.9427; train_optim_loss: 3748393.9427; val_kl_reg_loss: 23938.8622; val_edge_recon_loss: 818065.7620; val_cat_covariates_contrastive_loss: 952949.8202; val_gene_expr_recon_loss: 1986923.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3781877.9088; val_optim_loss: 3781877.9088
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9280; val_auprc_score: 0.9838; val_best_acc_score: 0.9267; val_best_f1_score: 0.9580; train_kl_reg_loss: 24330.5811; train_edge_recon_loss: 785762.0570; train_cat_covariates_contrastive_loss: 950836.3360; train_gene_expr_recon_loss: 1974486.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3735415.4780; train_optim_loss: 3735415.4780; val_kl_reg_loss: 24394.1545; val_edge_recon_loss: 803525.3983; val_cat_covariates_contrastive_loss: 950320.5305; val_gene_expr_recon_loss: 1978806.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3757046.7295; val_optim_loss: 3757046.7295
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9259; val_auprc_score: 0.9829; val_best_acc_score: 0.9269; val_best_f1_score: 0.9581; train_kl_reg_loss: 24017.1044; train_edge_recon_loss: 786393.0500; train_cat_covariates_contrastive_loss: 950794.4448; train_gene_expr_recon_loss: 1966474.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3727678.8267; train_optim_loss: 3727678.8267; val_kl_reg_loss: 24520.5567; val_edge_recon_loss: 809328.4234; val_cat_covariates_contrastive_loss: 949736.4086; val_gene_expr_recon_loss: 1972047.3376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3755632.7275; val_optim_loss: 3755632.7275
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9285; val_auprc_score: 0.9835; val_best_acc_score: 0.9261; val_best_f1_score: 0.9575; train_kl_reg_loss: 24037.8330; train_edge_recon_loss: 786571.3224; train_cat_covariates_contrastive_loss: 950838.3817; train_gene_expr_recon_loss: 1959101.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3720548.6308; train_optim_loss: 3720548.6308; val_kl_reg_loss: 23682.7977; val_edge_recon_loss: 816453.5359; val_cat_covariates_contrastive_loss: 951694.4196; val_gene_expr_recon_loss: 1962735.3781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754566.1322; val_optim_loss: 3754566.1322
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9271; val_auprc_score: 0.9830; val_best_acc_score: 0.9258; val_best_f1_score: 0.9573; train_kl_reg_loss: 23997.4781; train_edge_recon_loss: 789066.3870; train_cat_covariates_contrastive_loss: 950571.3579; train_gene_expr_recon_loss: 1953397.5041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3717032.7288; train_optim_loss: 3717032.7288; val_kl_reg_loss: 24136.0476; val_edge_recon_loss: 823925.2398; val_cat_covariates_contrastive_loss: 950526.2959; val_gene_expr_recon_loss: 1956354.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754942.0195; val_optim_loss: 3754942.0195
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9301; val_auprc_score: 0.9842; val_best_acc_score: 0.9273; val_best_f1_score: 0.9583; train_kl_reg_loss: 23824.2786; train_edge_recon_loss: 787878.0431; train_cat_covariates_contrastive_loss: 950542.7901; train_gene_expr_recon_loss: 1948377.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3710622.8247; train_optim_loss: 3710622.8247; val_kl_reg_loss: 23821.5025; val_edge_recon_loss: 805314.0674; val_cat_covariates_contrastive_loss: 950594.2047; val_gene_expr_recon_loss: 1953979.5666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3733709.3309; val_optim_loss: 3733709.3309
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9236; val_auprc_score: 0.9824; val_best_acc_score: 0.9243; val_best_f1_score: 0.9565; train_kl_reg_loss: 23814.7913; train_edge_recon_loss: 794108.5285; train_cat_covariates_contrastive_loss: 954967.7826; train_gene_expr_recon_loss: 1750102.6220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3522993.7228; train_optim_loss: 3522993.7228; val_kl_reg_loss: 10564.5051; val_edge_recon_loss: 818858.0510; val_cat_covariates_contrastive_loss: 953478.1757; val_gene_expr_recon_loss: 1728178.5681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3511079.2971; val_optim_loss: 3511079.2971
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9217; val_auprc_score: 0.9819; val_best_acc_score: 0.9245; val_best_f1_score: 0.9569; train_kl_reg_loss: 19431.3765; train_edge_recon_loss: 792325.6283; train_cat_covariates_contrastive_loss: 950948.4699; train_gene_expr_recon_loss: 1710942.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3473648.0204; train_optim_loss: 3473648.0204; val_kl_reg_loss: 12115.8834; val_edge_recon_loss: 811438.3827; val_cat_covariates_contrastive_loss: 949945.3271; val_gene_expr_recon_loss: 1701851.4088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3475350.9990; val_optim_loss: 3475350.9990
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9214; val_auprc_score: 0.9820; val_best_acc_score: 0.9233; val_best_f1_score: 0.9562; train_kl_reg_loss: 17859.1006; train_edge_recon_loss: 792020.4438; train_cat_covariates_contrastive_loss: 949598.9565; train_gene_expr_recon_loss: 1684105.0648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3443583.5624; train_optim_loss: 3443583.5624; val_kl_reg_loss: 12802.3790; val_edge_recon_loss: 812117.1002; val_cat_covariates_contrastive_loss: 949269.8627; val_gene_expr_recon_loss: 1678799.6240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3452988.9723; val_optim_loss: 3452988.9723
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9231; val_auprc_score: 0.9821; val_best_acc_score: 0.9254; val_best_f1_score: 0.9573; train_kl_reg_loss: 16744.0973; train_edge_recon_loss: 789592.7996; train_cat_covariates_contrastive_loss: 949097.3865; train_gene_expr_recon_loss: 1663493.5098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3418927.7925; train_optim_loss: 3418927.7925; val_kl_reg_loss: 13321.0673; val_edge_recon_loss: 813758.6368; val_cat_covariates_contrastive_loss: 949027.7723; val_gene_expr_recon_loss: 1663136.9657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3439244.4385; val_optim_loss: 3439244.4385
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9232; val_auprc_score: 0.9822; val_best_acc_score: 0.9242; val_best_f1_score: 0.9566; train_kl_reg_loss: 16058.1913; train_edge_recon_loss: 789993.8327; train_cat_covariates_contrastive_loss: 948849.4042; train_gene_expr_recon_loss: 1654025.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3408927.1213; train_optim_loss: 3408927.1213; val_kl_reg_loss: 13693.2538; val_edge_recon_loss: 811502.6586; val_cat_covariates_contrastive_loss: 948677.5377; val_gene_expr_recon_loss: 1655146.8207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429020.2705; val_optim_loss: 3429020.2705
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9249; val_auprc_score: 0.9824; val_best_acc_score: 0.9253; val_best_f1_score: 0.9573; train_kl_reg_loss: 15803.6677; train_edge_recon_loss: 788733.5395; train_cat_covariates_contrastive_loss: 948844.9515; train_gene_expr_recon_loss: 1647387.3863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3400769.5441; train_optim_loss: 3400769.5441; val_kl_reg_loss: 13282.1333; val_edge_recon_loss: 816415.8589; val_cat_covariates_contrastive_loss: 949830.8279; val_gene_expr_recon_loss: 1650480.4068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3430009.2285; val_optim_loss: 3430009.2285
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9263; val_auprc_score: 0.9833; val_best_acc_score: 0.9244; val_best_f1_score: 0.9568; train_kl_reg_loss: 16006.4881; train_edge_recon_loss: 790308.6516; train_cat_covariates_contrastive_loss: 949217.6952; train_gene_expr_recon_loss: 1641749.7635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3397282.5966; train_optim_loss: 3397282.5966; val_kl_reg_loss: 13362.8749; val_edge_recon_loss: 812055.0154; val_cat_covariates_contrastive_loss: 949696.5466; val_gene_expr_recon_loss: 1644861.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3419975.5256; val_optim_loss: 3419975.5256
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9247; val_auprc_score: 0.9826; val_best_acc_score: 0.9258; val_best_f1_score: 0.9576; train_kl_reg_loss: 15806.9193; train_edge_recon_loss: 787444.7658; train_cat_covariates_contrastive_loss: 948912.8003; train_gene_expr_recon_loss: 1636311.2783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3388475.7594; train_optim_loss: 3388475.7594; val_kl_reg_loss: 13711.0398; val_edge_recon_loss: 804241.6470; val_cat_covariates_contrastive_loss: 948608.1350; val_gene_expr_recon_loss: 1638328.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3404888.8791; val_optim_loss: 3404888.8791
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9260; val_auprc_score: 0.9829; val_best_acc_score: 0.9253; val_best_f1_score: 0.9572; train_kl_reg_loss: 15633.6428; train_edge_recon_loss: 786399.1148; train_cat_covariates_contrastive_loss: 948644.6498; train_gene_expr_recon_loss: 1632375.7586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3383053.1695; train_optim_loss: 3383053.1695; val_kl_reg_loss: 14117.4907; val_edge_recon_loss: 811583.0625; val_cat_covariates_contrastive_loss: 948787.3504; val_gene_expr_recon_loss: 1634292.1122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3408780.0113; val_optim_loss: 3408780.0113
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9273; val_auprc_score: 0.9831; val_best_acc_score: 0.9253; val_best_f1_score: 0.9572; train_kl_reg_loss: 15466.3202; train_edge_recon_loss: 788806.2634; train_cat_covariates_contrastive_loss: 948472.8657; train_gene_expr_recon_loss: 1629818.5436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382563.9922; train_optim_loss: 3382563.9922; val_kl_reg_loss: 14082.6998; val_edge_recon_loss: 813640.4257; val_cat_covariates_contrastive_loss: 948909.5832; val_gene_expr_recon_loss: 1633211.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3409844.1342; val_optim_loss: 3409844.1342
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9246; val_auprc_score: 0.9824; val_best_acc_score: 0.9255; val_best_f1_score: 0.9573; train_kl_reg_loss: 15426.1451; train_edge_recon_loss: 787888.9162; train_cat_covariates_contrastive_loss: 948478.2736; train_gene_expr_recon_loss: 1625425.7205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3377219.0550; train_optim_loss: 3377219.0550; val_kl_reg_loss: 14621.9914; val_edge_recon_loss: 815689.6831; val_cat_covariates_contrastive_loss: 947756.1309; val_gene_expr_recon_loss: 1630889.1655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3408956.9754; val_optim_loss: 3408956.9754
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9290; val_auprc_score: 0.9838; val_best_acc_score: 0.9253; val_best_f1_score: 0.9571; train_kl_reg_loss: 15379.2657; train_edge_recon_loss: 788727.6354; train_cat_covariates_contrastive_loss: 948437.4163; train_gene_expr_recon_loss: 1617112.1355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3369656.4537; train_optim_loss: 3369656.4537; val_kl_reg_loss: 14254.6271; val_edge_recon_loss: 816662.0415; val_cat_covariates_contrastive_loss: 949212.9157; val_gene_expr_recon_loss: 1618380.5036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3398510.0871; val_optim_loss: 3398510.0871
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9260; val_auprc_score: 0.9829; val_best_acc_score: 0.9258; val_best_f1_score: 0.9575; train_kl_reg_loss: 15318.1839; train_edge_recon_loss: 786355.6185; train_cat_covariates_contrastive_loss: 948491.9783; train_gene_expr_recon_loss: 1613271.4986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3363437.2800; train_optim_loss: 3363437.2800; val_kl_reg_loss: 14626.2893; val_edge_recon_loss: 809351.8438; val_cat_covariates_contrastive_loss: 947978.3315; val_gene_expr_recon_loss: 1615427.8991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387384.3545; val_optim_loss: 3387384.3545
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9288; val_auprc_score: 0.9838; val_best_acc_score: 0.9258; val_best_f1_score: 0.9576; train_kl_reg_loss: 15319.1287; train_edge_recon_loss: 788475.4365; train_cat_covariates_contrastive_loss: 948351.4215; train_gene_expr_recon_loss: 1610195.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3362341.3775; train_optim_loss: 3362341.3775; val_kl_reg_loss: 14579.3191; val_edge_recon_loss: 802776.8963; val_cat_covariates_contrastive_loss: 948743.5715; val_gene_expr_recon_loss: 1615316.2182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381416.0143; val_optim_loss: 3381416.0143
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9244; val_auprc_score: 0.9821; val_best_acc_score: 0.9267; val_best_f1_score: 0.9580; train_kl_reg_loss: 15309.2071; train_edge_recon_loss: 787359.8073; train_cat_covariates_contrastive_loss: 948360.4753; train_gene_expr_recon_loss: 1608970.7342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360000.2221; train_optim_loss: 3360000.2221; val_kl_reg_loss: 15042.8454; val_edge_recon_loss: 815041.8304; val_cat_covariates_contrastive_loss: 947199.6560; val_gene_expr_recon_loss: 1612897.6906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390182.0266; val_optim_loss: 3390182.0266
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9283; val_auprc_score: 0.9833; val_best_acc_score: 0.9258; val_best_f1_score: 0.9573; train_kl_reg_loss: 15271.3806; train_edge_recon_loss: 787211.1108; train_cat_covariates_contrastive_loss: 948123.8605; train_gene_expr_recon_loss: 1608473.9178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359080.2699; train_optim_loss: 3359080.2699; val_kl_reg_loss: 14714.1695; val_edge_recon_loss: 817525.3986; val_cat_covariates_contrastive_loss: 948301.0461; val_gene_expr_recon_loss: 1613068.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3393609.6107; val_optim_loss: 3393609.6107
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9270; val_auprc_score: 0.9832; val_best_acc_score: 0.9255; val_best_f1_score: 0.9574; train_kl_reg_loss: 15284.7286; train_edge_recon_loss: 783502.7567; train_cat_covariates_contrastive_loss: 948168.5135; train_gene_expr_recon_loss: 1606379.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3353335.9796; train_optim_loss: 3353335.9796; val_kl_reg_loss: 14526.4190; val_edge_recon_loss: 812918.2923; val_cat_covariates_contrastive_loss: 948856.9098; val_gene_expr_recon_loss: 1610636.4775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3386938.1096; val_optim_loss: 3386938.1096
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9244; val_auprc_score: 0.9822; val_best_acc_score: 0.9246; val_best_f1_score: 0.9567; train_kl_reg_loss: 15231.7455; train_edge_recon_loss: 787089.8726; train_cat_covariates_contrastive_loss: 948076.0878; train_gene_expr_recon_loss: 1602557.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3352955.3932; train_optim_loss: 3352955.3932; val_kl_reg_loss: 14909.3281; val_edge_recon_loss: 814435.5953; val_cat_covariates_contrastive_loss: 947500.9311; val_gene_expr_recon_loss: 1606612.7408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3383458.5943; val_optim_loss: 3383458.5943

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9252; val_auprc_score: 0.9825; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 15191.1396; train_edge_recon_loss: 784621.9502; train_cat_covariates_contrastive_loss: 947964.0547; train_gene_expr_recon_loss: 1598906.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346683.8224; train_optim_loss: 3346683.8224; val_kl_reg_loss: 14714.7432; val_edge_recon_loss: 807441.7690; val_cat_covariates_contrastive_loss: 947654.7853; val_gene_expr_recon_loss: 1605587.0231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375398.3248; val_optim_loss: 3375398.3248
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9268; val_auprc_score: 0.9832; val_best_acc_score: 0.9264; val_best_f1_score: 0.9578; train_kl_reg_loss: 15224.5738; train_edge_recon_loss: 786695.0740; train_cat_covariates_contrastive_loss: 948101.3231; train_gene_expr_recon_loss: 1598818.4361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348839.4049; train_optim_loss: 3348839.4049; val_kl_reg_loss: 14768.6053; val_edge_recon_loss: 814249.6939; val_cat_covariates_contrastive_loss: 948432.6291; val_gene_expr_recon_loss: 1606128.5102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3383579.4467; val_optim_loss: 3383579.4467
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9266; val_auprc_score: 0.9827; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 15273.9245; train_edge_recon_loss: 784306.9663; train_cat_covariates_contrastive_loss: 947998.6140; train_gene_expr_recon_loss: 1597933.5754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345513.0823; train_optim_loss: 3345513.0823; val_kl_reg_loss: 14872.7699; val_edge_recon_loss: 819684.7326; val_cat_covariates_contrastive_loss: 947513.5704; val_gene_expr_recon_loss: 1603310.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385382.0051; val_optim_loss: 3385382.0051
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9248; val_auprc_score: 0.9825; val_best_acc_score: 0.9257; val_best_f1_score: 0.9574; train_kl_reg_loss: 15260.7227; train_edge_recon_loss: 785003.0242; train_cat_covariates_contrastive_loss: 947989.6106; train_gene_expr_recon_loss: 1598236.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346489.6882; train_optim_loss: 3346489.6882; val_kl_reg_loss: 14696.8492; val_edge_recon_loss: 817721.1025; val_cat_covariates_contrastive_loss: 948326.5963; val_gene_expr_recon_loss: 1604610.7059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385355.2459; val_optim_loss: 3385355.2459
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9248; val_auprc_score: 0.9824; val_best_acc_score: 0.9256; val_best_f1_score: 0.9573; train_kl_reg_loss: 15233.2672; train_edge_recon_loss: 786259.6209; train_cat_covariates_contrastive_loss: 947980.7500; train_gene_expr_recon_loss: 1597638.8996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3347112.5401; train_optim_loss: 3347112.5401; val_kl_reg_loss: 14920.9208; val_edge_recon_loss: 814355.3130; val_cat_covariates_contrastive_loss: 947681.8140; val_gene_expr_recon_loss: 1604657.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381615.8883; val_optim_loss: 3381615.8883

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9273; val_auprc_score: 0.9832; val_best_acc_score: 0.9266; val_best_f1_score: 0.9579; train_kl_reg_loss: 15273.7027; train_edge_recon_loss: 784013.6122; train_cat_covariates_contrastive_loss: 947755.4706; train_gene_expr_recon_loss: 1597480.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344523.6374; train_optim_loss: 3344523.6374; val_kl_reg_loss: 14751.9961; val_edge_recon_loss: 811513.6936; val_cat_covariates_contrastive_loss: 948422.8478; val_gene_expr_recon_loss: 1604572.4242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379260.9570; val_optim_loss: 3379260.9570
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9293; val_auprc_score: 0.9838; val_best_acc_score: 0.9262; val_best_f1_score: 0.9578; train_kl_reg_loss: 15247.8275; train_edge_recon_loss: 785609.4164; train_cat_covariates_contrastive_loss: 947965.5436; train_gene_expr_recon_loss: 1597321.4939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346144.2827; train_optim_loss: 3346144.2827; val_kl_reg_loss: 14759.3097; val_edge_recon_loss: 809422.4091; val_cat_covariates_contrastive_loss: 948254.3066; val_gene_expr_recon_loss: 1605307.3284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377743.3566; val_optim_loss: 3377743.3566
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9272; val_auprc_score: 0.9829; val_best_acc_score: 0.9259; val_best_f1_score: 0.9575; train_kl_reg_loss: 15229.2903; train_edge_recon_loss: 786038.5394; train_cat_covariates_contrastive_loss: 947975.8846; train_gene_expr_recon_loss: 1597593.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346837.2155; train_optim_loss: 3346837.2155; val_kl_reg_loss: 14764.4818; val_edge_recon_loss: 817476.5797; val_cat_covariates_contrastive_loss: 947801.1716; val_gene_expr_recon_loss: 1604802.0702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384844.3145; val_optim_loss: 3384844.3145
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9268; val_auprc_score: 0.9832; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 15249.1561; train_edge_recon_loss: 785494.7276; train_cat_covariates_contrastive_loss: 947927.0792; train_gene_expr_recon_loss: 1597367.5002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346038.4617; train_optim_loss: 3346038.4617; val_kl_reg_loss: 14765.4487; val_edge_recon_loss: 808381.7846; val_cat_covariates_contrastive_loss: 947745.8327; val_gene_expr_recon_loss: 1603203.2444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374096.3125; val_optim_loss: 3374096.3125
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9296; val_auprc_score: 0.9840; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 15232.8573; train_edge_recon_loss: 786205.0790; train_cat_covariates_contrastive_loss: 947940.1315; train_gene_expr_recon_loss: 1597610.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346988.2517; train_optim_loss: 3346988.2517; val_kl_reg_loss: 14748.5415; val_edge_recon_loss: 817535.9859; val_cat_covariates_contrastive_loss: 948407.8245; val_gene_expr_recon_loss: 1604244.5753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384936.9262; val_optim_loss: 3384936.9262
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9268; val_auprc_score: 0.9830; val_best_acc_score: 0.9262; val_best_f1_score: 0.9577; train_kl_reg_loss: 15247.3240; train_edge_recon_loss: 786076.0196; train_cat_covariates_contrastive_loss: 947988.2612; train_gene_expr_recon_loss: 1597767.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3347079.3125; train_optim_loss: 3347079.3125; val_kl_reg_loss: 14766.0985; val_edge_recon_loss: 813030.2523; val_cat_covariates_contrastive_loss: 947909.6178; val_gene_expr_recon_loss: 1601897.0943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377603.0605; val_optim_loss: 3377603.0605
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9295; val_auprc_score: 0.9840; val_best_acc_score: 0.9272; val_best_f1_score: 0.9582; train_kl_reg_loss: 15253.2096; train_edge_recon_loss: 786504.8805; train_cat_covariates_contrastive_loss: 947939.5001; train_gene_expr_recon_loss: 1596978.4839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346676.0747; train_optim_loss: 3346676.0747; val_kl_reg_loss: 14784.9653; val_edge_recon_loss: 812508.3089; val_cat_covariates_contrastive_loss: 947964.5932; val_gene_expr_recon_loss: 1604218.9288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379476.7930; val_optim_loss: 3379476.7930
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9295; val_auprc_score: 0.9838; val_best_acc_score: 0.9273; val_best_f1_score: 0.9582; train_kl_reg_loss: 15252.0342; train_edge_recon_loss: 786476.5640; train_cat_covariates_contrastive_loss: 947965.7744; train_gene_expr_recon_loss: 1596994.0027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346688.3721; train_optim_loss: 3346688.3721; val_kl_reg_loss: 14762.3403; val_edge_recon_loss: 807474.5886; val_cat_covariates_contrastive_loss: 947609.5343; val_gene_expr_recon_loss: 1602561.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3372408.3309; val_optim_loss: 3372408.3309
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9278; val_auprc_score: 0.9832; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 15230.8303; train_edge_recon_loss: 786530.4837; train_cat_covariates_contrastive_loss: 947987.4871; train_gene_expr_recon_loss: 1597633.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3347382.4797; train_optim_loss: 3347382.4797; val_kl_reg_loss: 14752.7790; val_edge_recon_loss: 813282.5984; val_cat_covariates_contrastive_loss: 947879.2649; val_gene_expr_recon_loss: 1603400.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379315.2592; val_optim_loss: 3379315.2592
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9283; val_auprc_score: 0.9833; val_best_acc_score: 0.9274; val_best_f1_score: 0.9583; train_kl_reg_loss: 15240.4977; train_edge_recon_loss: 785704.3804; train_cat_covariates_contrastive_loss: 948026.6782; train_gene_expr_recon_loss: 1597948.7354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346920.2921; train_optim_loss: 3346920.2921; val_kl_reg_loss: 14762.2628; val_edge_recon_loss: 810284.4921; val_cat_covariates_contrastive_loss: 947967.4334; val_gene_expr_recon_loss: 1605151.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378165.7080; val_optim_loss: 3378165.7080
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9289; val_auprc_score: 0.9835; val_best_acc_score: 0.9266; val_best_f1_score: 0.9578; train_kl_reg_loss: 15241.3157; train_edge_recon_loss: 786341.7259; train_cat_covariates_contrastive_loss: 948044.0328; train_gene_expr_recon_loss: 1596833.8997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346460.9765; train_optim_loss: 3346460.9765; val_kl_reg_loss: 14789.9306; val_edge_recon_loss: 814169.4600; val_cat_covariates_contrastive_loss: 947999.7613; val_gene_expr_recon_loss: 1603596.7818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380555.9201; val_optim_loss: 3380555.9201
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9287; val_auprc_score: 0.9835; val_best_acc_score: 0.9273; val_best_f1_score: 0.9584; train_kl_reg_loss: 15254.2752; train_edge_recon_loss: 784832.6846; train_cat_covariates_contrastive_loss: 947831.7758; train_gene_expr_recon_loss: 1597488.3460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345407.0803; train_optim_loss: 3345407.0803; val_kl_reg_loss: 14752.0543; val_edge_recon_loss: 807660.7567; val_cat_covariates_contrastive_loss: 948280.2782; val_gene_expr_recon_loss: 1605030.2705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375723.3514; val_optim_loss: 3375723.3514

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9279; val_auprc_score: 0.9837; val_best_acc_score: 0.9269; val_best_f1_score: 0.9581; train_kl_reg_loss: 15229.8440; train_edge_recon_loss: 784452.8282; train_cat_covariates_contrastive_loss: 948050.8704; train_gene_expr_recon_loss: 1596981.8823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344715.4274; train_optim_loss: 3344715.4274; val_kl_reg_loss: 14764.3342; val_edge_recon_loss: 806760.6237; val_cat_covariates_contrastive_loss: 948127.1632; val_gene_expr_recon_loss: 1603863.6424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3373515.7551; val_optim_loss: 3373515.7551
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9261; val_auprc_score: 0.9827; val_best_acc_score: 0.9259; val_best_f1_score: 0.9576; train_kl_reg_loss: 15239.8778; train_edge_recon_loss: 788339.5515; train_cat_covariates_contrastive_loss: 947980.2156; train_gene_expr_recon_loss: 1597336.2883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348895.9338; train_optim_loss: 3348895.9338; val_kl_reg_loss: 14758.3208; val_edge_recon_loss: 811633.1383; val_cat_covariates_contrastive_loss: 948042.6076; val_gene_expr_recon_loss: 1605170.3463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379604.4150; val_optim_loss: 3379604.4150
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9271; val_auprc_score: 0.9830; val_best_acc_score: 0.9265; val_best_f1_score: 0.9578; train_kl_reg_loss: 15239.1798; train_edge_recon_loss: 784877.6030; train_cat_covariates_contrastive_loss: 948044.6369; train_gene_expr_recon_loss: 1597219.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345381.0121; train_optim_loss: 3345381.0121; val_kl_reg_loss: 14752.3701; val_edge_recon_loss: 811940.3822; val_cat_covariates_contrastive_loss: 948179.7390; val_gene_expr_recon_loss: 1603248.0333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378120.5174; val_optim_loss: 3378120.5174
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9275; val_auprc_score: 0.9832; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 15246.8870; train_edge_recon_loss: 782516.3055; train_cat_covariates_contrastive_loss: 948039.7806; train_gene_expr_recon_loss: 1597434.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343237.8793; train_optim_loss: 3343237.8793; val_kl_reg_loss: 14756.8461; val_edge_recon_loss: 816399.3673; val_cat_covariates_contrastive_loss: 947888.5092; val_gene_expr_recon_loss: 1602660.1209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381704.8432; val_optim_loss: 3381704.8432

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 572 min 11 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.8998
val AUPRC score: 0.9702
val best accuracy score: 0.9209
val best F1 score: 0.9545
val target rna MSE score: 0.2509
val source rna MSE score: 0.1592
Val cat covariate0 mean sim diff: -0.0027
Val cat covariate1 mean sim diff: -0.0544
Val cat covariate2 mean sim diff: -0.0010

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
