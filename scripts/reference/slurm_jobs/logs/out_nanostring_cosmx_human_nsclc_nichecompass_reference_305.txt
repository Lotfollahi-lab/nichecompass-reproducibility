[True, False, True]
Run timestamp: 30092023_022140_305.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--timestamp_suffix', '_305', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--cat_covariates_embeds_nums', '3', '30', '5', '--contrastive_logits_pos_ratio', '0.03125', '--lambda_l1_addon', '0', '--lambda_l1_masked', '0', '--active_gp_thresh_ratio', '0.03', '--lambda_cat_covariates_contrastive', '1000000.0', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--n_sampled_neighbors', '4', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_hidden_encoder', '960', '--n_addon_gp', '100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8887; val_auprc_score: 0.9747; val_best_acc_score: 0.9072; val_best_f1_score: 0.9474; train_kl_reg_loss: 13724.6309; train_edge_recon_loss: 830076.8167; train_cat_covariates_contrastive_loss: 950281.4774; train_gene_expr_recon_loss: 2804590.8676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598673.7860; train_optim_loss: 4598673.7860; val_kl_reg_loss: 16283.4492; val_edge_recon_loss: 826591.9198; val_cat_covariates_contrastive_loss: 946599.2333; val_gene_expr_recon_loss: 2536545.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4326020.1609; val_optim_loss: 4326020.1609
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9064; val_auprc_score: 0.9788; val_best_acc_score: 0.9113; val_best_f1_score: 0.9496; train_kl_reg_loss: 18330.1303; train_edge_recon_loss: 797196.3407; train_cat_covariates_contrastive_loss: 949882.9946; train_gene_expr_recon_loss: 2349216.4717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4114625.9355; train_optim_loss: 4114625.9355; val_kl_reg_loss: 19620.9016; val_edge_recon_loss: 836398.3150; val_cat_covariates_contrastive_loss: 950359.1270; val_gene_expr_recon_loss: 2226684.7257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4033063.0587; val_optim_loss: 4033063.0587
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8859; val_auprc_score: 0.9735; val_best_acc_score: 0.9037; val_best_f1_score: 0.9455; train_kl_reg_loss: 21096.1526; train_edge_recon_loss: 796357.0741; train_cat_covariates_contrastive_loss: 950588.3801; train_gene_expr_recon_loss: 2169141.4913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3937183.1005; train_optim_loss: 3937183.1005; val_kl_reg_loss: 23839.8306; val_edge_recon_loss: 824734.9884; val_cat_covariates_contrastive_loss: 947538.6268; val_gene_expr_recon_loss: 2133252.5076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3929365.9514; val_optim_loss: 3929365.9514
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9119; val_auprc_score: 0.9800; val_best_acc_score: 0.9166; val_best_f1_score: 0.9523; train_kl_reg_loss: 21799.9924; train_edge_recon_loss: 793814.8015; train_cat_covariates_contrastive_loss: 950566.5881; train_gene_expr_recon_loss: 2106587.1203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3872768.5059; train_optim_loss: 3872768.5059; val_kl_reg_loss: 22935.7634; val_edge_recon_loss: 817646.7409; val_cat_covariates_contrastive_loss: 948600.4828; val_gene_expr_recon_loss: 2090996.9367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3880179.9261; val_optim_loss: 3880179.9261
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9143; val_auprc_score: 0.9805; val_best_acc_score: 0.9168; val_best_f1_score: 0.9525; train_kl_reg_loss: 21992.1342; train_edge_recon_loss: 795128.4132; train_cat_covariates_contrastive_loss: 950462.9025; train_gene_expr_recon_loss: 2076395.3232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3843978.7739; train_optim_loss: 3843978.7739; val_kl_reg_loss: 22388.6362; val_edge_recon_loss: 826801.4780; val_cat_covariates_contrastive_loss: 949458.7014; val_gene_expr_recon_loss: 2068218.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3866867.4059; val_optim_loss: 3866867.4059
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9154; val_auprc_score: 0.9804; val_best_acc_score: 0.9211; val_best_f1_score: 0.9549; train_kl_reg_loss: 22085.3581; train_edge_recon_loss: 791868.3728; train_cat_covariates_contrastive_loss: 950455.6597; train_gene_expr_recon_loss: 2057967.4573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3822376.8467; train_optim_loss: 3822376.8467; val_kl_reg_loss: 23035.3140; val_edge_recon_loss: 814203.0448; val_cat_covariates_contrastive_loss: 948843.8834; val_gene_expr_recon_loss: 2055118.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3841200.5850; val_optim_loss: 3841200.5850
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9177; val_auprc_score: 0.9813; val_best_acc_score: 0.9187; val_best_f1_score: 0.9536; train_kl_reg_loss: 22304.0342; train_edge_recon_loss: 790907.2203; train_cat_covariates_contrastive_loss: 950352.6010; train_gene_expr_recon_loss: 2043591.3592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3807155.2132; train_optim_loss: 3807155.2132; val_kl_reg_loss: 22874.5923; val_edge_recon_loss: 819355.5240; val_cat_covariates_contrastive_loss: 949422.8826; val_gene_expr_recon_loss: 2040428.1513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3832081.1488; val_optim_loss: 3832081.1488
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9239; val_auprc_score: 0.9829; val_best_acc_score: 0.9226; val_best_f1_score: 0.9556; train_kl_reg_loss: 22594.0616; train_edge_recon_loss: 793475.9729; train_cat_covariates_contrastive_loss: 950392.3256; train_gene_expr_recon_loss: 2034910.0705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3801372.4321; train_optim_loss: 3801372.4321; val_kl_reg_loss: 21974.3620; val_edge_recon_loss: 815850.1377; val_cat_covariates_contrastive_loss: 951979.8813; val_gene_expr_recon_loss: 2033045.9676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3822850.3462; val_optim_loss: 3822850.3462
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9124; val_auprc_score: 0.9793; val_best_acc_score: 0.9194; val_best_f1_score: 0.9538; train_kl_reg_loss: 22883.1754; train_edge_recon_loss: 789985.4567; train_cat_covariates_contrastive_loss: 950407.5813; train_gene_expr_recon_loss: 2023288.9921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3786565.2052; train_optim_loss: 3786565.2052; val_kl_reg_loss: 24682.1009; val_edge_recon_loss: 817788.9643; val_cat_covariates_contrastive_loss: 947778.0648; val_gene_expr_recon_loss: 2023975.6544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3814224.7824; val_optim_loss: 3814224.7824
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9262; val_auprc_score: 0.9842; val_best_acc_score: 0.9166; val_best_f1_score: 0.9522; train_kl_reg_loss: 23114.0387; train_edge_recon_loss: 790328.3700; train_cat_covariates_contrastive_loss: 950543.0819; train_gene_expr_recon_loss: 2012942.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3776927.9838; train_optim_loss: 3776927.9838; val_kl_reg_loss: 22196.2033; val_edge_recon_loss: 817342.7771; val_cat_covariates_contrastive_loss: 954870.5030; val_gene_expr_recon_loss: 2013580.0501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3807989.5273; val_optim_loss: 3807989.5273
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9241; val_auprc_score: 0.9827; val_best_acc_score: 0.9246; val_best_f1_score: 0.9569; train_kl_reg_loss: 23456.5943; train_edge_recon_loss: 790968.2809; train_cat_covariates_contrastive_loss: 950448.6134; train_gene_expr_recon_loss: 2005792.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3770666.4625; train_optim_loss: 3770666.4625; val_kl_reg_loss: 23617.6628; val_edge_recon_loss: 816261.7525; val_cat_covariates_contrastive_loss: 950066.1313; val_gene_expr_recon_loss: 2006375.9889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3796321.5334; val_optim_loss: 3796321.5334
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9273; val_auprc_score: 0.9839; val_best_acc_score: 0.9239; val_best_f1_score: 0.9565; train_kl_reg_loss: 23610.4345; train_edge_recon_loss: 790074.2905; train_cat_covariates_contrastive_loss: 950475.2380; train_gene_expr_recon_loss: 1999357.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3763517.0008; train_optim_loss: 3763517.0008; val_kl_reg_loss: 23398.4638; val_edge_recon_loss: 809304.1080; val_cat_covariates_contrastive_loss: 951891.7748; val_gene_expr_recon_loss: 1998352.7394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3782947.0759; val_optim_loss: 3782947.0759
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9249; val_auprc_score: 0.9826; val_best_acc_score: 0.9260; val_best_f1_score: 0.9577; train_kl_reg_loss: 23855.7842; train_edge_recon_loss: 788054.6135; train_cat_covariates_contrastive_loss: 950583.4330; train_gene_expr_recon_loss: 1992040.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3754534.2622; train_optim_loss: 3754534.2622; val_kl_reg_loss: 24254.6548; val_edge_recon_loss: 812183.7120; val_cat_covariates_contrastive_loss: 949944.5418; val_gene_expr_recon_loss: 1989719.5830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3776102.4960; val_optim_loss: 3776102.4960
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9247; val_auprc_score: 0.9829; val_best_acc_score: 0.9227; val_best_f1_score: 0.9558; train_kl_reg_loss: 23908.2174; train_edge_recon_loss: 786773.5892; train_cat_covariates_contrastive_loss: 950682.2500; train_gene_expr_recon_loss: 1987619.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3748983.0966; train_optim_loss: 3748983.0966; val_kl_reg_loss: 23716.0910; val_edge_recon_loss: 812209.5949; val_cat_covariates_contrastive_loss: 950915.9494; val_gene_expr_recon_loss: 1982313.7095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3769155.3431; val_optim_loss: 3769155.3431
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9177; val_auprc_score: 0.9810; val_best_acc_score: 0.9148; val_best_f1_score: 0.9511; train_kl_reg_loss: 24190.4707; train_edge_recon_loss: 785058.9967; train_cat_covariates_contrastive_loss: 950864.0820; train_gene_expr_recon_loss: 1983673.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3743787.3856; train_optim_loss: 3743787.3856; val_kl_reg_loss: 24919.5796; val_edge_recon_loss: 823964.6824; val_cat_covariates_contrastive_loss: 949548.1349; val_gene_expr_recon_loss: 1985032.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3783464.7652; val_optim_loss: 3783464.7652
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9289; val_auprc_score: 0.9836; val_best_acc_score: 0.9274; val_best_f1_score: 0.9584; train_kl_reg_loss: 24277.9419; train_edge_recon_loss: 787939.4880; train_cat_covariates_contrastive_loss: 950654.0857; train_gene_expr_recon_loss: 1977981.9472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3740853.4611; train_optim_loss: 3740853.4611; val_kl_reg_loss: 24582.2792; val_edge_recon_loss: 808531.7705; val_cat_covariates_contrastive_loss: 950272.2252; val_gene_expr_recon_loss: 1978057.6513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3761443.9281; val_optim_loss: 3761443.9281
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9268; val_auprc_score: 0.9834; val_best_acc_score: 0.9190; val_best_f1_score: 0.9533; train_kl_reg_loss: 24453.5357; train_edge_recon_loss: 786500.7836; train_cat_covariates_contrastive_loss: 950879.8954; train_gene_expr_recon_loss: 1978137.3639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3739971.5791; train_optim_loss: 3739971.5791; val_kl_reg_loss: 24082.9449; val_edge_recon_loss: 818993.8621; val_cat_covariates_contrastive_loss: 952366.6761; val_gene_expr_recon_loss: 1981530.8806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3776974.3623; val_optim_loss: 3776974.3623
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9278; val_auprc_score: 0.9832; val_best_acc_score: 0.9273; val_best_f1_score: 0.9583; train_kl_reg_loss: 24434.6498; train_edge_recon_loss: 788265.1540; train_cat_covariates_contrastive_loss: 950806.1502; train_gene_expr_recon_loss: 1971283.3572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3734789.3128; train_optim_loss: 3734789.3128; val_kl_reg_loss: 25230.5881; val_edge_recon_loss: 808633.7546; val_cat_covariates_contrastive_loss: 949580.9689; val_gene_expr_recon_loss: 1976407.6518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759852.9534; val_optim_loss: 3759852.9534
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9177; val_auprc_score: 0.9806; val_best_acc_score: 0.9220; val_best_f1_score: 0.9553; train_kl_reg_loss: 24510.7969; train_edge_recon_loss: 784790.6429; train_cat_covariates_contrastive_loss: 950956.8894; train_gene_expr_recon_loss: 1968523.1968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3728781.5256; train_optim_loss: 3728781.5256; val_kl_reg_loss: 26209.4562; val_edge_recon_loss: 813160.1141; val_cat_covariates_contrastive_loss: 948434.9863; val_gene_expr_recon_loss: 1971745.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759550.4666; val_optim_loss: 3759550.4666
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9325; val_auprc_score: 0.9845; val_best_acc_score: 0.9294; val_best_f1_score: 0.9595; train_kl_reg_loss: 24528.1069; train_edge_recon_loss: 784867.0874; train_cat_covariates_contrastive_loss: 950827.9070; train_gene_expr_recon_loss: 1965456.8031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3725679.9056; train_optim_loss: 3725679.9056; val_kl_reg_loss: 23652.3544; val_edge_recon_loss: 802938.6044; val_cat_covariates_contrastive_loss: 952368.4415; val_gene_expr_recon_loss: 1973636.5425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3752595.9403; val_optim_loss: 3752595.9403
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9352; val_auprc_score: 0.9854; val_best_acc_score: 0.9312; val_best_f1_score: 0.9605; train_kl_reg_loss: 24643.4167; train_edge_recon_loss: 788080.0785; train_cat_covariates_contrastive_loss: 950930.6391; train_gene_expr_recon_loss: 1964107.7795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3727761.9145; train_optim_loss: 3727761.9145; val_kl_reg_loss: 24078.4637; val_edge_recon_loss: 804208.0716; val_cat_covariates_contrastive_loss: 952866.2983; val_gene_expr_recon_loss: 1972696.6225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3753849.4595; val_optim_loss: 3753849.4595
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9290; val_auprc_score: 0.9835; val_best_acc_score: 0.9255; val_best_f1_score: 0.9573; train_kl_reg_loss: 24736.2249; train_edge_recon_loss: 787234.2734; train_cat_covariates_contrastive_loss: 950799.3631; train_gene_expr_recon_loss: 1960969.8522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3723739.7094; train_optim_loss: 3723739.7094; val_kl_reg_loss: 24757.6848; val_edge_recon_loss: 813345.8436; val_cat_covariates_contrastive_loss: 950248.4233; val_gene_expr_recon_loss: 1963264.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3751616.2206; val_optim_loss: 3751616.2206
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9315; val_auprc_score: 0.9843; val_best_acc_score: 0.9275; val_best_f1_score: 0.9584; train_kl_reg_loss: 24728.6531; train_edge_recon_loss: 786419.5731; train_cat_covariates_contrastive_loss: 950950.2083; train_gene_expr_recon_loss: 1958100.9117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3720199.3443; train_optim_loss: 3720199.3443; val_kl_reg_loss: 23801.2870; val_edge_recon_loss: 812096.1583; val_cat_covariates_contrastive_loss: 953177.5003; val_gene_expr_recon_loss: 1963687.9499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3752762.8998; val_optim_loss: 3752762.8998
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9300; val_auprc_score: 0.9835; val_best_acc_score: 0.9291; val_best_f1_score: 0.9593; train_kl_reg_loss: 24838.2932; train_edge_recon_loss: 785340.6145; train_cat_covariates_contrastive_loss: 950735.4857; train_gene_expr_recon_loss: 1957781.9415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3718696.3327; train_optim_loss: 3718696.3327; val_kl_reg_loss: 25680.2315; val_edge_recon_loss: 821287.2199; val_cat_covariates_contrastive_loss: 950031.2232; val_gene_expr_recon_loss: 1960569.5855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3757568.2581; val_optim_loss: 3757568.2581
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9332; val_auprc_score: 0.9845; val_best_acc_score: 0.9306; val_best_f1_score: 0.9602; train_kl_reg_loss: 24931.1346; train_edge_recon_loss: 786238.1983; train_cat_covariates_contrastive_loss: 950944.3386; train_gene_expr_recon_loss: 1956373.0810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3718486.7529; train_optim_loss: 3718486.7529; val_kl_reg_loss: 25773.5149; val_edge_recon_loss: 813803.2320; val_cat_covariates_contrastive_loss: 949395.3411; val_gene_expr_recon_loss: 1964995.0374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3753967.1285; val_optim_loss: 3753967.1285
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9209; val_auprc_score: 0.9812; val_best_acc_score: 0.9257; val_best_f1_score: 0.9574; train_kl_reg_loss: 20373.0514; train_edge_recon_loss: 794882.2936; train_cat_covariates_contrastive_loss: 950518.5236; train_gene_expr_recon_loss: 1596869.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3362642.9593; train_optim_loss: 3362642.9593; val_kl_reg_loss: 13210.1525; val_edge_recon_loss: 818296.3009; val_cat_covariates_contrastive_loss: 948573.5929; val_gene_expr_recon_loss: 1570316.1867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3350396.2358; val_optim_loss: 3350396.2358
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9206; val_auprc_score: 0.9808; val_best_acc_score: 0.9266; val_best_f1_score: 0.9579; train_kl_reg_loss: 17034.5104; train_edge_recon_loss: 789107.4420; train_cat_covariates_contrastive_loss: 949101.8888; train_gene_expr_recon_loss: 1548837.9510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3304081.7910; train_optim_loss: 3304081.7910; val_kl_reg_loss: 14851.6278; val_edge_recon_loss: 816452.5640; val_cat_covariates_contrastive_loss: 947193.3869; val_gene_expr_recon_loss: 1545609.0572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3324106.6316; val_optim_loss: 3324106.6316
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9266; val_auprc_score: 0.9834; val_best_acc_score: 0.9252; val_best_f1_score: 0.9571; train_kl_reg_loss: 16436.6817; train_edge_recon_loss: 787069.9762; train_cat_covariates_contrastive_loss: 948765.5183; train_gene_expr_recon_loss: 1536494.5105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3288766.6867; train_optim_loss: 3288766.6867; val_kl_reg_loss: 15292.9126; val_edge_recon_loss: 804846.5271; val_cat_covariates_contrastive_loss: 948939.2045; val_gene_expr_recon_loss: 1534837.5228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303916.1711; val_optim_loss: 3303916.1711
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9228; val_auprc_score: 0.9816; val_best_acc_score: 0.9272; val_best_f1_score: 0.9583; train_kl_reg_loss: 16688.3353; train_edge_recon_loss: 786486.3296; train_cat_covariates_contrastive_loss: 948601.7131; train_gene_expr_recon_loss: 1529901.9321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3281678.3108; train_optim_loss: 3281678.3108; val_kl_reg_loss: 16663.8385; val_edge_recon_loss: 812719.6759; val_cat_covariates_contrastive_loss: 947318.6561; val_gene_expr_recon_loss: 1534430.9438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3311133.1144; val_optim_loss: 3311133.1144
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9278; val_auprc_score: 0.9836; val_best_acc_score: 0.9281; val_best_f1_score: 0.9588; train_kl_reg_loss: 556922127.0302; train_edge_recon_loss: 786313.8687; train_cat_covariates_contrastive_loss: 947574.7210; train_gene_expr_recon_loss: 1472633.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 560128626.9887; train_optim_loss: 560128626.9887; val_kl_reg_loss: 10783.9871; val_edge_recon_loss: 805395.9519; val_cat_covariates_contrastive_loss: 944472.6594; val_gene_expr_recon_loss: 1241172.8360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3001825.4443; val_optim_loss: 3001825.4443
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9356; val_auprc_score: 0.9857; val_best_acc_score: 0.9288; val_best_f1_score: 0.9592; train_kl_reg_loss: 9794.6580; train_edge_recon_loss: 781290.2659; train_cat_covariates_contrastive_loss: 945181.2992; train_gene_expr_recon_loss: 1216807.7645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2953073.9871; train_optim_loss: 2953073.9871; val_kl_reg_loss: 7794.7753; val_edge_recon_loss: 805350.5820; val_cat_covariates_contrastive_loss: 947582.7627; val_gene_expr_recon_loss: 1210036.6776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2970764.7976; val_optim_loss: 2970764.7976
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9336; val_auprc_score: 0.9849; val_best_acc_score: 0.9299; val_best_f1_score: 0.9597; train_kl_reg_loss: 8485.0849; train_edge_recon_loss: 779127.6477; train_cat_covariates_contrastive_loss: 944983.3002; train_gene_expr_recon_loss: 1206203.9029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2938799.9383; train_optim_loss: 2938799.9383; val_kl_reg_loss: 7474.9273; val_edge_recon_loss: 807732.1743; val_cat_covariates_contrastive_loss: 945210.5802; val_gene_expr_recon_loss: 1203717.9717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2964135.6640; val_optim_loss: 2964135.6640
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9307; val_auprc_score: 0.9840; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 7936.1353; train_edge_recon_loss: 781622.6193; train_cat_covariates_contrastive_loss: 944767.0469; train_gene_expr_recon_loss: 1200804.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2935130.5395; train_optim_loss: 2935130.5395; val_kl_reg_loss: 7212.4221; val_edge_recon_loss: 803354.0233; val_cat_covariates_contrastive_loss: 944835.9914; val_gene_expr_recon_loss: 1197934.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953337.1134; val_optim_loss: 2953337.1134
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9302; val_auprc_score: 0.9842; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 7890.0109; train_edge_recon_loss: 778022.5294; train_cat_covariates_contrastive_loss: 944723.7625; train_gene_expr_recon_loss: 1198409.3714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2929045.6746; train_optim_loss: 2929045.6746; val_kl_reg_loss: 7097.8176; val_edge_recon_loss: 804362.2796; val_cat_covariates_contrastive_loss: 945075.9261; val_gene_expr_recon_loss: 1196748.4539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953284.4747; val_optim_loss: 2953284.4747
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9307; val_auprc_score: 0.9842; val_best_acc_score: 0.9269; val_best_f1_score: 0.9579; train_kl_reg_loss: 32599133.1238; train_edge_recon_loss: 780387.4483; train_cat_covariates_contrastive_loss: 944974.9330; train_gene_expr_recon_loss: 1213743.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35538239.4235; train_optim_loss: 35538239.4235; val_kl_reg_loss: 8339.1646; val_edge_recon_loss: 798856.9982; val_cat_covariates_contrastive_loss: 944108.5453; val_gene_expr_recon_loss: 1200004.5010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2951309.2146; val_optim_loss: 2951309.2146
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9315; val_auprc_score: 0.9846; val_best_acc_score: 0.9276; val_best_f1_score: 0.9585; train_kl_reg_loss: 8525.2958; train_edge_recon_loss: 779790.9138; train_cat_covariates_contrastive_loss: 944788.2187; train_gene_expr_recon_loss: 1198687.2719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2931791.7027; train_optim_loss: 2931791.7027; val_kl_reg_loss: 8524.7706; val_edge_recon_loss: 801315.4729; val_cat_covariates_contrastive_loss: 944213.8120; val_gene_expr_recon_loss: 1199871.4899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953925.5506; val_optim_loss: 2953925.5506
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9289; val_auprc_score: 0.9833; val_best_acc_score: 0.9286; val_best_f1_score: 0.9590; train_kl_reg_loss: 9276.9005; train_edge_recon_loss: 781574.6743; train_cat_covariates_contrastive_loss: 944777.5669; train_gene_expr_recon_loss: 1196558.8902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2932188.0291; train_optim_loss: 2932188.0291; val_kl_reg_loss: 8446.1711; val_edge_recon_loss: 810583.0251; val_cat_covariates_contrastive_loss: 943631.2057; val_gene_expr_recon_loss: 1196556.3608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2959216.7561; val_optim_loss: 2959216.7561
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9205; val_auprc_score: 0.9812; val_best_acc_score: 0.9255; val_best_f1_score: 0.9573; train_kl_reg_loss: 8237.2377; train_edge_recon_loss: 776936.8892; train_cat_covariates_contrastive_loss: 944376.5484; train_gene_expr_recon_loss: 1194799.2912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2924349.9631; train_optim_loss: 2924349.9631; val_kl_reg_loss: 8186.7302; val_edge_recon_loss: 803158.3186; val_cat_covariates_contrastive_loss: 942888.9919; val_gene_expr_recon_loss: 1197041.4534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2951275.5000; val_optim_loss: 2951275.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9332; val_auprc_score: 0.9841; val_best_acc_score: 0.9331; val_best_f1_score: 0.9617; train_kl_reg_loss: 8142.5099; train_edge_recon_loss: 777832.9825; train_cat_covariates_contrastive_loss: 944480.7556; train_gene_expr_recon_loss: 1193797.4433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2924253.6928; train_optim_loss: 2924253.6928; val_kl_reg_loss: 7967.6357; val_edge_recon_loss: 800835.0569; val_cat_covariates_contrastive_loss: 944077.3920; val_gene_expr_recon_loss: 1193631.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2946511.7328; val_optim_loss: 2946511.7328
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9284; val_auprc_score: 0.9833; val_best_acc_score: 0.9277; val_best_f1_score: 0.9585; train_kl_reg_loss: 60380.4874; train_edge_recon_loss: 779513.8768; train_cat_covariates_contrastive_loss: 944349.2940; train_gene_expr_recon_loss: 1200287.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2984531.5191; train_optim_loss: 2984531.5191; val_kl_reg_loss: 9185.7844; val_edge_recon_loss: 807479.4570; val_cat_covariates_contrastive_loss: 943205.9684; val_gene_expr_recon_loss: 1154060.0076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2913931.2237; val_optim_loss: 2913931.2237
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9330; val_auprc_score: 0.9848; val_best_acc_score: 0.9288; val_best_f1_score: 0.9591; train_kl_reg_loss: 8102.5565; train_edge_recon_loss: 780065.6633; train_cat_covariates_contrastive_loss: 944348.0591; train_gene_expr_recon_loss: 1117148.6271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2849664.9049; train_optim_loss: 2849664.9049; val_kl_reg_loss: 7306.3607; val_edge_recon_loss: 806564.6480; val_cat_covariates_contrastive_loss: 945228.2454; val_gene_expr_recon_loss: 1115560.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2874659.6862; val_optim_loss: 2874659.6862
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9287; val_auprc_score: 0.9835; val_best_acc_score: 0.9275; val_best_f1_score: 0.9584; train_kl_reg_loss: 7812.7334; train_edge_recon_loss: 778321.9227; train_cat_covariates_contrastive_loss: 944321.0157; train_gene_expr_recon_loss: 1114269.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2844725.3959; train_optim_loss: 2844725.3959; val_kl_reg_loss: 6933.8560; val_edge_recon_loss: 798752.1671; val_cat_covariates_contrastive_loss: 943735.5926; val_gene_expr_recon_loss: 1122379.2991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2871800.9140; val_optim_loss: 2871800.9140
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9338; val_auprc_score: 0.9852; val_best_acc_score: 0.9294; val_best_f1_score: 0.9596; train_kl_reg_loss: 7565.9859; train_edge_recon_loss: 777497.8919; train_cat_covariates_contrastive_loss: 944259.1812; train_gene_expr_recon_loss: 1111860.6302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2841183.6920; train_optim_loss: 2841183.6920; val_kl_reg_loss: 7081.2632; val_edge_recon_loss: 799995.4858; val_cat_covariates_contrastive_loss: 944763.0772; val_gene_expr_recon_loss: 1112747.2584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2864587.0840; val_optim_loss: 2864587.0840
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9298; val_auprc_score: 0.9837; val_best_acc_score: 0.9259; val_best_f1_score: 0.9574; train_kl_reg_loss: 7613.4952; train_edge_recon_loss: 779098.1762; train_cat_covariates_contrastive_loss: 944242.4749; train_gene_expr_recon_loss: 1113135.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2844089.8371; train_optim_loss: 2844089.8371; val_kl_reg_loss: 6646.3168; val_edge_recon_loss: 808123.0013; val_cat_covariates_contrastive_loss: 944527.8006; val_gene_expr_recon_loss: 1119642.2566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2878939.3725; val_optim_loss: 2878939.3725
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9357; val_auprc_score: 0.9853; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 7919.7482; train_edge_recon_loss: 782049.5124; train_cat_covariates_contrastive_loss: 944021.0966; train_gene_expr_recon_loss: 1116377.0528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2850367.4079; train_optim_loss: 2850367.4079; val_kl_reg_loss: 6954.1544; val_edge_recon_loss: 804849.7015; val_cat_covariates_contrastive_loss: 944219.4426; val_gene_expr_recon_loss: 1110563.5934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2866586.8907; val_optim_loss: 2866586.8907
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9389; val_auprc_score: 0.9864; val_best_acc_score: 0.9328; val_best_f1_score: 0.9615; train_kl_reg_loss: 7572.8897; train_edge_recon_loss: 775636.4672; train_cat_covariates_contrastive_loss: 944078.5672; train_gene_expr_recon_loss: 1111694.1043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2838982.0258; train_optim_loss: 2838982.0258; val_kl_reg_loss: 6582.7000; val_edge_recon_loss: 794654.4615; val_cat_covariates_contrastive_loss: 946650.9489; val_gene_expr_recon_loss: 1111761.0830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2859649.1984; val_optim_loss: 2859649.1984
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9365; val_auprc_score: 0.9858; val_best_acc_score: 0.9321; val_best_f1_score: 0.9611; train_kl_reg_loss: 8394.6236; train_edge_recon_loss: 778392.5923; train_cat_covariates_contrastive_loss: 944162.1513; train_gene_expr_recon_loss: 1119364.1080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2850313.4752; train_optim_loss: 2850313.4752; val_kl_reg_loss: 6662.4897; val_edge_recon_loss: 798633.4916; val_cat_covariates_contrastive_loss: 945204.0638; val_gene_expr_recon_loss: 1111449.5668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2861949.6083; val_optim_loss: 2861949.6083
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9324; val_auprc_score: 0.9842; val_best_acc_score: 0.9284; val_best_f1_score: 0.9588; train_kl_reg_loss: 7361.1487; train_edge_recon_loss: 778466.0759; train_cat_covariates_contrastive_loss: 944180.0936; train_gene_expr_recon_loss: 1109390.1197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2839397.4411; train_optim_loss: 2839397.4411; val_kl_reg_loss: 7010.9645; val_edge_recon_loss: 807273.5190; val_cat_covariates_contrastive_loss: 943096.1829; val_gene_expr_recon_loss: 1110773.5491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2868154.2085; val_optim_loss: 2868154.2085
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9353; val_auprc_score: 0.9854; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 638790325964.9186; train_edge_recon_loss: 778354.0957; train_cat_covariates_contrastive_loss: 944046.3647; train_gene_expr_recon_loss: 1113296.0705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 638793160427.5042; train_optim_loss: 638793160427.5042; val_kl_reg_loss: 6837.9367; val_edge_recon_loss: 801342.4205; val_cat_covariates_contrastive_loss: 944305.4297; val_gene_expr_recon_loss: 1112386.4691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2864872.2581; val_optim_loss: 2864872.2581
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9230; val_auprc_score: 0.9818; val_best_acc_score: 0.9235; val_best_f1_score: 0.9560; train_kl_reg_loss: 11995019113.6929; train_edge_recon_loss: 779190.1938; train_cat_covariates_contrastive_loss: 944009.2135; train_gene_expr_recon_loss: 1117127.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11997859033.4345; train_optim_loss: 11997859033.4345; val_kl_reg_loss: 7953.1799; val_edge_recon_loss: 804202.5167; val_cat_covariates_contrastive_loss: 943130.4704; val_gene_expr_recon_loss: 1114286.5445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2869572.7136; val_optim_loss: 2869572.7136

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9382; val_auprc_score: 0.9856; val_best_acc_score: 0.9347; val_best_f1_score: 0.9625; train_kl_reg_loss: 7690.0635; train_edge_recon_loss: 777180.1062; train_cat_covariates_contrastive_loss: 943936.5613; train_gene_expr_recon_loss: 1107501.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2836308.5935; train_optim_loss: 2836308.5935; val_kl_reg_loss: 7276.0534; val_edge_recon_loss: 796264.5412; val_cat_covariates_contrastive_loss: 943896.0195; val_gene_expr_recon_loss: 1107275.9028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2854712.5162; val_optim_loss: 2854712.5162
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9396; val_auprc_score: 0.9860; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 7565.2052; train_edge_recon_loss: 775949.9209; train_cat_covariates_contrastive_loss: 944061.0862; train_gene_expr_recon_loss: 1103872.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2831448.9492; train_optim_loss: 2831448.9492; val_kl_reg_loss: 7168.1115; val_edge_recon_loss: 801564.0374; val_cat_covariates_contrastive_loss: 944086.3927; val_gene_expr_recon_loss: 1104401.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2857219.9787; val_optim_loss: 2857219.9787
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9384; val_auprc_score: 0.9858; val_best_acc_score: 0.9347; val_best_f1_score: 0.9624; train_kl_reg_loss: 7494.5552; train_edge_recon_loss: 776391.1490; train_cat_covariates_contrastive_loss: 943877.8331; train_gene_expr_recon_loss: 1102183.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2829946.6005; train_optim_loss: 2829946.6005; val_kl_reg_loss: 7050.8106; val_edge_recon_loss: 790736.0497; val_cat_covariates_contrastive_loss: 944692.6733; val_gene_expr_recon_loss: 1104103.2399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2846582.7713; val_optim_loss: 2846582.7713
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9381; val_auprc_score: 0.9857; val_best_acc_score: 0.9344; val_best_f1_score: 0.9623; train_kl_reg_loss: 7379.5239; train_edge_recon_loss: 777118.4283; train_cat_covariates_contrastive_loss: 943906.8472; train_gene_expr_recon_loss: 1101326.6882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2829731.4863; train_optim_loss: 2829731.4863; val_kl_reg_loss: 7103.0622; val_edge_recon_loss: 795539.2318; val_cat_covariates_contrastive_loss: 943932.6043; val_gene_expr_recon_loss: 1102857.8735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2849432.7692; val_optim_loss: 2849432.7692
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9399; val_auprc_score: 0.9860; val_best_acc_score: 0.9364; val_best_f1_score: 0.9635; train_kl_reg_loss: 7251.6518; train_edge_recon_loss: 775057.6343; train_cat_covariates_contrastive_loss: 943965.0177; train_gene_expr_recon_loss: 1100298.5950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2826572.9006; train_optim_loss: 2826572.9006; val_kl_reg_loss: 6904.8151; val_edge_recon_loss: 790995.2657; val_cat_covariates_contrastive_loss: 943639.2199; val_gene_expr_recon_loss: 1101792.5896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2843331.8877; val_optim_loss: 2843331.8877
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9399; val_auprc_score: 0.9861; val_best_acc_score: 0.9351; val_best_f1_score: 0.9626; train_kl_reg_loss: 7189.4761; train_edge_recon_loss: 774480.8035; train_cat_covariates_contrastive_loss: 943855.9337; train_gene_expr_recon_loss: 1100147.0225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825673.2367; train_optim_loss: 2825673.2367; val_kl_reg_loss: 6806.0404; val_edge_recon_loss: 793339.8477; val_cat_covariates_contrastive_loss: 944361.1156; val_gene_expr_recon_loss: 1102492.8806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2846999.8846; val_optim_loss: 2846999.8846
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9387; val_auprc_score: 0.9855; val_best_acc_score: 0.9360; val_best_f1_score: 0.9632; train_kl_reg_loss: 7122.7640; train_edge_recon_loss: 775652.4184; train_cat_covariates_contrastive_loss: 943877.8433; train_gene_expr_recon_loss: 1099227.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825880.3453; train_optim_loss: 2825880.3453; val_kl_reg_loss: 6890.9110; val_edge_recon_loss: 797647.9251; val_cat_covariates_contrastive_loss: 943641.1518; val_gene_expr_recon_loss: 1102444.9428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2850624.9322; val_optim_loss: 2850624.9322
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9393; val_auprc_score: 0.9857; val_best_acc_score: 0.9360; val_best_f1_score: 0.9632; train_kl_reg_loss: 7103.1959; train_edge_recon_loss: 775717.3772; train_cat_covariates_contrastive_loss: 943876.6441; train_gene_expr_recon_loss: 1099016.9863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825714.2034; train_optim_loss: 2825714.2034; val_kl_reg_loss: 6887.4504; val_edge_recon_loss: 800004.4395; val_cat_covariates_contrastive_loss: 943570.6093; val_gene_expr_recon_loss: 1100015.9610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2850478.4666; val_optim_loss: 2850478.4666
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9401; val_auprc_score: 0.9860; val_best_acc_score: 0.9351; val_best_f1_score: 0.9627; train_kl_reg_loss: 7052.3881; train_edge_recon_loss: 775460.4118; train_cat_covariates_contrastive_loss: 943851.3450; train_gene_expr_recon_loss: 1098742.2933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825106.4385; train_optim_loss: 2825106.4385; val_kl_reg_loss: 6817.1380; val_edge_recon_loss: 799840.6468; val_cat_covariates_contrastive_loss: 943839.6867; val_gene_expr_recon_loss: 1100570.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2851068.3634; val_optim_loss: 2851068.3634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9391; val_auprc_score: 0.9857; val_best_acc_score: 0.9347; val_best_f1_score: 0.9624; train_kl_reg_loss: 7029.0298; train_edge_recon_loss: 773811.5214; train_cat_covariates_contrastive_loss: 943724.7159; train_gene_expr_recon_loss: 1097713.6155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2822278.8791; train_optim_loss: 2822278.8791; val_kl_reg_loss: 6747.6770; val_edge_recon_loss: 797619.5893; val_cat_covariates_contrastive_loss: 944142.4524; val_gene_expr_recon_loss: 1099261.6025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2847771.3097; val_optim_loss: 2847771.3097
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9420; val_auprc_score: 0.9864; val_best_acc_score: 0.9359; val_best_f1_score: 0.9631; train_kl_reg_loss: 6985.9438; train_edge_recon_loss: 775517.3260; train_cat_covariates_contrastive_loss: 943705.7105; train_gene_expr_recon_loss: 1097791.1595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2824000.1359; train_optim_loss: 2824000.1359; val_kl_reg_loss: 6722.4684; val_edge_recon_loss: 798711.9502; val_cat_covariates_contrastive_loss: 944240.6842; val_gene_expr_recon_loss: 1099010.6321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2848685.7308; val_optim_loss: 2848685.7308
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9383; val_auprc_score: 0.9854; val_best_acc_score: 0.9352; val_best_f1_score: 0.9628; train_kl_reg_loss: 6961.1678; train_edge_recon_loss: 770959.7451; train_cat_covariates_contrastive_loss: 943900.0904; train_gene_expr_recon_loss: 1097778.8727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2819599.8762; train_optim_loss: 2819599.8762; val_kl_reg_loss: 6714.4095; val_edge_recon_loss: 798503.6743; val_cat_covariates_contrastive_loss: 944108.2647; val_gene_expr_recon_loss: 1100700.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2850026.9555; val_optim_loss: 2850026.9555
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9405; val_auprc_score: 0.9860; val_best_acc_score: 0.9368; val_best_f1_score: 0.9636; train_kl_reg_loss: 6959.4992; train_edge_recon_loss: 774923.3910; train_cat_covariates_contrastive_loss: 943851.4112; train_gene_expr_recon_loss: 1097570.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2823305.1968; train_optim_loss: 2823305.1968; val_kl_reg_loss: 6731.1774; val_edge_recon_loss: 794653.4560; val_cat_covariates_contrastive_loss: 943446.4150; val_gene_expr_recon_loss: 1100356.8659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2845187.9221; val_optim_loss: 2845187.9221

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 775 min 3 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9159
val AUPRC score: 0.9744
val best accuracy score: 0.9313
val best F1 score: 0.9604
val target rna MSE score: 0.2133
val source rna MSE score: 0.1746
Val cat covariate0 mean sim diff: -0.0001
Val cat covariate1 mean sim diff: -0.0697
Val cat covariate2 mean sim diff: 0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
