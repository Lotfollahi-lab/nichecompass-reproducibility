[True, False, True]
Run timestamp: 30092023_022140_306.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--timestamp_suffix', '_306', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--cat_covariates_embeds_nums', '3', '30', '5', '--contrastive_logits_pos_ratio', '0.03125', '--lambda_l1_addon', '1000', '--lambda_l1_masked', '0', '--active_gp_thresh_ratio', '0.03', '--lambda_cat_covariates_contrastive', '1000000.0', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--n_sampled_neighbors', '4', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_hidden_encoder', '960', '--n_addon_gp', '100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8958; val_auprc_score: 0.9772; val_best_acc_score: 0.9068; val_best_f1_score: 0.9473; train_kl_reg_loss: 16839.3954; train_edge_recon_loss: 834101.5930; train_cat_covariates_contrastive_loss: 950510.0732; train_gene_expr_recon_loss: 2834198.8699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104751.5855; train_global_loss: 4740401.5222; train_optim_loss: 4740401.5222; val_kl_reg_loss: 17728.8153; val_edge_recon_loss: 834947.5149; val_cat_covariates_contrastive_loss: 949713.6270; val_gene_expr_recon_loss: 2589035.5061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23232.4141; val_global_loss: 4414657.9464; val_optim_loss: 4414657.9464
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9088; val_auprc_score: 0.9804; val_best_acc_score: 0.9129; val_best_f1_score: 0.9504; train_kl_reg_loss: 20048.9178; train_edge_recon_loss: 799618.5535; train_cat_covariates_contrastive_loss: 951608.6787; train_gene_expr_recon_loss: 2425348.2115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23799.9520; train_global_loss: 4220424.3093; train_optim_loss: 4220424.3093; val_kl_reg_loss: 20307.5171; val_edge_recon_loss: 819658.5121; val_cat_covariates_contrastive_loss: 954252.6326; val_gene_expr_recon_loss: 2331720.5881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24327.0801; val_global_loss: 4150266.2642; val_optim_loss: 4150266.2642
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9082; val_auprc_score: 0.9793; val_best_acc_score: 0.9165; val_best_f1_score: 0.9524; train_kl_reg_loss: 22460.1113; train_edge_recon_loss: 791142.1946; train_cat_covariates_contrastive_loss: 952123.2831; train_gene_expr_recon_loss: 2275867.5683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24684.3967; train_global_loss: 4066277.5570; train_optim_loss: 4066277.5570; val_kl_reg_loss: 24765.5813; val_edge_recon_loss: 815617.5951; val_cat_covariates_contrastive_loss: 949672.6318; val_gene_expr_recon_loss: 2249846.1802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25066.7227; val_global_loss: 4064968.7257; val_optim_loss: 4064968.7257
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9138; val_auprc_score: 0.9805; val_best_acc_score: 0.9187; val_best_f1_score: 0.9535; train_kl_reg_loss: 23512.3031; train_edge_recon_loss: 789719.7939; train_cat_covariates_contrastive_loss: 952252.8390; train_gene_expr_recon_loss: 2221985.0483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25173.7099; train_global_loss: 4012643.6910; train_optim_loss: 4012643.6910; val_kl_reg_loss: 24053.1388; val_edge_recon_loss: 820840.8019; val_cat_covariates_contrastive_loss: 951250.7763; val_gene_expr_recon_loss: 2210435.4423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25559.2500; val_global_loss: 4032139.4089; val_optim_loss: 4032139.4089
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9205; val_auprc_score: 0.9826; val_best_acc_score: 0.9205; val_best_f1_score: 0.9546; train_kl_reg_loss: 24121.5238; train_edge_recon_loss: 792687.9203; train_cat_covariates_contrastive_loss: 952327.7915; train_gene_expr_recon_loss: 2196528.3778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25646.2502; train_global_loss: 3991311.8609; train_optim_loss: 3991311.8609; val_kl_reg_loss: 23438.6915; val_edge_recon_loss: 820143.8983; val_cat_covariates_contrastive_loss: 954033.9598; val_gene_expr_recon_loss: 2196843.2748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26040.4922; val_global_loss: 4020500.3219; val_optim_loss: 4020500.3219
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9167; val_auprc_score: 0.9808; val_best_acc_score: 0.9233; val_best_f1_score: 0.9562; train_kl_reg_loss: 24573.1137; train_edge_recon_loss: 788931.0779; train_cat_covariates_contrastive_loss: 952360.3623; train_gene_expr_recon_loss: 2178222.7249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26095.8204; train_global_loss: 3970183.1035; train_optim_loss: 3970183.1035; val_kl_reg_loss: 26490.8937; val_edge_recon_loss: 817816.7338; val_cat_covariates_contrastive_loss: 949534.0521; val_gene_expr_recon_loss: 2183489.2738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26450.6152; val_global_loss: 4003781.4534; val_optim_loss: 4003781.4534
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9120; val_auprc_score: 0.9795; val_best_acc_score: 0.9191; val_best_f1_score: 0.9536; train_kl_reg_loss: 25172.7363; train_edge_recon_loss: 788660.1728; train_cat_covariates_contrastive_loss: 952652.7967; train_gene_expr_recon_loss: 2163758.0887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26630.7016; train_global_loss: 3956874.4976; train_optim_loss: 3956874.4976; val_kl_reg_loss: 26704.1432; val_edge_recon_loss: 827102.8236; val_cat_covariates_contrastive_loss: 950002.0504; val_gene_expr_recon_loss: 2177189.7055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26896.5449; val_global_loss: 4007895.2237; val_optim_loss: 4007895.2237
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9118; val_auprc_score: 0.9792; val_best_acc_score: 0.9231; val_best_f1_score: 0.9562; train_kl_reg_loss: 25718.4501; train_edge_recon_loss: 785992.9470; train_cat_covariates_contrastive_loss: 952726.4114; train_gene_expr_recon_loss: 2151530.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27166.5900; train_global_loss: 3943134.9885; train_optim_loss: 3943134.9885; val_kl_reg_loss: 27829.8357; val_edge_recon_loss: 820175.9165; val_cat_covariates_contrastive_loss: 949578.4638; val_gene_expr_recon_loss: 2156591.1559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27160.5547; val_global_loss: 3981335.8674; val_optim_loss: 3981335.8674
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9147; val_auprc_score: 0.9801; val_best_acc_score: 0.9200; val_best_f1_score: 0.9543; train_kl_reg_loss: 26235.2247; train_edge_recon_loss: 788634.0266; train_cat_covariates_contrastive_loss: 952866.0453; train_gene_expr_recon_loss: 2141843.8560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27556.8952; train_global_loss: 3937136.0463; train_optim_loss: 3937136.0463; val_kl_reg_loss: 28329.1670; val_edge_recon_loss: 819481.4527; val_cat_covariates_contrastive_loss: 950089.5959; val_gene_expr_recon_loss: 2147065.6685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27401.1699; val_global_loss: 3972367.1366; val_optim_loss: 3972367.1366
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9170; val_auprc_score: 0.9804; val_best_acc_score: 0.9242; val_best_f1_score: 0.9567; train_kl_reg_loss: 26473.4952; train_edge_recon_loss: 785891.1709; train_cat_covariates_contrastive_loss: 952781.1051; train_gene_expr_recon_loss: 2132808.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27810.1172; train_global_loss: 3925764.1339; train_optim_loss: 3925764.1339; val_kl_reg_loss: 27077.5497; val_edge_recon_loss: 815023.5681; val_cat_covariates_contrastive_loss: 950802.5066; val_gene_expr_recon_loss: 2144574.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27623.5586; val_global_loss: 3965101.6184; val_optim_loss: 3965101.6184
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9218; val_auprc_score: 0.9822; val_best_acc_score: 0.9225; val_best_f1_score: 0.9556; train_kl_reg_loss: 26708.6611; train_edge_recon_loss: 789326.5483; train_cat_covariates_contrastive_loss: 952940.8509; train_gene_expr_recon_loss: 2126897.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28064.4792; train_global_loss: 3923938.3461; train_optim_loss: 3923938.3461; val_kl_reg_loss: 26895.4955; val_edge_recon_loss: 812629.4598; val_cat_covariates_contrastive_loss: 952210.2869; val_gene_expr_recon_loss: 2129606.8613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28345.4727; val_global_loss: 3949687.6032; val_optim_loss: 3949687.6032
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9182; val_auprc_score: 0.9806; val_best_acc_score: 0.9244; val_best_f1_score: 0.9567; train_kl_reg_loss: 27001.9154; train_edge_recon_loss: 785978.8436; train_cat_covariates_contrastive_loss: 953133.2273; train_gene_expr_recon_loss: 2121064.8673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28567.1012; train_global_loss: 3915745.9533; train_optim_loss: 3915745.9533; val_kl_reg_loss: 27961.8029; val_edge_recon_loss: 817967.4190; val_cat_covariates_contrastive_loss: 951722.6878; val_gene_expr_recon_loss: 2128623.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28952.8203; val_global_loss: 3955228.1711; val_optim_loss: 3955228.1711
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9264; val_auprc_score: 0.9832; val_best_acc_score: 0.9294; val_best_f1_score: 0.9596; train_kl_reg_loss: 27532.8240; train_edge_recon_loss: 792825.2024; train_cat_covariates_contrastive_loss: 953203.0226; train_gene_expr_recon_loss: 2257508.5923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29217.4730; train_global_loss: 4060287.1099; train_optim_loss: 4060287.1099; val_kl_reg_loss: 29009.1047; val_edge_recon_loss: 806900.5377; val_cat_covariates_contrastive_loss: 952352.3537; val_gene_expr_recon_loss: 2177993.9575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28917.4727; val_global_loss: 3995173.4504; val_optim_loss: 3995173.4504
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9238; val_auprc_score: 0.9825; val_best_acc_score: 0.9251; val_best_f1_score: 0.9571; train_kl_reg_loss: 28031.5039; train_edge_recon_loss: 786474.6418; train_cat_covariates_contrastive_loss: 953791.5471; train_gene_expr_recon_loss: 2148517.4944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28993.9636; train_global_loss: 3945809.1528; train_optim_loss: 3945809.1528; val_kl_reg_loss: 28225.2798; val_edge_recon_loss: 814265.3429; val_cat_covariates_contrastive_loss: 952712.3009; val_gene_expr_recon_loss: 2142329.2399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28988.7773; val_global_loss: 3966520.9038; val_optim_loss: 3966520.9038
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9208; val_auprc_score: 0.9816; val_best_acc_score: 0.9225; val_best_f1_score: 0.9556; train_kl_reg_loss: 27896.8931; train_edge_recon_loss: 788664.4040; train_cat_covariates_contrastive_loss: 953735.5018; train_gene_expr_recon_loss: 2121461.1847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29150.5313; train_global_loss: 3920908.5190; train_optim_loss: 3920908.5190; val_kl_reg_loss: 27847.4181; val_edge_recon_loss: 814688.3074; val_cat_covariates_contrastive_loss: 952469.9780; val_gene_expr_recon_loss: 2123458.8198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28890.5879; val_global_loss: 3947355.0344; val_optim_loss: 3947355.0344
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9287; val_auprc_score: 0.9835; val_best_acc_score: 0.9268; val_best_f1_score: 0.9581; train_kl_reg_loss: 28098.7868; train_edge_recon_loss: 787668.1630; train_cat_covariates_contrastive_loss: 953638.3472; train_gene_expr_recon_loss: 2108088.6115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29325.7921; train_global_loss: 3906819.6958; train_optim_loss: 3906819.6958; val_kl_reg_loss: 27873.0138; val_edge_recon_loss: 819586.5822; val_cat_covariates_contrastive_loss: 954379.1913; val_gene_expr_recon_loss: 2111667.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29104.1914; val_global_loss: 3942610.3148; val_optim_loss: 3942610.3148
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9229; val_auprc_score: 0.9817; val_best_acc_score: 0.9274; val_best_f1_score: 0.9584; train_kl_reg_loss: 28201.6703; train_edge_recon_loss: 789597.4112; train_cat_covariates_contrastive_loss: 953725.4732; train_gene_expr_recon_loss: 2101168.3777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29460.4694; train_global_loss: 3902153.3996; train_optim_loss: 3902153.3996; val_kl_reg_loss: 28763.7986; val_edge_recon_loss: 818609.3406; val_cat_covariates_contrastive_loss: 951356.6027; val_gene_expr_recon_loss: 2125036.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29615.6328; val_global_loss: 3953382.0547; val_optim_loss: 3953382.0547
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9203; val_auprc_score: 0.9811; val_best_acc_score: 0.9253; val_best_f1_score: 0.9572; train_kl_reg_loss: 28317.2172; train_edge_recon_loss: 787538.4477; train_cat_covariates_contrastive_loss: 953790.7105; train_gene_expr_recon_loss: 2096097.9026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29533.6729; train_global_loss: 3895277.9487; train_optim_loss: 3895277.9487; val_kl_reg_loss: 29868.5308; val_edge_recon_loss: 817041.0433; val_cat_covariates_contrastive_loss: 952583.6334; val_gene_expr_recon_loss: 2108294.0374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29533.7480; val_global_loss: 3937320.9960; val_optim_loss: 3937320.9960
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9206; val_auprc_score: 0.9811; val_best_acc_score: 0.9245; val_best_f1_score: 0.9568; train_kl_reg_loss: 24035.3213; train_edge_recon_loss: 791455.9181; train_cat_covariates_contrastive_loss: 951464.9993; train_gene_expr_recon_loss: 2475420.1475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34353.7082; train_global_loss: 4276730.0943; train_optim_loss: 4276730.0943; val_kl_reg_loss: 28605.5094; val_edge_recon_loss: 815326.1055; val_cat_covariates_contrastive_loss: 950910.2449; val_gene_expr_recon_loss: 2301196.3289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29908.4785; val_global_loss: 4125946.6700; val_optim_loss: 4125946.6700
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9302; val_auprc_score: 0.9844; val_best_acc_score: 0.9239; val_best_f1_score: 0.9564; train_kl_reg_loss: 27658.8032; train_edge_recon_loss: 785649.4473; train_cat_covariates_contrastive_loss: 953257.0084; train_gene_expr_recon_loss: 2231654.0830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29583.5077; train_global_loss: 4027802.8519; train_optim_loss: 4027802.8519; val_kl_reg_loss: 26977.4974; val_edge_recon_loss: 811613.6641; val_cat_covariates_contrastive_loss: 955221.2940; val_gene_expr_recon_loss: 2196518.6599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29688.1895; val_global_loss: 4020019.3512; val_optim_loss: 4020019.3512
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9323; val_auprc_score: 0.9854; val_best_acc_score: 0.9229; val_best_f1_score: 0.9557; train_kl_reg_loss: 27868.2687; train_edge_recon_loss: 788404.5565; train_cat_covariates_contrastive_loss: 953734.5574; train_gene_expr_recon_loss: 2163893.4338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29494.7042; train_global_loss: 3963395.5222; train_optim_loss: 3963395.5222; val_kl_reg_loss: 26241.1964; val_edge_recon_loss: 810863.5099; val_cat_covariates_contrastive_loss: 959571.8783; val_gene_expr_recon_loss: 2147812.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29641.5176; val_global_loss: 3974130.7166; val_optim_loss: 3974130.7166
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9317; val_auprc_score: 0.9841; val_best_acc_score: 0.9289; val_best_f1_score: 0.9590; train_kl_reg_loss: 26450.8135; train_edge_recon_loss: 788391.4454; train_cat_covariates_contrastive_loss: 952455.1683; train_gene_expr_recon_loss: 2346718.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30338.5994; train_global_loss: 4144354.5801; train_optim_loss: 4144354.5801; val_kl_reg_loss: 28068.4033; val_edge_recon_loss: 825193.8033; val_cat_covariates_contrastive_loss: 953938.4537; val_gene_expr_recon_loss: 2224496.9251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29580.9902; val_global_loss: 4061278.5789; val_optim_loss: 4061278.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9294; val_auprc_score: 0.9837; val_best_acc_score: 0.9268; val_best_f1_score: 0.9580; train_kl_reg_loss: 28564.9662; train_edge_recon_loss: 782944.8430; train_cat_covariates_contrastive_loss: 953504.4344; train_gene_expr_recon_loss: 2189582.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16092.8908; train_global_loss: 3970689.2376; train_optim_loss: 3970689.2376; val_kl_reg_loss: 29038.2559; val_edge_recon_loss: 820042.6705; val_cat_covariates_contrastive_loss: 953636.4340; val_gene_expr_recon_loss: 2190719.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15934.3467; val_global_loss: 4009370.9970; val_optim_loss: 4009370.9970
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9274; val_auprc_score: 0.9827; val_best_acc_score: 0.9274; val_best_f1_score: 0.9583; train_kl_reg_loss: 28652.0648; train_edge_recon_loss: 783801.2387; train_cat_covariates_contrastive_loss: 953703.7832; train_gene_expr_recon_loss: 2167713.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15881.1881; train_global_loss: 3949751.8509; train_optim_loss: 3949751.8509; val_kl_reg_loss: 29366.3012; val_edge_recon_loss: 819575.2065; val_cat_covariates_contrastive_loss: 952196.4557; val_gene_expr_recon_loss: 2165953.2799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15770.7119; val_global_loss: 3982861.9949; val_optim_loss: 3982861.9949
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9292; val_auprc_score: 0.9834; val_best_acc_score: 0.9284; val_best_f1_score: 0.9590; train_kl_reg_loss: 28715.5597; train_edge_recon_loss: 786641.7354; train_cat_covariates_contrastive_loss: 953861.4551; train_gene_expr_recon_loss: 2142771.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15758.3564; train_global_loss: 3927748.1700; train_optim_loss: 3927748.1700; val_kl_reg_loss: 28549.4228; val_edge_recon_loss: 816026.1812; val_cat_covariates_contrastive_loss: 954020.4744; val_gene_expr_recon_loss: 2142397.1888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15730.8965; val_global_loss: 3956724.2642; val_optim_loss: 3956724.2642
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9277; val_auprc_score: 0.9839; val_best_acc_score: 0.9234; val_best_f1_score: 0.9562; train_kl_reg_loss: 23325.4061; train_edge_recon_loss: 785950.1005; train_cat_covariates_contrastive_loss: 953248.1366; train_gene_expr_recon_loss: 1997471.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13940.7006; train_global_loss: 3773936.0655; train_optim_loss: 3773936.0655; val_kl_reg_loss: 15557.0790; val_edge_recon_loss: 815326.5878; val_cat_covariates_contrastive_loss: 953831.9752; val_gene_expr_recon_loss: 1973802.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12558.0938; val_global_loss: 3771076.2004; val_optim_loss: 3771076.2004
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9240; val_auprc_score: 0.9824; val_best_acc_score: 0.9243; val_best_f1_score: 0.9567; train_kl_reg_loss: 21121.3094; train_edge_recon_loss: 784152.7802; train_cat_covariates_contrastive_loss: 952112.7355; train_gene_expr_recon_loss: 1952375.2001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12236.1419; train_global_loss: 3721998.1654; train_optim_loss: 3721998.1654; val_kl_reg_loss: 16907.0421; val_edge_recon_loss: 822362.7581; val_cat_covariates_contrastive_loss: 951591.8133; val_gene_expr_recon_loss: 1949402.4033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12171.2852; val_global_loss: 3752435.2642; val_optim_loss: 3752435.2642
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9252; val_auprc_score: 0.9830; val_best_acc_score: 0.9252; val_best_f1_score: 0.9572; train_kl_reg_loss: 20380.3785; train_edge_recon_loss: 787317.8606; train_cat_covariates_contrastive_loss: 951594.7120; train_gene_expr_recon_loss: 1930336.8547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12109.5375; train_global_loss: 3701739.3423; train_optim_loss: 3701739.3423; val_kl_reg_loss: 17613.9650; val_edge_recon_loss: 809612.6468; val_cat_covariates_contrastive_loss: 951952.2895; val_gene_expr_recon_loss: 1930268.9261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12150.5684; val_global_loss: 3721598.3259; val_optim_loss: 3721598.3259
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9273; val_auprc_score: 0.9836; val_best_acc_score: 0.9252; val_best_f1_score: 0.9572; train_kl_reg_loss: 20063.0042; train_edge_recon_loss: 784525.7028; train_cat_covariates_contrastive_loss: 951483.8990; train_gene_expr_recon_loss: 1914286.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12100.7344; train_global_loss: 3682459.6745; train_optim_loss: 3682459.6745; val_kl_reg_loss: 17846.7169; val_edge_recon_loss: 814848.5283; val_cat_covariates_contrastive_loss: 952332.1220; val_gene_expr_recon_loss: 1915678.6847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12160.6514; val_global_loss: 3712866.7905; val_optim_loss: 3712866.7905
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9249; val_auprc_score: 0.9826; val_best_acc_score: 0.9252; val_best_f1_score: 0.9571; train_kl_reg_loss: 19820.3966; train_edge_recon_loss: 783396.7556; train_cat_covariates_contrastive_loss: 951310.0188; train_gene_expr_recon_loss: 1902467.3769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12097.8968; train_global_loss: 3669092.4433; train_optim_loss: 3669092.4433; val_kl_reg_loss: 18506.9337; val_edge_recon_loss: 816824.1607; val_cat_covariates_contrastive_loss: 950597.8201; val_gene_expr_recon_loss: 1903448.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12045.8779; val_global_loss: 3701423.1174; val_optim_loss: 3701423.1174
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9247; val_auprc_score: 0.9824; val_best_acc_score: 0.9256; val_best_f1_score: 0.9574; train_kl_reg_loss: 19713.2537; train_edge_recon_loss: 785036.1337; train_cat_covariates_contrastive_loss: 951184.9435; train_gene_expr_recon_loss: 1891445.6730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12100.4935; train_global_loss: 3659480.5003; train_optim_loss: 3659480.5003; val_kl_reg_loss: 18222.0839; val_edge_recon_loss: 820640.6149; val_cat_covariates_contrastive_loss: 950816.1635; val_gene_expr_recon_loss: 1897354.5046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12103.9775; val_global_loss: 3699137.3603; val_optim_loss: 3699137.3603
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9273; val_auprc_score: 0.9829; val_best_acc_score: 0.9262; val_best_f1_score: 0.9576; train_kl_reg_loss: 19687.2788; train_edge_recon_loss: 782883.9843; train_cat_covariates_contrastive_loss: 951179.9506; train_gene_expr_recon_loss: 1885160.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12105.4178; train_global_loss: 3651016.7103; train_optim_loss: 3651016.7103; val_kl_reg_loss: 18339.8606; val_edge_recon_loss: 827898.4016; val_cat_covariates_contrastive_loss: 950702.8249; val_gene_expr_recon_loss: 1890024.6356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12050.9795; val_global_loss: 3699016.7136; val_optim_loss: 3699016.7136
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9248; val_auprc_score: 0.9827; val_best_acc_score: 0.9253; val_best_f1_score: 0.9572; train_kl_reg_loss: 19546.9987; train_edge_recon_loss: 784936.9779; train_cat_covariates_contrastive_loss: 951046.7200; train_gene_expr_recon_loss: 1877563.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12096.5242; train_global_loss: 3645190.5736; train_optim_loss: 3645190.5736; val_kl_reg_loss: 18598.4345; val_edge_recon_loss: 810719.2110; val_cat_covariates_contrastive_loss: 950336.3133; val_gene_expr_recon_loss: 1884763.9909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12096.4453; val_global_loss: 3676514.4453; val_optim_loss: 3676514.4453
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9290; val_auprc_score: 0.9835; val_best_acc_score: 0.9266; val_best_f1_score: 0.9578; train_kl_reg_loss: 19467.3018; train_edge_recon_loss: 786205.6551; train_cat_covariates_contrastive_loss: 950950.0249; train_gene_expr_recon_loss: 1873399.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12089.7875; train_global_loss: 3642112.5649; train_optim_loss: 3642112.5649; val_kl_reg_loss: 18516.5774; val_edge_recon_loss: 815573.2670; val_cat_covariates_contrastive_loss: 950893.2634; val_gene_expr_recon_loss: 1878030.8897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12001.4824; val_global_loss: 3675015.5051; val_optim_loss: 3675015.5051
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9289; val_auprc_score: 0.9838; val_best_acc_score: 0.9269; val_best_f1_score: 0.9581; train_kl_reg_loss: 19318.3900; train_edge_recon_loss: 783862.9624; train_cat_covariates_contrastive_loss: 950853.7557; train_gene_expr_recon_loss: 1867435.8210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12089.0787; train_global_loss: 3633560.0089; train_optim_loss: 3633560.0089; val_kl_reg_loss: 18176.0094; val_edge_recon_loss: 812743.7920; val_cat_covariates_contrastive_loss: 951528.2115; val_gene_expr_recon_loss: 1872429.7743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12127.1768; val_global_loss: 3667005.0405; val_optim_loss: 3667005.0405
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9277; val_auprc_score: 0.9833; val_best_acc_score: 0.9265; val_best_f1_score: 0.9577; train_kl_reg_loss: 19312.5305; train_edge_recon_loss: 786570.5431; train_cat_covariates_contrastive_loss: 950738.3321; train_gene_expr_recon_loss: 1863672.1607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12090.5297; train_global_loss: 3632384.0965; train_optim_loss: 3632384.0965; val_kl_reg_loss: 18626.8307; val_edge_recon_loss: 818088.4582; val_cat_covariates_contrastive_loss: 950734.4233; val_gene_expr_recon_loss: 1870297.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12133.9971; val_global_loss: 3669880.7409; val_optim_loss: 3669880.7409
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9270; val_auprc_score: 0.9833; val_best_acc_score: 0.9251; val_best_f1_score: 0.9571; train_kl_reg_loss: 19248.1993; train_edge_recon_loss: 784148.3530; train_cat_covariates_contrastive_loss: 950708.4896; train_gene_expr_recon_loss: 1860046.9693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12106.0607; train_global_loss: 3626258.0713; train_optim_loss: 3626258.0713; val_kl_reg_loss: 18714.9327; val_edge_recon_loss: 813048.9360; val_cat_covariates_contrastive_loss: 950979.3269; val_gene_expr_recon_loss: 1867127.2864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12156.4375; val_global_loss: 3662026.9757; val_optim_loss: 3662026.9757
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9285; val_auprc_score: 0.9836; val_best_acc_score: 0.9259; val_best_f1_score: 0.9576; train_kl_reg_loss: 19172.9076; train_edge_recon_loss: 784131.5342; train_cat_covariates_contrastive_loss: 950532.6070; train_gene_expr_recon_loss: 1856823.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12130.8556; train_global_loss: 3622791.7766; train_optim_loss: 3622791.7766; val_kl_reg_loss: 18298.5465; val_edge_recon_loss: 817022.3570; val_cat_covariates_contrastive_loss: 951372.3623; val_gene_expr_recon_loss: 1863317.8269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12110.6621; val_global_loss: 3662121.8269; val_optim_loss: 3662121.8269
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9294; val_auprc_score: 0.9839; val_best_acc_score: 0.9280; val_best_f1_score: 0.9588; train_kl_reg_loss: 19120.3667; train_edge_recon_loss: 783971.4479; train_cat_covariates_contrastive_loss: 950552.6984; train_gene_expr_recon_loss: 1854049.3079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12134.9045; train_global_loss: 3619828.7234; train_optim_loss: 3619828.7234; val_kl_reg_loss: 18413.0283; val_edge_recon_loss: 810484.1149; val_cat_covariates_contrastive_loss: 951765.2447; val_gene_expr_recon_loss: 1859584.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12143.7344; val_global_loss: 3652390.3988; val_optim_loss: 3652390.3988
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9283; val_auprc_score: 0.9835; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 19089.0517; train_edge_recon_loss: 781932.8509; train_cat_covariates_contrastive_loss: 950470.4417; train_gene_expr_recon_loss: 1851101.8097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12130.5828; train_global_loss: 3614724.7407; train_optim_loss: 3614724.7407; val_kl_reg_loss: 18366.2147; val_edge_recon_loss: 814929.8307; val_cat_covariates_contrastive_loss: 950641.3469; val_gene_expr_recon_loss: 1857921.6609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12153.8105; val_global_loss: 3654012.7935; val_optim_loss: 3654012.7935
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9262; val_auprc_score: 0.9825; val_best_acc_score: 0.9267; val_best_f1_score: 0.9579; train_kl_reg_loss: 19020.9217; train_edge_recon_loss: 784756.1620; train_cat_covariates_contrastive_loss: 950422.3886; train_gene_expr_recon_loss: 1848518.1592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12142.7348; train_global_loss: 3614860.3681; train_optim_loss: 3614860.3681; val_kl_reg_loss: 18990.4032; val_edge_recon_loss: 820117.6738; val_cat_covariates_contrastive_loss: 949605.5501; val_gene_expr_recon_loss: 1856360.8072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12136.4473; val_global_loss: 3657210.9322; val_optim_loss: 3657210.9322
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9282; val_auprc_score: 0.9836; val_best_acc_score: 0.9273; val_best_f1_score: 0.9585; train_kl_reg_loss: 19055.0732; train_edge_recon_loss: 783208.4411; train_cat_covariates_contrastive_loss: 950394.5406; train_gene_expr_recon_loss: 1846274.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12160.4930; train_global_loss: 3611092.9020; train_optim_loss: 3611092.9020; val_kl_reg_loss: 18378.5714; val_edge_recon_loss: 810486.8284; val_cat_covariates_contrastive_loss: 951161.9421; val_gene_expr_recon_loss: 1852633.9074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12194.0273; val_global_loss: 3644855.2530; val_optim_loss: 3644855.2530
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9261; val_auprc_score: 0.9826; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 18990.2390; train_edge_recon_loss: 783075.8870; train_cat_covariates_contrastive_loss: 950275.2005; train_gene_expr_recon_loss: 1843936.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12184.4578; train_global_loss: 3608462.4358; train_optim_loss: 3608462.4358; val_kl_reg_loss: 18852.0225; val_edge_recon_loss: 811473.1235; val_cat_covariates_contrastive_loss: 949372.3816; val_gene_expr_recon_loss: 1851585.5506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12186.2168; val_global_loss: 3643469.3350; val_optim_loss: 3643469.3350
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9270; val_auprc_score: 0.9832; val_best_acc_score: 0.9254; val_best_f1_score: 0.9572; train_kl_reg_loss: 18961.8464; train_edge_recon_loss: 784849.1894; train_cat_covariates_contrastive_loss: 950349.6168; train_gene_expr_recon_loss: 1841917.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12169.8648; train_global_loss: 3608248.2701; train_optim_loss: 3608248.2701; val_kl_reg_loss: 18324.7476; val_edge_recon_loss: 813055.2634; val_cat_covariates_contrastive_loss: 949980.0936; val_gene_expr_recon_loss: 1850771.8669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12164.7168; val_global_loss: 3644296.7227; val_optim_loss: 3644296.7227
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9296; val_auprc_score: 0.9840; val_best_acc_score: 0.9273; val_best_f1_score: 0.9584; train_kl_reg_loss: 18821.0306; train_edge_recon_loss: 785108.4178; train_cat_covariates_contrastive_loss: 950207.4724; train_gene_expr_recon_loss: 1840684.9555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12201.2604; train_global_loss: 3607023.1397; train_optim_loss: 3607023.1397; val_kl_reg_loss: 18227.6927; val_edge_recon_loss: 804296.6012; val_cat_covariates_contrastive_loss: 950957.5205; val_gene_expr_recon_loss: 1847157.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12205.2998; val_global_loss: 3632844.7217; val_optim_loss: 3632844.7217
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9268; val_auprc_score: 0.9828; val_best_acc_score: 0.9275; val_best_f1_score: 0.9584; train_kl_reg_loss: 18898.6290; train_edge_recon_loss: 782688.6683; train_cat_covariates_contrastive_loss: 950152.8075; train_gene_expr_recon_loss: 1839253.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12177.2753; train_global_loss: 3603171.1238; train_optim_loss: 3603171.1238; val_kl_reg_loss: 19015.5221; val_edge_recon_loss: 820370.1592; val_cat_covariates_contrastive_loss: 949360.2151; val_gene_expr_recon_loss: 1847307.5187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12167.5176; val_global_loss: 3648220.9150; val_optim_loss: 3648220.9150
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9289; val_auprc_score: 0.9837; val_best_acc_score: 0.9268; val_best_f1_score: 0.9580; train_kl_reg_loss: 18810.5092; train_edge_recon_loss: 785514.6479; train_cat_covariates_contrastive_loss: 950094.2676; train_gene_expr_recon_loss: 1837677.6593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12231.2118; train_global_loss: 3604328.2939; train_optim_loss: 3604328.2939; val_kl_reg_loss: 18717.5292; val_edge_recon_loss: 815513.0554; val_cat_covariates_contrastive_loss: 949926.5873; val_gene_expr_recon_loss: 1845383.8274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12203.7451; val_global_loss: 3641744.7632; val_optim_loss: 3641744.7632
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9308; val_auprc_score: 0.9839; val_best_acc_score: 0.9273; val_best_f1_score: 0.9582; train_kl_reg_loss: 18761.1896; train_edge_recon_loss: 782786.4001; train_cat_covariates_contrastive_loss: 950068.7182; train_gene_expr_recon_loss: 1835936.8489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12238.3505; train_global_loss: 3599791.5072; train_optim_loss: 3599791.5072; val_kl_reg_loss: 18282.9955; val_edge_recon_loss: 818072.9254; val_cat_covariates_contrastive_loss: 949863.1822; val_gene_expr_recon_loss: 1843478.7419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12247.7686; val_global_loss: 3641945.5951; val_optim_loss: 3641945.5951
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9293; val_auprc_score: 0.9837; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 18727.2950; train_edge_recon_loss: 778768.8915; train_cat_covariates_contrastive_loss: 949943.3582; train_gene_expr_recon_loss: 1834814.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12237.5861; train_global_loss: 3594491.5468; train_optim_loss: 3594491.5468; val_kl_reg_loss: 18290.2185; val_edge_recon_loss: 810397.2313; val_cat_covariates_contrastive_loss: 950400.4572; val_gene_expr_recon_loss: 1843895.2606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12268.5469; val_global_loss: 3635251.6630; val_optim_loss: 3635251.6630

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9299; val_auprc_score: 0.9838; val_best_acc_score: 0.9288; val_best_f1_score: 0.9592; train_kl_reg_loss: 18646.6837; train_edge_recon_loss: 783888.9948; train_cat_covariates_contrastive_loss: 949886.2527; train_gene_expr_recon_loss: 1832648.2933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11062.3263; train_global_loss: 3596132.5487; train_optim_loss: 3596132.5487; val_kl_reg_loss: 18442.5395; val_edge_recon_loss: 804343.3229; val_cat_covariates_contrastive_loss: 950035.4236; val_gene_expr_recon_loss: 1841130.5496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11039.8828; val_global_loss: 3624991.8401; val_optim_loss: 3624991.8401
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9282; val_auprc_score: 0.9834; val_best_acc_score: 0.9275; val_best_f1_score: 0.9584; train_kl_reg_loss: 18694.2491; train_edge_recon_loss: 780855.9228; train_cat_covariates_contrastive_loss: 949818.3900; train_gene_expr_recon_loss: 1832449.0424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11027.9276; train_global_loss: 3592845.5343; train_optim_loss: 3592845.5343; val_kl_reg_loss: 18304.1279; val_edge_recon_loss: 812863.4254; val_cat_covariates_contrastive_loss: 949937.1288; val_gene_expr_recon_loss: 1840897.7571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11023.6338; val_global_loss: 3633026.1923; val_optim_loss: 3633026.1923
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9298; val_auprc_score: 0.9840; val_best_acc_score: 0.9277; val_best_f1_score: 0.9586; train_kl_reg_loss: 18676.4986; train_edge_recon_loss: 786723.9473; train_cat_covariates_contrastive_loss: 949848.2576; train_gene_expr_recon_loss: 1832392.9646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11029.2240; train_global_loss: 3598670.8938; train_optim_loss: 3598670.8938; val_kl_reg_loss: 18426.9213; val_edge_recon_loss: 806834.9975; val_cat_covariates_contrastive_loss: 949368.9266; val_gene_expr_recon_loss: 1841187.2540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11035.6670; val_global_loss: 3626853.8532; val_optim_loss: 3626853.8532
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9306; val_auprc_score: 0.9838; val_best_acc_score: 0.9290; val_best_f1_score: 0.9593; train_kl_reg_loss: 18684.2346; train_edge_recon_loss: 782620.7200; train_cat_covariates_contrastive_loss: 949783.8179; train_gene_expr_recon_loss: 1831712.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11027.3466; train_global_loss: 3593828.1849; train_optim_loss: 3593828.1849; val_kl_reg_loss: 18399.0766; val_edge_recon_loss: 819136.1442; val_cat_covariates_contrastive_loss: 949711.5433; val_gene_expr_recon_loss: 1837847.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11026.3506; val_global_loss: 3636120.7976; val_optim_loss: 3636120.7976
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9279; val_auprc_score: 0.9834; val_best_acc_score: 0.9276; val_best_f1_score: 0.9586; train_kl_reg_loss: 18696.1771; train_edge_recon_loss: 780811.5189; train_cat_covariates_contrastive_loss: 949843.3774; train_gene_expr_recon_loss: 1832026.7312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11034.8082; train_global_loss: 3592412.6124; train_optim_loss: 3592412.6124; val_kl_reg_loss: 18375.7857; val_edge_recon_loss: 808647.4532; val_cat_covariates_contrastive_loss: 949784.8165; val_gene_expr_recon_loss: 1839641.3133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11021.4746; val_global_loss: 3627470.8664; val_optim_loss: 3627470.8664

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9289; val_auprc_score: 0.9837; val_best_acc_score: 0.9271; val_best_f1_score: 0.9582; train_kl_reg_loss: 18667.0980; train_edge_recon_loss: 782742.1467; train_cat_covariates_contrastive_loss: 949943.1512; train_gene_expr_recon_loss: 1831355.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10894.4527; train_global_loss: 3593602.6179; train_optim_loss: 3593602.6179; val_kl_reg_loss: 18358.6829; val_edge_recon_loss: 810387.3694; val_cat_covariates_contrastive_loss: 950254.0891; val_gene_expr_recon_loss: 1840345.6437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10889.9473; val_global_loss: 3630235.7844; val_optim_loss: 3630235.7844
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9297; val_auprc_score: 0.9840; val_best_acc_score: 0.9281; val_best_f1_score: 0.9588; train_kl_reg_loss: 18646.3648; train_edge_recon_loss: 781958.1455; train_cat_covariates_contrastive_loss: 949833.1263; train_gene_expr_recon_loss: 1832040.4418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10890.9602; train_global_loss: 3593369.0358; train_optim_loss: 3593369.0358; val_kl_reg_loss: 18335.8775; val_edge_recon_loss: 807290.9074; val_cat_covariates_contrastive_loss: 950248.0681; val_gene_expr_recon_loss: 1841930.7328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10890.7715; val_global_loss: 3628696.3239; val_optim_loss: 3628696.3239
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9292; val_auprc_score: 0.9835; val_best_acc_score: 0.9283; val_best_f1_score: 0.9589; train_kl_reg_loss: 18670.7528; train_edge_recon_loss: 784764.5277; train_cat_covariates_contrastive_loss: 950046.3092; train_gene_expr_recon_loss: 1831400.3346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10889.9206; train_global_loss: 3595771.8442; train_optim_loss: 3595771.8442; val_kl_reg_loss: 18378.6198; val_edge_recon_loss: 816088.9395; val_cat_covariates_contrastive_loss: 950343.5445; val_gene_expr_recon_loss: 1839721.7657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10890.1113; val_global_loss: 3635422.8694; val_optim_loss: 3635422.8694
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9319; val_auprc_score: 0.9846; val_best_acc_score: 0.9286; val_best_f1_score: 0.9591; train_kl_reg_loss: 18658.3266; train_edge_recon_loss: 785090.1085; train_cat_covariates_contrastive_loss: 949864.7532; train_gene_expr_recon_loss: 1831437.0861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10891.5813; train_global_loss: 3595941.8606; train_optim_loss: 3595941.8606; val_kl_reg_loss: 18356.3681; val_edge_recon_loss: 807187.4620; val_cat_covariates_contrastive_loss: 950039.1174; val_gene_expr_recon_loss: 1839896.2783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10896.1924; val_global_loss: 3626375.4727; val_optim_loss: 3626375.4727

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 552 min 7 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9028
val AUPRC score: 0.9712
val best accuracy score: 0.9233
val best F1 score: 0.9560
val target rna MSE score: 0.4557
val source rna MSE score: 0.2556
Val cat covariate0 mean sim diff: -0.0012
Val cat covariate1 mean sim diff: -0.0567
Val cat covariate2 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
