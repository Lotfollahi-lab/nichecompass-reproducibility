[True, False, True]
Run timestamp: 29092023_122437_201.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_201']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8919; val_auprc_score: 0.9759; val_best_acc_score: 0.8998; val_best_f1_score: 0.9431; train_kl_reg_loss: 17870.0076; train_edge_recon_loss: 835001.6850; train_cat_covariates_contrastive_loss: 947423.8846; train_gene_expr_recon_loss: 2908968.8302; train_masked_gp_l1_reg_loss: 29500.0923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103487.3389; train_global_loss: 4842251.8450; train_optim_loss: 4842251.8450; val_kl_reg_loss: 15075.6710; val_edge_recon_loss: 830598.7219; val_cat_covariates_contrastive_loss: 944122.2963; val_gene_expr_recon_loss: 2777323.2611; val_masked_gp_l1_reg_loss: 19741.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23605.3887; val_global_loss: 4610467.4676; val_optim_loss: 4610467.4676
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9099; val_auprc_score: 0.9790; val_best_acc_score: 0.9134; val_best_f1_score: 0.9505; train_kl_reg_loss: 15929.6011; train_edge_recon_loss: 797844.6688; train_cat_covariates_contrastive_loss: 945609.2898; train_gene_expr_recon_loss: 2710458.6812; train_masked_gp_l1_reg_loss: 20034.7430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23749.2087; train_global_loss: 4513626.1819; train_optim_loss: 4513626.1819; val_kl_reg_loss: 18498.8684; val_edge_recon_loss: 832584.2950; val_cat_covariates_contrastive_loss: 949166.3920; val_gene_expr_recon_loss: 2618909.5850; val_masked_gp_l1_reg_loss: 20704.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24566.3613; val_global_loss: 4464430.1417; val_optim_loss: 4464430.1417
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9126; val_auprc_score: 0.9791; val_best_acc_score: 0.9166; val_best_f1_score: 0.9522; train_kl_reg_loss: 20076.8968; train_edge_recon_loss: 794002.6266; train_cat_covariates_contrastive_loss: 949459.5902; train_gene_expr_recon_loss: 2549035.8478; train_masked_gp_l1_reg_loss: 21696.6129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25125.2986; train_global_loss: 4359396.8760; train_optim_loss: 4359396.8760; val_kl_reg_loss: 21668.0132; val_edge_recon_loss: 831223.1053; val_cat_covariates_contrastive_loss: 948614.6404; val_gene_expr_recon_loss: 2514155.7136; val_masked_gp_l1_reg_loss: 22741.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25791.5410; val_global_loss: 4364194.4676; val_optim_loss: 4364194.4676
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9223; val_auprc_score: 0.9816; val_best_acc_score: 0.9218; val_best_f1_score: 0.9550; train_kl_reg_loss: 21699.1773; train_edge_recon_loss: 792094.8969; train_cat_covariates_contrastive_loss: 949794.5435; train_gene_expr_recon_loss: 2492934.5505; train_masked_gp_l1_reg_loss: 23741.9295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26213.7657; train_global_loss: 4306478.8700; train_optim_loss: 4306478.8700; val_kl_reg_loss: 22825.2921; val_edge_recon_loss: 819954.6045; val_cat_covariates_contrastive_loss: 950190.8773; val_gene_expr_recon_loss: 2485286.2379; val_masked_gp_l1_reg_loss: 24645.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26020.2402; val_global_loss: 4328923.0081; val_optim_loss: 4328923.0081
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9241; val_auprc_score: 0.9812; val_best_acc_score: 0.9254; val_best_f1_score: 0.9570; train_kl_reg_loss: 22643.7222; train_edge_recon_loss: 788147.0303; train_cat_covariates_contrastive_loss: 950039.8012; train_gene_expr_recon_loss: 2469079.7277; train_masked_gp_l1_reg_loss: 25486.9017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26583.1240; train_global_loss: 4281980.3064; train_optim_loss: 4281980.3064; val_kl_reg_loss: 23491.5536; val_edge_recon_loss: 827479.0377; val_cat_covariates_contrastive_loss: 948755.5369; val_gene_expr_recon_loss: 2466230.2611; val_masked_gp_l1_reg_loss: 25946.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26657.1855; val_global_loss: 4318559.9545; val_optim_loss: 4318559.9545
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9279; val_auprc_score: 0.9824; val_best_acc_score: 0.9276; val_best_f1_score: 0.9584; train_kl_reg_loss: 23450.3413; train_edge_recon_loss: 786898.3397; train_cat_covariates_contrastive_loss: 950408.6691; train_gene_expr_recon_loss: 2454750.2005; train_masked_gp_l1_reg_loss: 26565.4748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26829.2696; train_global_loss: 4268902.2965; train_optim_loss: 4268902.2965; val_kl_reg_loss: 24364.0705; val_edge_recon_loss: 818106.8889; val_cat_covariates_contrastive_loss: 949578.7055; val_gene_expr_recon_loss: 2451297.1589; val_masked_gp_l1_reg_loss: 27082.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27039.6953; val_global_loss: 4297468.8563; val_optim_loss: 4297468.8563
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9348; val_auprc_score: 0.9846; val_best_acc_score: 0.9285; val_best_f1_score: 0.9589; train_kl_reg_loss: 24205.9775; train_edge_recon_loss: 786712.1402; train_cat_covariates_contrastive_loss: 950734.4275; train_gene_expr_recon_loss: 2442778.4298; train_masked_gp_l1_reg_loss: 27381.5259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27264.3545; train_global_loss: 4259076.8572; train_optim_loss: 4259076.8572; val_kl_reg_loss: 23813.8163; val_edge_recon_loss: 815655.1032; val_cat_covariates_contrastive_loss: 953325.2285; val_gene_expr_recon_loss: 2442128.0830; val_masked_gp_l1_reg_loss: 27651.6348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27446.1660; val_global_loss: 4290019.8532; val_optim_loss: 4290019.8532
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9306; val_auprc_score: 0.9834; val_best_acc_score: 0.9245; val_best_f1_score: 0.9565; train_kl_reg_loss: 24974.2975; train_edge_recon_loss: 789796.5129; train_cat_covariates_contrastive_loss: 951054.9274; train_gene_expr_recon_loss: 2430951.8818; train_masked_gp_l1_reg_loss: 27871.2263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27984.6993; train_global_loss: 4252633.5467; train_optim_loss: 4252633.5467; val_kl_reg_loss: 25369.9561; val_edge_recon_loss: 816444.9291; val_cat_covariates_contrastive_loss: 950175.6619; val_gene_expr_recon_loss: 2431874.2439; val_masked_gp_l1_reg_loss: 28016.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28397.8125; val_global_loss: 4280278.7429; val_optim_loss: 4280278.7429
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9335; val_auprc_score: 0.9841; val_best_acc_score: 0.9307; val_best_f1_score: 0.9601; train_kl_reg_loss: 25700.6973; train_edge_recon_loss: 784894.7404; train_cat_covariates_contrastive_loss: 951428.3520; train_gene_expr_recon_loss: 2420510.1340; train_masked_gp_l1_reg_loss: 28331.2480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28731.3853; train_global_loss: 4239596.5531; train_optim_loss: 4239596.5531; val_kl_reg_loss: 25797.7651; val_edge_recon_loss: 809252.2829; val_cat_covariates_contrastive_loss: 951136.8603; val_gene_expr_recon_loss: 2419483.0769; val_masked_gp_l1_reg_loss: 28565.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29252.2676; val_global_loss: 4263487.5132; val_optim_loss: 4263487.5132
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9290; val_auprc_score: 0.9826; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 26917.3096; train_edge_recon_loss: 785841.2715; train_cat_covariates_contrastive_loss: 951813.0072; train_gene_expr_recon_loss: 2412765.7834; train_masked_gp_l1_reg_loss: 28571.2108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29259.9230; train_global_loss: 4235168.5054; train_optim_loss: 4235168.5054; val_kl_reg_loss: 27303.9887; val_edge_recon_loss: 819977.0569; val_cat_covariates_contrastive_loss: 951033.6822; val_gene_expr_recon_loss: 2414158.0040; val_masked_gp_l1_reg_loss: 28653.3730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29275.7734; val_global_loss: 4270402.0921; val_optim_loss: 4270402.0921
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9277; val_auprc_score: 0.9820; val_best_acc_score: 0.9289; val_best_f1_score: 0.9592; train_kl_reg_loss: 27213.9283; train_edge_recon_loss: 786637.0017; train_cat_covariates_contrastive_loss: 951864.6228; train_gene_expr_recon_loss: 2405506.8211; train_masked_gp_l1_reg_loss: 28689.1051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29392.0263; train_global_loss: 4229303.4963; train_optim_loss: 4229303.4963; val_kl_reg_loss: 29306.0194; val_edge_recon_loss: 817299.0461; val_cat_covariates_contrastive_loss: 949207.9927; val_gene_expr_recon_loss: 2408274.8026; val_masked_gp_l1_reg_loss: 28645.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29553.7461; val_global_loss: 4262286.9089; val_optim_loss: 4262286.9089
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9314; val_auprc_score: 0.9832; val_best_acc_score: 0.9283; val_best_f1_score: 0.9587; train_kl_reg_loss: 27604.5131; train_edge_recon_loss: 787234.5024; train_cat_covariates_contrastive_loss: 951900.7042; train_gene_expr_recon_loss: 2398027.3863; train_masked_gp_l1_reg_loss: 28939.9706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29963.9595; train_global_loss: 4223671.0323; train_optim_loss: 4223671.0323; val_kl_reg_loss: 28735.2704; val_edge_recon_loss: 811732.7242; val_cat_covariates_contrastive_loss: 949455.8107; val_gene_expr_recon_loss: 2399153.8107; val_masked_gp_l1_reg_loss: 28972.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30132.5664; val_global_loss: 4248182.7368; val_optim_loss: 4248182.7368
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9316; val_auprc_score: 0.9832; val_best_acc_score: 0.9278; val_best_f1_score: 0.9583; train_kl_reg_loss: 28053.2122; train_edge_recon_loss: 785080.3215; train_cat_covariates_contrastive_loss: 952190.4521; train_gene_expr_recon_loss: 2395383.9769; train_masked_gp_l1_reg_loss: 29180.7988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30404.2156; train_global_loss: 4220292.9763; train_optim_loss: 4220292.9763; val_kl_reg_loss: 28650.8518; val_edge_recon_loss: 814366.9127; val_cat_covariates_contrastive_loss: 951481.3039; val_gene_expr_recon_loss: 2394743.8745; val_masked_gp_l1_reg_loss: 29010.2363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30773.7988; val_global_loss: 4249026.9808; val_optim_loss: 4249026.9808
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9347; val_auprc_score: 0.9836; val_best_acc_score: 0.9327; val_best_f1_score: 0.9612; train_kl_reg_loss: 28854.7099; train_edge_recon_loss: 788183.3186; train_cat_covariates_contrastive_loss: 952501.4392; train_gene_expr_recon_loss: 2391603.5734; train_masked_gp_l1_reg_loss: 29073.0382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30813.3210; train_global_loss: 4221029.3981; train_optim_loss: 4221029.3981; val_kl_reg_loss: 30347.4263; val_edge_recon_loss: 823074.4744; val_cat_covariates_contrastive_loss: 951877.1926; val_gene_expr_recon_loss: 2391654.4929; val_masked_gp_l1_reg_loss: 28910.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31243.1660; val_global_loss: 4257106.6781; val_optim_loss: 4257106.6781
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9373; val_auprc_score: 0.9849; val_best_acc_score: 0.9330; val_best_f1_score: 0.9614; train_kl_reg_loss: 29814.5643; train_edge_recon_loss: 783799.7108; train_cat_covariates_contrastive_loss: 952746.4563; train_gene_expr_recon_loss: 2389678.8944; train_masked_gp_l1_reg_loss: 29183.3629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30991.2124; train_global_loss: 4216214.1986; train_optim_loss: 4216214.1986; val_kl_reg_loss: 45187.3872; val_edge_recon_loss: 811063.3712; val_cat_covariates_contrastive_loss: 951692.6037; val_gene_expr_recon_loss: 2389289.5182; val_masked_gp_l1_reg_loss: 29217.7598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30801.3926; val_global_loss: 4257252.2480; val_optim_loss: 4257252.2480
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9387; val_auprc_score: 0.9851; val_best_acc_score: 0.9340; val_best_f1_score: 0.9620; train_kl_reg_loss: 32133.4561; train_edge_recon_loss: 791577.0386; train_cat_covariates_contrastive_loss: 953181.2574; train_gene_expr_recon_loss: 2481733.0706; train_masked_gp_l1_reg_loss: 85673.4654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31826.3972; train_global_loss: 4376124.6953; train_optim_loss: 4376124.6953; val_kl_reg_loss: 31097.9151; val_edge_recon_loss: 809355.3849; val_cat_covariates_contrastive_loss: 953515.5364; val_gene_expr_recon_loss: 2396046.3937; val_masked_gp_l1_reg_loss: 30833.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30992.7773; val_global_loss: 4251841.6437; val_optim_loss: 4251841.6437

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9377; val_auprc_score: 0.9850; val_best_acc_score: 0.9322; val_best_f1_score: 0.9609; train_kl_reg_loss: 31604.0944; train_edge_recon_loss: 784307.4789; train_cat_covariates_contrastive_loss: 952852.0276; train_gene_expr_recon_loss: 2387315.6019; train_masked_gp_l1_reg_loss: 21041.5959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17702.1047; train_global_loss: 4194822.9024; train_optim_loss: 4194822.9024; val_kl_reg_loss: 31916.8595; val_edge_recon_loss: 814823.1483; val_cat_covariates_contrastive_loss: 953383.1063; val_gene_expr_recon_loss: 2391256.8877; val_masked_gp_l1_reg_loss: 19981.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17547.7832; val_global_loss: 4228909.4150; val_optim_loss: 4228909.4150
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9367; val_auprc_score: 0.9842; val_best_acc_score: 0.9342; val_best_f1_score: 0.9621; train_kl_reg_loss: 31856.4895; train_edge_recon_loss: 783065.6223; train_cat_covariates_contrastive_loss: 952624.9469; train_gene_expr_recon_loss: 2382274.8030; train_masked_gp_l1_reg_loss: 19210.0933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17535.2543; train_global_loss: 4186567.2087; train_optim_loss: 4186567.2087; val_kl_reg_loss: 32164.0648; val_edge_recon_loss: 818087.3297; val_cat_covariates_contrastive_loss: 951642.2730; val_gene_expr_recon_loss: 2384055.4413; val_masked_gp_l1_reg_loss: 18708.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17496.4336; val_global_loss: 4222153.7318; val_optim_loss: 4222153.7318
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9403; val_auprc_score: 0.9854; val_best_acc_score: 0.9352; val_best_f1_score: 0.9627; train_kl_reg_loss: 31576.5409; train_edge_recon_loss: 785153.2327; train_cat_covariates_contrastive_loss: 952660.2312; train_gene_expr_recon_loss: 2378461.8742; train_masked_gp_l1_reg_loss: 18617.4168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17542.7502; train_global_loss: 4184012.0498; train_optim_loss: 4184012.0498; val_kl_reg_loss: 31314.9082; val_edge_recon_loss: 807966.7508; val_cat_covariates_contrastive_loss: 952697.7465; val_gene_expr_recon_loss: 2380693.6063; val_masked_gp_l1_reg_loss: 18581.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17545.9746; val_global_loss: 4208800.5192; val_optim_loss: 4208800.5192
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9375; val_auprc_score: 0.9844; val_best_acc_score: 0.9337; val_best_f1_score: 0.9618; train_kl_reg_loss: 31928.4672; train_edge_recon_loss: 785446.0762; train_cat_covariates_contrastive_loss: 952670.2412; train_gene_expr_recon_loss: 2375341.8119; train_masked_gp_l1_reg_loss: 18635.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17554.4549; train_global_loss: 4181576.1148; train_optim_loss: 4181576.1148; val_kl_reg_loss: 31710.2933; val_edge_recon_loss: 812274.3234; val_cat_covariates_contrastive_loss: 952132.9319; val_gene_expr_recon_loss: 2378784.0709; val_masked_gp_l1_reg_loss: 18693.6934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17547.5977; val_global_loss: 4211142.7743; val_optim_loss: 4211142.7743
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9403; val_auprc_score: 0.9853; val_best_acc_score: 0.9349; val_best_f1_score: 0.9625; train_kl_reg_loss: 31245.5976; train_edge_recon_loss: 782483.9633; train_cat_covariates_contrastive_loss: 952507.9046; train_gene_expr_recon_loss: 2372196.8952; train_masked_gp_l1_reg_loss: 18724.0429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17599.7883; train_global_loss: 4174758.1881; train_optim_loss: 4174758.1881; val_kl_reg_loss: 31323.3226; val_edge_recon_loss: 808506.3616; val_cat_covariates_contrastive_loss: 952183.3710; val_gene_expr_recon_loss: 2375394.7176; val_masked_gp_l1_reg_loss: 18763.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17623.9199; val_global_loss: 4203795.2702; val_optim_loss: 4203795.2702
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9386; val_auprc_score: 0.9847; val_best_acc_score: 0.9351; val_best_f1_score: 0.9624; train_kl_reg_loss: 31098.7080; train_edge_recon_loss: 782936.5403; train_cat_covariates_contrastive_loss: 952455.9604; train_gene_expr_recon_loss: 2370058.7979; train_masked_gp_l1_reg_loss: 18815.4441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17662.2355; train_global_loss: 4173027.6829; train_optim_loss: 4173027.6829; val_kl_reg_loss: 31205.3227; val_edge_recon_loss: 813552.1829; val_cat_covariates_contrastive_loss: 952113.7720; val_gene_expr_recon_loss: 2372298.4049; val_masked_gp_l1_reg_loss: 18881.9512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17661.8457; val_global_loss: 4205713.5547; val_optim_loss: 4205713.5547
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9383; val_auprc_score: 0.9847; val_best_acc_score: 0.9348; val_best_f1_score: 0.9625; train_kl_reg_loss: 30768.0216; train_edge_recon_loss: 786075.2521; train_cat_covariates_contrastive_loss: 952516.5687; train_gene_expr_recon_loss: 2368365.9411; train_masked_gp_l1_reg_loss: 18946.3486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17760.4917; train_global_loss: 4174432.6264; train_optim_loss: 4174432.6264; val_kl_reg_loss: 30959.5312; val_edge_recon_loss: 810547.4079; val_cat_covariates_contrastive_loss: 951001.0878; val_gene_expr_recon_loss: 2374051.8725; val_masked_gp_l1_reg_loss: 19032.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17792.2520; val_global_loss: 4203384.6123; val_optim_loss: 4203384.6123
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9387; val_auprc_score: 0.9846; val_best_acc_score: 0.9338; val_best_f1_score: 0.9618; train_kl_reg_loss: 30602.9863; train_edge_recon_loss: 779084.3442; train_cat_covariates_contrastive_loss: 952286.4694; train_gene_expr_recon_loss: 2367614.7019; train_masked_gp_l1_reg_loss: 19070.0032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17813.7281; train_global_loss: 4166472.2341; train_optim_loss: 4166472.2341; val_kl_reg_loss: 30533.5820; val_edge_recon_loss: 818817.7510; val_cat_covariates_contrastive_loss: 952789.3937; val_gene_expr_recon_loss: 2370875.5668; val_masked_gp_l1_reg_loss: 19128.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17902.4434; val_global_loss: 4210047.1488; val_optim_loss: 4210047.1488
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9396; val_auprc_score: 0.9849; val_best_acc_score: 0.9348; val_best_f1_score: 0.9624; train_kl_reg_loss: 30539.3253; train_edge_recon_loss: 782810.6382; train_cat_covariates_contrastive_loss: 952157.0814; train_gene_expr_recon_loss: 2366765.4831; train_masked_gp_l1_reg_loss: 19162.6429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17846.9095; train_global_loss: 4169282.0780; train_optim_loss: 4169282.0780; val_kl_reg_loss: 30219.6890; val_edge_recon_loss: 816057.5749; val_cat_covariates_contrastive_loss: 951268.7690; val_gene_expr_recon_loss: 2367477.4322; val_masked_gp_l1_reg_loss: 19245.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17880.2090; val_global_loss: 4202149.1002; val_optim_loss: 4202149.1002
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9249; val_auprc_score: 0.9822; val_best_acc_score: 0.9239; val_best_f1_score: 0.9564; train_kl_reg_loss: 26092.1676; train_edge_recon_loss: 787607.9041; train_cat_covariates_contrastive_loss: 952257.1314; train_gene_expr_recon_loss: 2119649.4521; train_masked_gp_l1_reg_loss: 17145.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16786.0066; train_global_loss: 3919538.5080; train_optim_loss: 3919538.5080; val_kl_reg_loss: 20271.1106; val_edge_recon_loss: 816643.1506; val_cat_covariates_contrastive_loss: 952118.0554; val_gene_expr_recon_loss: 2118263.5435; val_masked_gp_l1_reg_loss: 15882.0107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15512.9668; val_global_loss: 3938690.8634; val_optim_loss: 3938690.8634
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9277; val_auprc_score: 0.9824; val_best_acc_score: 0.9255; val_best_f1_score: 0.9572; train_kl_reg_loss: 23894.8103; train_edge_recon_loss: 784810.2058; train_cat_covariates_contrastive_loss: 950906.6129; train_gene_expr_recon_loss: 2111698.8726; train_masked_gp_l1_reg_loss: 15557.2837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15399.4093; train_global_loss: 3902267.1937; train_optim_loss: 3902267.1937; val_kl_reg_loss: 21152.1167; val_edge_recon_loss: 823688.8742; val_cat_covariates_contrastive_loss: 950877.4593; val_gene_expr_recon_loss: 2115109.2247; val_masked_gp_l1_reg_loss: 15442.2783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15354.2363; val_global_loss: 3941624.1680; val_optim_loss: 3941624.1680
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9267; val_auprc_score: 0.9823; val_best_acc_score: 0.9267; val_best_f1_score: 0.9579; train_kl_reg_loss: 23058.7741; train_edge_recon_loss: 787655.8104; train_cat_covariates_contrastive_loss: 950658.6564; train_gene_expr_recon_loss: 2108870.1252; train_masked_gp_l1_reg_loss: 15488.3882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15363.9285; train_global_loss: 3901095.6824; train_optim_loss: 3901095.6824; val_kl_reg_loss: 21500.3812; val_edge_recon_loss: 814699.3778; val_cat_covariates_contrastive_loss: 949844.0577; val_gene_expr_recon_loss: 2111657.2060; val_masked_gp_l1_reg_loss: 15550.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15418.8164; val_global_loss: 3928670.5253; val_optim_loss: 3928670.5253
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9294; val_auprc_score: 0.9827; val_best_acc_score: 0.9276; val_best_f1_score: 0.9584; train_kl_reg_loss: 22713.2417; train_edge_recon_loss: 785126.2117; train_cat_covariates_contrastive_loss: 950352.9548; train_gene_expr_recon_loss: 2107119.1808; train_masked_gp_l1_reg_loss: 15594.0215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15355.7335; train_global_loss: 3896261.3431; train_optim_loss: 3896261.3431; val_kl_reg_loss: 21966.2825; val_edge_recon_loss: 818597.4056; val_cat_covariates_contrastive_loss: 949659.3763; val_gene_expr_recon_loss: 2110350.0764; val_masked_gp_l1_reg_loss: 15644.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15337.8584; val_global_loss: 3931555.3937; val_optim_loss: 3931555.3937
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9304; val_auprc_score: 0.9831; val_best_acc_score: 0.9270; val_best_f1_score: 0.9580; train_kl_reg_loss: 22471.0459; train_edge_recon_loss: 785781.2262; train_cat_covariates_contrastive_loss: 950580.0087; train_gene_expr_recon_loss: 2105759.8518; train_masked_gp_l1_reg_loss: 15691.1389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15355.6974; train_global_loss: 3895638.9663; train_optim_loss: 3895638.9663; val_kl_reg_loss: 21587.5133; val_edge_recon_loss: 815493.9886; val_cat_covariates_contrastive_loss: 950612.3520; val_gene_expr_recon_loss: 2108950.5481; val_masked_gp_l1_reg_loss: 15730.3213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15448.3066; val_global_loss: 3927822.8968; val_optim_loss: 3927822.8968
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9321; val_auprc_score: 0.9835; val_best_acc_score: 0.9285; val_best_f1_score: 0.9589; train_kl_reg_loss: 24623.0429; train_edge_recon_loss: 783419.1809; train_cat_covariates_contrastive_loss: 950250.1536; train_gene_expr_recon_loss: 2102605.2277; train_masked_gp_l1_reg_loss: 15750.7889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15403.2529; train_global_loss: 3892051.6494; train_optim_loss: 3892051.6494; val_kl_reg_loss: 21440.4224; val_edge_recon_loss: 816776.8229; val_cat_covariates_contrastive_loss: 950246.9340; val_gene_expr_recon_loss: 2106234.0673; val_masked_gp_l1_reg_loss: 15688.8545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15385.2969; val_global_loss: 3925772.2480; val_optim_loss: 3925772.2480
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9320; val_auprc_score: 0.9840; val_best_acc_score: 0.9283; val_best_f1_score: 0.9589; train_kl_reg_loss: 22389.3848; train_edge_recon_loss: 779982.6901; train_cat_covariates_contrastive_loss: 950124.5829; train_gene_expr_recon_loss: 2100695.8787; train_masked_gp_l1_reg_loss: 15592.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15384.5344; train_global_loss: 3884169.1253; train_optim_loss: 3884169.1253; val_kl_reg_loss: 21443.5651; val_edge_recon_loss: 807385.4074; val_cat_covariates_contrastive_loss: 950666.2983; val_gene_expr_recon_loss: 2103189.6569; val_masked_gp_l1_reg_loss: 15518.0049; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15350.7617; val_global_loss: 3913553.6741; val_optim_loss: 3913553.6741
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9348; val_auprc_score: 0.9845; val_best_acc_score: 0.9288; val_best_f1_score: 0.9590; train_kl_reg_loss: 22105.7074; train_edge_recon_loss: 783291.0777; train_cat_covariates_contrastive_loss: 950135.7204; train_gene_expr_recon_loss: 2099368.5221; train_masked_gp_l1_reg_loss: 15561.8758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15408.0656; train_global_loss: 3885870.9678; train_optim_loss: 3885870.9678; val_kl_reg_loss: 21317.0113; val_edge_recon_loss: 810760.2586; val_cat_covariates_contrastive_loss: 951033.2249; val_gene_expr_recon_loss: 2103557.3978; val_masked_gp_l1_reg_loss: 15591.4443; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15435.5986; val_global_loss: 3917694.8947; val_optim_loss: 3917694.8947
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9319; val_auprc_score: 0.9835; val_best_acc_score: 0.9286; val_best_f1_score: 0.9589; train_kl_reg_loss: 22003.1391; train_edge_recon_loss: 782652.2740; train_cat_covariates_contrastive_loss: 950117.3430; train_gene_expr_recon_loss: 2089754.2061; train_masked_gp_l1_reg_loss: 15564.7308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15417.4550; train_global_loss: 3875509.1456; train_optim_loss: 3875509.1456; val_kl_reg_loss: 21672.0624; val_edge_recon_loss: 818870.7842; val_cat_covariates_contrastive_loss: 949185.4279; val_gene_expr_recon_loss: 2089407.6690; val_masked_gp_l1_reg_loss: 15528.9287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15479.5547; val_global_loss: 3910144.4383; val_optim_loss: 3910144.4383
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9337; val_auprc_score: 0.9843; val_best_acc_score: 0.9286; val_best_f1_score: 0.9591; train_kl_reg_loss: 21968.6109; train_edge_recon_loss: 782979.7880; train_cat_covariates_contrastive_loss: 949977.6973; train_gene_expr_recon_loss: 2085100.9670; train_masked_gp_l1_reg_loss: 15551.3122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15437.1988; train_global_loss: 3871015.5716; train_optim_loss: 3871015.5716; val_kl_reg_loss: 21511.4346; val_edge_recon_loss: 810604.1609; val_cat_covariates_contrastive_loss: 951342.5190; val_gene_expr_recon_loss: 2087996.0385; val_masked_gp_l1_reg_loss: 15590.6045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15410.2881; val_global_loss: 3902454.8988; val_optim_loss: 3902454.8988
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9362; val_auprc_score: 0.9850; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 21925.2755; train_edge_recon_loss: 781932.9925; train_cat_covariates_contrastive_loss: 950057.6308; train_gene_expr_recon_loss: 2083614.6503; train_masked_gp_l1_reg_loss: 15637.5767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15460.4052; train_global_loss: 3868628.5325; train_optim_loss: 3868628.5325; val_kl_reg_loss: 21359.1322; val_edge_recon_loss: 807078.0235; val_cat_covariates_contrastive_loss: 950970.0617; val_gene_expr_recon_loss: 2087167.5334; val_masked_gp_l1_reg_loss: 15695.5479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15510.9922; val_global_loss: 3897781.2480; val_optim_loss: 3897781.2480
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9329; val_auprc_score: 0.9836; val_best_acc_score: 0.9292; val_best_f1_score: 0.9592; train_kl_reg_loss: 21955.6618; train_edge_recon_loss: 782824.6377; train_cat_covariates_contrastive_loss: 949882.5301; train_gene_expr_recon_loss: 2082680.3339; train_masked_gp_l1_reg_loss: 15706.8798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15455.7179; train_global_loss: 3868505.7599; train_optim_loss: 3868505.7599; val_kl_reg_loss: 21753.1646; val_edge_recon_loss: 820353.5843; val_cat_covariates_contrastive_loss: 949213.9648; val_gene_expr_recon_loss: 2086928.7424; val_masked_gp_l1_reg_loss: 15762.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15492.0215; val_global_loss: 3909503.4534; val_optim_loss: 3909503.4534
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9357; val_auprc_score: 0.9847; val_best_acc_score: 0.9293; val_best_f1_score: 0.9594; train_kl_reg_loss: 21817.8227; train_edge_recon_loss: 783971.1536; train_cat_covariates_contrastive_loss: 949901.5943; train_gene_expr_recon_loss: 2081545.5193; train_masked_gp_l1_reg_loss: 15800.7915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15473.6698; train_global_loss: 3868510.5535; train_optim_loss: 3868510.5535; val_kl_reg_loss: 21430.4095; val_edge_recon_loss: 817648.3699; val_cat_covariates_contrastive_loss: 951458.0478; val_gene_expr_recon_loss: 2087524.1574; val_masked_gp_l1_reg_loss: 15807.9600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15472.1221; val_global_loss: 3909340.9899; val_optim_loss: 3909340.9899
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9339; val_auprc_score: 0.9839; val_best_acc_score: 0.9300; val_best_f1_score: 0.9597; train_kl_reg_loss: 21840.7304; train_edge_recon_loss: 780367.8585; train_cat_covariates_contrastive_loss: 949872.9929; train_gene_expr_recon_loss: 2081594.6893; train_masked_gp_l1_reg_loss: 15849.2591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15490.9935; train_global_loss: 3865016.5236; train_optim_loss: 3865016.5236; val_kl_reg_loss: 21750.3844; val_edge_recon_loss: 811956.5946; val_cat_covariates_contrastive_loss: 949260.7735; val_gene_expr_recon_loss: 2085599.4286; val_masked_gp_l1_reg_loss: 15864.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15464.9043; val_global_loss: 3899896.1781; val_optim_loss: 3899896.1781
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9340; val_auprc_score: 0.9839; val_best_acc_score: 0.9295; val_best_f1_score: 0.9593; train_kl_reg_loss: 21799.2779; train_edge_recon_loss: 780646.0915; train_cat_covariates_contrastive_loss: 949843.8996; train_gene_expr_recon_loss: 2079979.6846; train_masked_gp_l1_reg_loss: 15927.4716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15505.4208; train_global_loss: 3863701.8427; train_optim_loss: 3863701.8427; val_kl_reg_loss: 21593.5886; val_edge_recon_loss: 813097.2293; val_cat_covariates_contrastive_loss: 949557.7232; val_gene_expr_recon_loss: 2084947.5334; val_masked_gp_l1_reg_loss: 15964.1309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15533.7012; val_global_loss: 3900694.0820; val_optim_loss: 3900694.0820

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9348; val_auprc_score: 0.9842; val_best_acc_score: 0.9302; val_best_f1_score: 0.9599; train_kl_reg_loss: 21759.1641; train_edge_recon_loss: 781465.1258; train_cat_covariates_contrastive_loss: 949682.9426; train_gene_expr_recon_loss: 2079203.4628; train_masked_gp_l1_reg_loss: 15054.9828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14191.1607; train_global_loss: 3861356.8362; train_optim_loss: 3861356.8362; val_kl_reg_loss: 21483.7451; val_edge_recon_loss: 813700.8682; val_cat_covariates_contrastive_loss: 951099.2854; val_gene_expr_recon_loss: 2083610.4661; val_masked_gp_l1_reg_loss: 15055.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14156.1855; val_global_loss: 3899106.1144; val_optim_loss: 3899106.1144
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9341; val_auprc_score: 0.9838; val_best_acc_score: 0.9303; val_best_f1_score: 0.9600; train_kl_reg_loss: 21762.7911; train_edge_recon_loss: 781298.5046; train_cat_covariates_contrastive_loss: 949592.8074; train_gene_expr_recon_loss: 2079225.0245; train_masked_gp_l1_reg_loss: 15055.1856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14152.6506; train_global_loss: 3861086.9622; train_optim_loss: 3861086.9622; val_kl_reg_loss: 21566.4926; val_edge_recon_loss: 816326.9294; val_cat_covariates_contrastive_loss: 949779.1265; val_gene_expr_recon_loss: 2084707.1893; val_masked_gp_l1_reg_loss: 15059.4893; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14147.5244; val_global_loss: 3901586.7267; val_optim_loss: 3901586.7267
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9351; val_auprc_score: 0.9843; val_best_acc_score: 0.9309; val_best_f1_score: 0.9603; train_kl_reg_loss: 21736.1964; train_edge_recon_loss: 781448.9676; train_cat_covariates_contrastive_loss: 949648.1572; train_gene_expr_recon_loss: 2079485.4980; train_masked_gp_l1_reg_loss: 15063.8239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14153.2002; train_global_loss: 3861535.8410; train_optim_loss: 3861535.8410; val_kl_reg_loss: 21551.9367; val_edge_recon_loss: 811844.2277; val_cat_covariates_contrastive_loss: 949227.5010; val_gene_expr_recon_loss: 2084041.1544; val_masked_gp_l1_reg_loss: 15064.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14159.5576; val_global_loss: 3895888.8138; val_optim_loss: 3895888.8138
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9339; val_auprc_score: 0.9837; val_best_acc_score: 0.9300; val_best_f1_score: 0.9598; train_kl_reg_loss: 21741.4705; train_edge_recon_loss: 783617.1850; train_cat_covariates_contrastive_loss: 949698.8081; train_gene_expr_recon_loss: 2078478.4189; train_masked_gp_l1_reg_loss: 15071.0915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14149.3499; train_global_loss: 3862756.3258; train_optim_loss: 3862756.3258; val_kl_reg_loss: 21473.0599; val_edge_recon_loss: 816262.2910; val_cat_covariates_contrastive_loss: 950529.8957; val_gene_expr_recon_loss: 2085866.7581; val_masked_gp_l1_reg_loss: 15075.7627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14140.5391; val_global_loss: 3903348.2551; val_optim_loss: 3903348.2551
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9336; val_auprc_score: 0.9835; val_best_acc_score: 0.9287; val_best_f1_score: 0.9587; train_kl_reg_loss: 21716.0234; train_edge_recon_loss: 782306.4472; train_cat_covariates_contrastive_loss: 949624.8703; train_gene_expr_recon_loss: 2079115.4047; train_masked_gp_l1_reg_loss: 15077.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14146.1481; train_global_loss: 3861986.3888; train_optim_loss: 3861986.3888; val_kl_reg_loss: 21593.9445; val_edge_recon_loss: 826781.9464; val_cat_covariates_contrastive_loss: 949695.5256; val_gene_expr_recon_loss: 2083441.8330; val_masked_gp_l1_reg_loss: 15080.5371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14139.1719; val_global_loss: 3910733.0000; val_optim_loss: 3910733.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9345; val_auprc_score: 0.9842; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 21720.6131; train_edge_recon_loss: 780111.1795; train_cat_covariates_contrastive_loss: 949532.4778; train_gene_expr_recon_loss: 2078490.7410; train_masked_gp_l1_reg_loss: 15085.0918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14139.4123; train_global_loss: 3859079.5139; train_optim_loss: 3859079.5139; val_kl_reg_loss: 21487.3586; val_edge_recon_loss: 812439.1855; val_cat_covariates_contrastive_loss: 949942.1293; val_gene_expr_recon_loss: 2083127.6878; val_masked_gp_l1_reg_loss: 15090.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14135.9248; val_global_loss: 3896222.6123; val_optim_loss: 3896222.6123
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9350; val_auprc_score: 0.9842; val_best_acc_score: 0.9303; val_best_f1_score: 0.9599; train_kl_reg_loss: 21706.3582; train_edge_recon_loss: 782067.3775; train_cat_covariates_contrastive_loss: 949683.8601; train_gene_expr_recon_loss: 2078847.3065; train_masked_gp_l1_reg_loss: 15090.3858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14140.1966; train_global_loss: 3861535.4819; train_optim_loss: 3861535.4819; val_kl_reg_loss: 21626.8884; val_edge_recon_loss: 813657.8834; val_cat_covariates_contrastive_loss: 948982.5061; val_gene_expr_recon_loss: 2081751.6964; val_masked_gp_l1_reg_loss: 15092.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14150.2666; val_global_loss: 3895261.9747; val_optim_loss: 3895261.9747
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9338; val_auprc_score: 0.9838; val_best_acc_score: 0.9296; val_best_f1_score: 0.9594; train_kl_reg_loss: 21765.9954; train_edge_recon_loss: 781050.2171; train_cat_covariates_contrastive_loss: 949548.6321; train_gene_expr_recon_loss: 2079206.6596; train_masked_gp_l1_reg_loss: 15095.0508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14141.1196; train_global_loss: 3860807.6726; train_optim_loss: 3860807.6726; val_kl_reg_loss: 21558.9177; val_edge_recon_loss: 822183.9970; val_cat_covariates_contrastive_loss: 949452.8335; val_gene_expr_recon_loss: 2083557.7379; val_masked_gp_l1_reg_loss: 15102.1270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14154.8154; val_global_loss: 3906010.4889; val_optim_loss: 3906010.4889
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9352; val_auprc_score: 0.9842; val_best_acc_score: 0.9299; val_best_f1_score: 0.9595; train_kl_reg_loss: 21714.9812; train_edge_recon_loss: 781736.0136; train_cat_covariates_contrastive_loss: 949642.7574; train_gene_expr_recon_loss: 2078563.6991; train_masked_gp_l1_reg_loss: 15101.9945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14154.5004; train_global_loss: 3860913.9488; train_optim_loss: 3860913.9488; val_kl_reg_loss: 21482.0646; val_edge_recon_loss: 820686.8487; val_cat_covariates_contrastive_loss: 950691.0048; val_gene_expr_recon_loss: 2084470.3441; val_masked_gp_l1_reg_loss: 15106.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14169.6836; val_global_loss: 3906606.7551; val_optim_loss: 3906606.7551
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9355; val_auprc_score: 0.9846; val_best_acc_score: 0.9308; val_best_f1_score: 0.9602; train_kl_reg_loss: 21667.0030; train_edge_recon_loss: 781625.9002; train_cat_covariates_contrastive_loss: 949576.4048; train_gene_expr_recon_loss: 2078589.1401; train_masked_gp_l1_reg_loss: 15110.2792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14159.0714; train_global_loss: 3860727.7969; train_optim_loss: 3860727.7969; val_kl_reg_loss: 21395.1602; val_edge_recon_loss: 808518.5569; val_cat_covariates_contrastive_loss: 950434.0339; val_gene_expr_recon_loss: 2085197.7100; val_masked_gp_l1_reg_loss: 15116.3936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14154.8223; val_global_loss: 3894816.7014; val_optim_loss: 3894816.7014
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9361; val_auprc_score: 0.9845; val_best_acc_score: 0.9311; val_best_f1_score: 0.9604; train_kl_reg_loss: 21652.9662; train_edge_recon_loss: 781247.4866; train_cat_covariates_contrastive_loss: 949625.6141; train_gene_expr_recon_loss: 2078581.0038; train_masked_gp_l1_reg_loss: 15118.5469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14158.6336; train_global_loss: 3860384.2550; train_optim_loss: 3860384.2550; val_kl_reg_loss: 21488.2423; val_edge_recon_loss: 809171.5969; val_cat_covariates_contrastive_loss: 950158.8391; val_gene_expr_recon_loss: 2082177.5683; val_masked_gp_l1_reg_loss: 15119.2676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14148.7236; val_global_loss: 3892264.2419; val_optim_loss: 3892264.2419
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9352; val_auprc_score: 0.9842; val_best_acc_score: 0.9306; val_best_f1_score: 0.9600; train_kl_reg_loss: 21693.6282; train_edge_recon_loss: 782055.5456; train_cat_covariates_contrastive_loss: 949737.1192; train_gene_expr_recon_loss: 2078437.0919; train_masked_gp_l1_reg_loss: 15123.2966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14155.0372; train_global_loss: 3861201.7168; train_optim_loss: 3861201.7168; val_kl_reg_loss: 21488.6250; val_edge_recon_loss: 814140.0152; val_cat_covariates_contrastive_loss: 949658.2773; val_gene_expr_recon_loss: 2082604.0628; val_masked_gp_l1_reg_loss: 15126.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14157.0908; val_global_loss: 3897174.2257; val_optim_loss: 3897174.2257
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9334; val_auprc_score: 0.9834; val_best_acc_score: 0.9302; val_best_f1_score: 0.9598; train_kl_reg_loss: 21673.9943; train_edge_recon_loss: 780938.1165; train_cat_covariates_contrastive_loss: 949560.0532; train_gene_expr_recon_loss: 2078478.0639; train_masked_gp_l1_reg_loss: 15126.7885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14156.3875; train_global_loss: 3859933.4078; train_optim_loss: 3859933.4078; val_kl_reg_loss: 21524.6182; val_edge_recon_loss: 815940.6885; val_cat_covariates_contrastive_loss: 949103.3535; val_gene_expr_recon_loss: 2081392.7839; val_masked_gp_l1_reg_loss: 15121.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14141.3262; val_global_loss: 3897224.1953; val_optim_loss: 3897224.1953
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9358; val_auprc_score: 0.9847; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 21681.6346; train_edge_recon_loss: 783108.8285; train_cat_covariates_contrastive_loss: 949552.3834; train_gene_expr_recon_loss: 2077445.6638; train_masked_gp_l1_reg_loss: 15130.1360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14146.6177; train_global_loss: 3861065.2709; train_optim_loss: 3861065.2709; val_kl_reg_loss: 21413.4661; val_edge_recon_loss: 803662.0144; val_cat_covariates_contrastive_loss: 951135.7743; val_gene_expr_recon_loss: 2082825.0602; val_masked_gp_l1_reg_loss: 15135.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14152.2236; val_global_loss: 3888324.3209; val_optim_loss: 3888324.3209
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9361; val_auprc_score: 0.9847; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 21662.0597; train_edge_recon_loss: 782042.0970; train_cat_covariates_contrastive_loss: 949539.0016; train_gene_expr_recon_loss: 2077782.7948; train_masked_gp_l1_reg_loss: 15134.9969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14154.1341; train_global_loss: 3860315.0833; train_optim_loss: 3860315.0833; val_kl_reg_loss: 21416.5409; val_edge_recon_loss: 811670.8282; val_cat_covariates_contrastive_loss: 949293.1045; val_gene_expr_recon_loss: 2083506.1377; val_masked_gp_l1_reg_loss: 15135.3066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14151.6904; val_global_loss: 3895173.6144; val_optim_loss: 3895173.6144
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9341; val_auprc_score: 0.9839; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 21616.5846; train_edge_recon_loss: 783480.9076; train_cat_covariates_contrastive_loss: 949574.9297; train_gene_expr_recon_loss: 2077582.6749; train_masked_gp_l1_reg_loss: 15141.4532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14160.0867; train_global_loss: 3861556.6336; train_optim_loss: 3861556.6336; val_kl_reg_loss: 21436.4938; val_edge_recon_loss: 820655.5853; val_cat_covariates_contrastive_loss: 949678.6070; val_gene_expr_recon_loss: 2081686.6508; val_masked_gp_l1_reg_loss: 15143.7705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14161.1348; val_global_loss: 3902762.3472; val_optim_loss: 3902762.3472
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9340; val_auprc_score: 0.9837; val_best_acc_score: 0.9301; val_best_f1_score: 0.9597; train_kl_reg_loss: 21648.7531; train_edge_recon_loss: 782609.0227; train_cat_covariates_contrastive_loss: 949660.1905; train_gene_expr_recon_loss: 2077776.6223; train_masked_gp_l1_reg_loss: 15147.2204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14154.0776; train_global_loss: 3860995.8881; train_optim_loss: 3860995.8881; val_kl_reg_loss: 21418.9445; val_edge_recon_loss: 820148.7882; val_cat_covariates_contrastive_loss: 949645.6164; val_gene_expr_recon_loss: 2083129.5845; val_masked_gp_l1_reg_loss: 15147.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14151.0244; val_global_loss: 3903641.1842; val_optim_loss: 3903641.1842
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9351; val_auprc_score: 0.9843; val_best_acc_score: 0.9310; val_best_f1_score: 0.9604; train_kl_reg_loss: 21673.4437; train_edge_recon_loss: 781450.6556; train_cat_covariates_contrastive_loss: 949673.9724; train_gene_expr_recon_loss: 2078193.4884; train_masked_gp_l1_reg_loss: 15153.2667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14157.5047; train_global_loss: 3860302.3335; train_optim_loss: 3860302.3335; val_kl_reg_loss: 21506.2124; val_edge_recon_loss: 807290.6883; val_cat_covariates_contrastive_loss: 949351.1614; val_gene_expr_recon_loss: 2081496.2510; val_masked_gp_l1_reg_loss: 15162.4346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14172.6758; val_global_loss: 3888979.5597; val_optim_loss: 3888979.5597

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9340; val_auprc_score: 0.9837; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 21617.0687; train_edge_recon_loss: 783868.8878; train_cat_covariates_contrastive_loss: 949785.9033; train_gene_expr_recon_loss: 2077545.5208; train_masked_gp_l1_reg_loss: 15062.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14020.5459; train_global_loss: 3861900.3818; train_optim_loss: 3861900.3818; val_kl_reg_loss: 21471.0522; val_edge_recon_loss: 822234.1194; val_cat_covariates_contrastive_loss: 949003.0569; val_gene_expr_recon_loss: 2083257.2900; val_masked_gp_l1_reg_loss: 15061.4629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14013.7314; val_global_loss: 3905040.7642; val_optim_loss: 3905040.7642
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9344; val_auprc_score: 0.9838; val_best_acc_score: 0.9308; val_best_f1_score: 0.9601; train_kl_reg_loss: 21608.5611; train_edge_recon_loss: 782360.6117; train_cat_covariates_contrastive_loss: 949415.2125; train_gene_expr_recon_loss: 2078023.6605; train_masked_gp_l1_reg_loss: 15061.9464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14009.9942; train_global_loss: 3860479.9854; train_optim_loss: 3860479.9854; val_kl_reg_loss: 21419.3520; val_edge_recon_loss: 818443.5726; val_cat_covariates_contrastive_loss: 949525.5035; val_gene_expr_recon_loss: 2082984.2834; val_masked_gp_l1_reg_loss: 15062.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14007.0947; val_global_loss: 3901442.4777; val_optim_loss: 3901442.4777
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9351; val_auprc_score: 0.9840; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 21600.1768; train_edge_recon_loss: 781075.9091; train_cat_covariates_contrastive_loss: 949655.6782; train_gene_expr_recon_loss: 2078321.3679; train_masked_gp_l1_reg_loss: 15062.8593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14006.6478; train_global_loss: 3859722.6437; train_optim_loss: 3859722.6437; val_kl_reg_loss: 21406.6024; val_edge_recon_loss: 815502.7267; val_cat_covariates_contrastive_loss: 949741.0291; val_gene_expr_recon_loss: 2083636.2601; val_masked_gp_l1_reg_loss: 15062.8584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14008.1191; val_global_loss: 3899357.3694; val_optim_loss: 3899357.3694
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9361; val_auprc_score: 0.9846; val_best_acc_score: 0.9310; val_best_f1_score: 0.9602; train_kl_reg_loss: 21609.7192; train_edge_recon_loss: 781123.7077; train_cat_covariates_contrastive_loss: 949683.8466; train_gene_expr_recon_loss: 2077899.2213; train_masked_gp_l1_reg_loss: 15063.3857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14006.5226; train_global_loss: 3859386.4038; train_optim_loss: 3859386.4038; val_kl_reg_loss: 21445.3707; val_edge_recon_loss: 805600.1678; val_cat_covariates_contrastive_loss: 950015.8563; val_gene_expr_recon_loss: 2082259.6969; val_masked_gp_l1_reg_loss: 15063.9521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14004.1963; val_global_loss: 3888389.3289; val_optim_loss: 3888389.3289

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 777 min 38 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9206
val AUPRC score: 0.9763
val best accuracy score: 0.9289
val best F1 score: 0.9590
val target rna MSE score: 0.4623
val source rna MSE score: 0.2369
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0576
Val cat covariate2 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
