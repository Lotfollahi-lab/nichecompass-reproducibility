[True, False, True]
Run timestamp: 29092023_122437_202.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_202']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 487746
Number of validation nodes: 54194
Number of training edges: 1154331
Number of validation edges: 128258
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9053; val_auprc_score: 0.9785; val_best_acc_score: 0.9128; val_best_f1_score: 0.9504; train_kl_reg_loss: 16266.2959; train_edge_recon_loss: 820021.3346; train_cat_covariates_contrastive_loss: 945765.4478; train_gene_expr_recon_loss: 2881237.9557; train_masked_gp_l1_reg_loss: 28898.1156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96282.5231; train_global_loss: 4788471.6634; train_optim_loss: 4788471.6634; val_kl_reg_loss: 14489.4969; val_edge_recon_loss: 820325.1621; val_cat_covariates_contrastive_loss: 943987.9206; val_gene_expr_recon_loss: 2742567.1873; val_masked_gp_l1_reg_loss: 20913.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21245.5156; val_global_loss: 4563528.2689; val_optim_loss: 4563528.2689
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9144; val_auprc_score: 0.9794; val_best_acc_score: 0.9195; val_best_f1_score: 0.9538; train_kl_reg_loss: 17647.2812; train_edge_recon_loss: 790555.1732; train_cat_covariates_contrastive_loss: 946148.2984; train_gene_expr_recon_loss: 2628624.4990; train_masked_gp_l1_reg_loss: 20993.2419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21577.3888; train_global_loss: 4425545.8769; train_optim_loss: 4425545.8769; val_kl_reg_loss: 19599.3379; val_edge_recon_loss: 825995.5981; val_cat_covariates_contrastive_loss: 946735.3730; val_gene_expr_recon_loss: 2540478.2400; val_masked_gp_l1_reg_loss: 21595.5020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22361.4238; val_global_loss: 4376765.5388; val_optim_loss: 4376765.5388
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9259; val_auprc_score: 0.9822; val_best_acc_score: 0.9251; val_best_f1_score: 0.9570; train_kl_reg_loss: 19753.7265; train_edge_recon_loss: 785032.4595; train_cat_covariates_contrastive_loss: 948233.1791; train_gene_expr_recon_loss: 2503445.0175; train_masked_gp_l1_reg_loss: 22681.8421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22724.9125; train_global_loss: 4301871.1451; train_optim_loss: 4301871.1451; val_kl_reg_loss: 20111.8448; val_edge_recon_loss: 823087.6066; val_cat_covariates_contrastive_loss: 948108.4592; val_gene_expr_recon_loss: 2481845.6305; val_masked_gp_l1_reg_loss: 23797.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23414.3613; val_global_loss: 4320365.5488; val_optim_loss: 4320365.5488
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9343; val_auprc_score: 0.9846; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 20837.6497; train_edge_recon_loss: 782451.4893; train_cat_covariates_contrastive_loss: 948632.1150; train_gene_expr_recon_loss: 2466858.8171; train_masked_gp_l1_reg_loss: 24539.3237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23978.2692; train_global_loss: 4267297.6559; train_optim_loss: 4267297.6559; val_kl_reg_loss: 21658.3632; val_edge_recon_loss: 808966.5010; val_cat_covariates_contrastive_loss: 948971.7572; val_gene_expr_recon_loss: 2458653.7948; val_masked_gp_l1_reg_loss: 25300.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24728.2598; val_global_loss: 4288279.3576; val_optim_loss: 4288279.3576
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9324; val_auprc_score: 0.9838; val_best_acc_score: 0.9294; val_best_f1_score: 0.9594; train_kl_reg_loss: 21984.9518; train_edge_recon_loss: 782538.7142; train_cat_covariates_contrastive_loss: 949254.5460; train_gene_expr_recon_loss: 2444239.3187; train_masked_gp_l1_reg_loss: 25888.1748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24985.9250; train_global_loss: 4248891.6329; train_optim_loss: 4248891.6329; val_kl_reg_loss: 22411.2825; val_edge_recon_loss: 815984.5560; val_cat_covariates_contrastive_loss: 949400.5787; val_gene_expr_recon_loss: 2441802.6912; val_masked_gp_l1_reg_loss: 26142.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25829.0918; val_global_loss: 4281570.5976; val_optim_loss: 4281570.5976
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9343; val_auprc_score: 0.9838; val_best_acc_score: 0.9317; val_best_f1_score: 0.9607; train_kl_reg_loss: 22946.3193; train_edge_recon_loss: 780017.0777; train_cat_covariates_contrastive_loss: 949636.6992; train_gene_expr_recon_loss: 2426787.3518; train_masked_gp_l1_reg_loss: 26465.2701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26309.7959; train_global_loss: 4232162.5093; train_optim_loss: 4232162.5093; val_kl_reg_loss: 23949.0260; val_edge_recon_loss: 816236.5652; val_cat_covariates_contrastive_loss: 949143.9711; val_gene_expr_recon_loss: 2422928.0120; val_masked_gp_l1_reg_loss: 26689.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26868.7402; val_global_loss: 4265816.1046; val_optim_loss: 4265816.1046
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9380; val_auprc_score: 0.9849; val_best_acc_score: 0.9349; val_best_f1_score: 0.9624; train_kl_reg_loss: 23892.9789; train_edge_recon_loss: 783670.8558; train_cat_covariates_contrastive_loss: 950159.4750; train_gene_expr_recon_loss: 2412120.2337; train_masked_gp_l1_reg_loss: 27042.9038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27003.5328; train_global_loss: 4223889.9839; train_optim_loss: 4223889.9839; val_kl_reg_loss: 23783.0716; val_edge_recon_loss: 808169.5065; val_cat_covariates_contrastive_loss: 949584.6165; val_gene_expr_recon_loss: 2412607.1584; val_masked_gp_l1_reg_loss: 27374.9395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27091.1895; val_global_loss: 4248610.4213; val_optim_loss: 4248610.4213
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9357; val_auprc_score: 0.9841; val_best_acc_score: 0.9334; val_best_f1_score: 0.9617; train_kl_reg_loss: 24522.9665; train_edge_recon_loss: 782580.7403; train_cat_covariates_contrastive_loss: 950317.5480; train_gene_expr_recon_loss: 2401268.9034; train_masked_gp_l1_reg_loss: 27708.3683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27200.7585; train_global_loss: 4213599.2918; train_optim_loss: 4213599.2918; val_kl_reg_loss: 24654.2490; val_edge_recon_loss: 811557.7032; val_cat_covariates_contrastive_loss: 949947.5580; val_gene_expr_recon_loss: 2401011.2430; val_masked_gp_l1_reg_loss: 27982.5020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27387.6367; val_global_loss: 4242540.8566; val_optim_loss: 4242540.8566
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9445; val_auprc_score: 0.9869; val_best_acc_score: 0.9376; val_best_f1_score: 0.9641; train_kl_reg_loss: 25094.3631; train_edge_recon_loss: 782849.0299; train_cat_covariates_contrastive_loss: 950469.1476; train_gene_expr_recon_loss: 2392816.1017; train_masked_gp_l1_reg_loss: 28246.8131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27501.5175; train_global_loss: 4206976.9819; train_optim_loss: 4206976.9819; val_kl_reg_loss: 24801.7065; val_edge_recon_loss: 808910.5456; val_cat_covariates_contrastive_loss: 953093.2821; val_gene_expr_recon_loss: 2393829.3098; val_masked_gp_l1_reg_loss: 28418.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27956.8340; val_global_loss: 4237010.7361; val_optim_loss: 4237010.7361
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9400; val_auprc_score: 0.9852; val_best_acc_score: 0.9359; val_best_f1_score: 0.9631; train_kl_reg_loss: 25635.2559; train_edge_recon_loss: 780821.6760; train_cat_covariates_contrastive_loss: 950668.0136; train_gene_expr_recon_loss: 2385600.2410; train_masked_gp_l1_reg_loss: 28447.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27916.2025; train_global_loss: 4199088.6369; train_optim_loss: 4199088.6369; val_kl_reg_loss: 25813.1022; val_edge_recon_loss: 809099.0535; val_cat_covariates_contrastive_loss: 949924.5784; val_gene_expr_recon_loss: 2385875.8795; val_masked_gp_l1_reg_loss: 28356.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27973.8867; val_global_loss: 4227043.5926; val_optim_loss: 4227043.5926
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9398; val_auprc_score: 0.9849; val_best_acc_score: 0.9353; val_best_f1_score: 0.9627; train_kl_reg_loss: 25989.4998; train_edge_recon_loss: 779947.3870; train_cat_covariates_contrastive_loss: 950818.5945; train_gene_expr_recon_loss: 2379467.1020; train_masked_gp_l1_reg_loss: 28539.5357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28311.9031; train_global_loss: 4193074.0267; train_optim_loss: 4193074.0267; val_kl_reg_loss: 26267.0317; val_edge_recon_loss: 818540.2261; val_cat_covariates_contrastive_loss: 951057.6589; val_gene_expr_recon_loss: 2380583.8137; val_masked_gp_l1_reg_loss: 28474.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28481.4648; val_global_loss: 4233404.7590; val_optim_loss: 4233404.7590
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9408; val_auprc_score: 0.9856; val_best_acc_score: 0.9373; val_best_f1_score: 0.9639; train_kl_reg_loss: 26519.4836; train_edge_recon_loss: 782125.6627; train_cat_covariates_contrastive_loss: 951095.2286; train_gene_expr_recon_loss: 2378686.5185; train_masked_gp_l1_reg_loss: 28829.6186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28710.9187; train_global_loss: 4195967.4269; train_optim_loss: 4195967.4269; val_kl_reg_loss: 28597.4845; val_edge_recon_loss: 805079.7532; val_cat_covariates_contrastive_loss: 950855.3680; val_gene_expr_recon_loss: 2390761.0448; val_masked_gp_l1_reg_loss: 29255.3027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28871.5410; val_global_loss: 4233420.5568; val_optim_loss: 4233420.5568
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9428; val_auprc_score: 0.9858; val_best_acc_score: 0.9378; val_best_f1_score: 0.9642; train_kl_reg_loss: 28312.5072; train_edge_recon_loss: 781955.8032; train_cat_covariates_contrastive_loss: 951589.9250; train_gene_expr_recon_loss: 2371869.9979; train_masked_gp_l1_reg_loss: 28558.2001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28888.5512; train_global_loss: 4191174.9830; train_optim_loss: 4191174.9830; val_kl_reg_loss: 28350.8217; val_edge_recon_loss: 805182.4671; val_cat_covariates_contrastive_loss: 950954.2271; val_gene_expr_recon_loss: 2372016.9522; val_masked_gp_l1_reg_loss: 28746.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28761.0547; val_global_loss: 4214011.9920; val_optim_loss: 4214011.9920
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9425; val_auprc_score: 0.9856; val_best_acc_score: 0.9385; val_best_f1_score: 0.9646; train_kl_reg_loss: 28146.7754; train_edge_recon_loss: 781532.2555; train_cat_covariates_contrastive_loss: 951424.8854; train_gene_expr_recon_loss: 2368184.2937; train_masked_gp_l1_reg_loss: 28843.5326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29030.7547; train_global_loss: 4187162.5059; train_optim_loss: 4187162.5059; val_kl_reg_loss: 28608.8997; val_edge_recon_loss: 815311.1509; val_cat_covariates_contrastive_loss: 951853.5040; val_gene_expr_recon_loss: 2369813.5000; val_masked_gp_l1_reg_loss: 28699.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29168.6777; val_global_loss: 4223454.6703; val_optim_loss: 4223454.6703
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9427; val_auprc_score: 0.9859; val_best_acc_score: 0.9386; val_best_f1_score: 0.9646; train_kl_reg_loss: 28540.0079; train_edge_recon_loss: 783065.1870; train_cat_covariates_contrastive_loss: 951591.6846; train_gene_expr_recon_loss: 2367267.3358; train_masked_gp_l1_reg_loss: 29137.4663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29210.5569; train_global_loss: 4188812.2421; train_optim_loss: 4188812.2421; val_kl_reg_loss: 28772.6080; val_edge_recon_loss: 805613.2136; val_cat_covariates_contrastive_loss: 951148.5244; val_gene_expr_recon_loss: 2378709.3376; val_masked_gp_l1_reg_loss: 29421.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29365.3125; val_global_loss: 4223030.2141; val_optim_loss: 4223030.2141
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9435; val_auprc_score: 0.9861; val_best_acc_score: 0.9380; val_best_f1_score: 0.9642; train_kl_reg_loss: 29845.5400; train_edge_recon_loss: 782900.3278; train_cat_covariates_contrastive_loss: 952059.9586; train_gene_expr_recon_loss: 2364954.9844; train_masked_gp_l1_reg_loss: 29043.8985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29582.0068; train_global_loss: 4188386.7151; train_optim_loss: 4188386.7151; val_kl_reg_loss: 50777.1199; val_edge_recon_loss: 804701.9776; val_cat_covariates_contrastive_loss: 950786.8010; val_gene_expr_recon_loss: 2362586.1056; val_masked_gp_l1_reg_loss: 29002.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29764.2734; val_global_loss: 4227619.3586; val_optim_loss: 4227619.3586
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9459; val_auprc_score: 0.9868; val_best_acc_score: 0.9391; val_best_f1_score: 0.9648; train_kl_reg_loss: 30140.9913; train_edge_recon_loss: 781220.5017; train_cat_covariates_contrastive_loss: 952012.7114; train_gene_expr_recon_loss: 2366981.5942; train_masked_gp_l1_reg_loss: 29392.8152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29978.2604; train_global_loss: 4189726.8764; train_optim_loss: 4189726.8764; val_kl_reg_loss: 29826.7368; val_edge_recon_loss: 813376.4218; val_cat_covariates_contrastive_loss: 953731.0732; val_gene_expr_recon_loss: 2361828.4970; val_masked_gp_l1_reg_loss: 29059.2988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30000.3633; val_global_loss: 4217822.4562; val_optim_loss: 4217822.4562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9439; val_auprc_score: 0.9859; val_best_acc_score: 0.9391; val_best_f1_score: 0.9648; train_kl_reg_loss: 31117.9643; train_edge_recon_loss: 779519.1254; train_cat_covariates_contrastive_loss: 951437.4160; train_gene_expr_recon_loss: 2350070.1585; train_masked_gp_l1_reg_loss: 18963.7544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16943.2602; train_global_loss: 4148051.6799; train_optim_loss: 4148051.6799; val_kl_reg_loss: 30605.9358; val_edge_recon_loss: 811409.8160; val_cat_covariates_contrastive_loss: 951445.4801; val_gene_expr_recon_loss: 2351308.0378; val_masked_gp_l1_reg_loss: 18897.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16869.0742; val_global_loss: 4180535.2819; val_optim_loss: 4180535.2819
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9468; val_auprc_score: 0.9869; val_best_acc_score: 0.9412; val_best_f1_score: 0.9661; train_kl_reg_loss: 30647.9792; train_edge_recon_loss: 781780.4823; train_cat_covariates_contrastive_loss: 951459.6356; train_gene_expr_recon_loss: 2346810.9088; train_masked_gp_l1_reg_loss: 18922.8580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16831.2170; train_global_loss: 4146453.0815; train_optim_loss: 4146453.0815; val_kl_reg_loss: 30425.7828; val_edge_recon_loss: 802440.9968; val_cat_covariates_contrastive_loss: 952105.5075; val_gene_expr_recon_loss: 2350593.5408; val_masked_gp_l1_reg_loss: 18958.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16825.2793; val_global_loss: 4171350.1663; val_optim_loss: 4171350.1663
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9475; val_auprc_score: 0.9868; val_best_acc_score: 0.9419; val_best_f1_score: 0.9664; train_kl_reg_loss: 30451.1536; train_edge_recon_loss: 778386.2104; train_cat_covariates_contrastive_loss: 951521.8399; train_gene_expr_recon_loss: 2344500.1562; train_masked_gp_l1_reg_loss: 18981.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16889.4031; train_global_loss: 4140730.3218; train_optim_loss: 4140730.3218; val_kl_reg_loss: 30218.6215; val_edge_recon_loss: 806095.3187; val_cat_covariates_contrastive_loss: 951329.8317; val_gene_expr_recon_loss: 2350419.9193; val_masked_gp_l1_reg_loss: 19022.9668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16909.1250; val_global_loss: 4173995.7410; val_optim_loss: 4173995.7410
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9443; val_auprc_score: 0.9860; val_best_acc_score: 0.9414; val_best_f1_score: 0.9663; train_kl_reg_loss: 30245.9034; train_edge_recon_loss: 779271.6902; train_cat_covariates_contrastive_loss: 951416.4160; train_gene_expr_recon_loss: 2343213.3732; train_masked_gp_l1_reg_loss: 19063.4096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16981.2997; train_global_loss: 4140192.0886; train_optim_loss: 4140192.0886; val_kl_reg_loss: 30319.3001; val_edge_recon_loss: 800817.4163; val_cat_covariates_contrastive_loss: 951012.9846; val_gene_expr_recon_loss: 2348811.3546; val_masked_gp_l1_reg_loss: 19116.9355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16988.8398; val_global_loss: 4167066.8845; val_optim_loss: 4167066.8845
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9477; val_auprc_score: 0.9870; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 30129.1539; train_edge_recon_loss: 777486.1452; train_cat_covariates_contrastive_loss: 951304.3822; train_gene_expr_recon_loss: 2342345.5539; train_masked_gp_l1_reg_loss: 19144.8557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17063.8638; train_global_loss: 4137473.9525; train_optim_loss: 4137473.9525; val_kl_reg_loss: 29895.3938; val_edge_recon_loss: 807994.5035; val_cat_covariates_contrastive_loss: 951028.3205; val_gene_expr_recon_loss: 2347209.8914; val_masked_gp_l1_reg_loss: 19195.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17170.3301; val_global_loss: 4172494.4492; val_optim_loss: 4172494.4492
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9466; val_auprc_score: 0.9867; val_best_acc_score: 0.9415; val_best_f1_score: 0.9662; train_kl_reg_loss: 29937.4335; train_edge_recon_loss: 780088.5712; train_cat_covariates_contrastive_loss: 951322.0116; train_gene_expr_recon_loss: 2341660.4818; train_masked_gp_l1_reg_loss: 19220.1902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17128.0671; train_global_loss: 4139356.7521; train_optim_loss: 4139356.7521; val_kl_reg_loss: 29683.4899; val_edge_recon_loss: 806578.6845; val_cat_covariates_contrastive_loss: 951682.9355; val_gene_expr_recon_loss: 2348782.8247; val_masked_gp_l1_reg_loss: 19281.8613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17134.7734; val_global_loss: 4173144.5926; val_optim_loss: 4173144.5926
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9486; val_auprc_score: 0.9872; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 29828.6740; train_edge_recon_loss: 778825.2571; train_cat_covariates_contrastive_loss: 951089.9818; train_gene_expr_recon_loss: 2340961.6735; train_masked_gp_l1_reg_loss: 19282.1919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17192.4270; train_global_loss: 4137180.2073; train_optim_loss: 4137180.2073; val_kl_reg_loss: 29479.1157; val_edge_recon_loss: 807254.3093; val_cat_covariates_contrastive_loss: 952472.4181; val_gene_expr_recon_loss: 2343424.4253; val_masked_gp_l1_reg_loss: 19332.4707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17261.2168; val_global_loss: 4169223.9193; val_optim_loss: 4169223.9193
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9477; val_auprc_score: 0.9868; val_best_acc_score: 0.9423; val_best_f1_score: 0.9667; train_kl_reg_loss: 29743.8382; train_edge_recon_loss: 779472.5705; train_cat_covariates_contrastive_loss: 951156.1585; train_gene_expr_recon_loss: 2340037.3851; train_masked_gp_l1_reg_loss: 19341.1488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17244.4026; train_global_loss: 4136995.4996; train_optim_loss: 4136995.4996; val_kl_reg_loss: 29716.7574; val_edge_recon_loss: 806905.6678; val_cat_covariates_contrastive_loss: 950362.5550; val_gene_expr_recon_loss: 2344106.1026; val_masked_gp_l1_reg_loss: 19375.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17325.8750; val_global_loss: 4167792.5159; val_optim_loss: 4167792.5159

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9260; val_auprc_score: 0.9821; val_best_acc_score: 0.9251; val_best_f1_score: 0.9570; train_kl_reg_loss: 26768.9722; train_edge_recon_loss: 787138.4871; train_cat_covariates_contrastive_loss: 950435.8461; train_gene_expr_recon_loss: 2063169.6973; train_masked_gp_l1_reg_loss: 18163.2397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16400.7715; train_global_loss: 3862077.0133; train_optim_loss: 3862077.0133; val_kl_reg_loss: 17985.8984; val_edge_recon_loss: 821141.1611; val_cat_covariates_contrastive_loss: 950605.3740; val_gene_expr_recon_loss: 2055393.2864; val_masked_gp_l1_reg_loss: 17874.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16247.9170; val_global_loss: 3879248.2261; val_optim_loss: 3879248.2261
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9258; val_auprc_score: 0.9821; val_best_acc_score: 0.9254; val_best_f1_score: 0.9572; train_kl_reg_loss: 25564.1515; train_edge_recon_loss: 789774.6254; train_cat_covariates_contrastive_loss: 950530.9061; train_gene_expr_recon_loss: 2045808.6263; train_masked_gp_l1_reg_loss: 17560.8139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16009.6889; train_global_loss: 3845248.8157; train_optim_loss: 3845248.8157; val_kl_reg_loss: 18206.2893; val_edge_recon_loss: 821715.7423; val_cat_covariates_contrastive_loss: 950830.3877; val_gene_expr_recon_loss: 2046364.7724; val_masked_gp_l1_reg_loss: 17263.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15785.9717; val_global_loss: 3870166.9363; val_optim_loss: 3870166.9363
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9268; val_auprc_score: 0.9819; val_best_acc_score: 0.9256; val_best_f1_score: 0.9573; train_kl_reg_loss: 24623.2938; train_edge_recon_loss: 784754.8173; train_cat_covariates_contrastive_loss: 950213.8202; train_gene_expr_recon_loss: 2036850.0862; train_masked_gp_l1_reg_loss: 16971.1050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15576.3527; train_global_loss: 3828989.4700; train_optim_loss: 3828989.4700; val_kl_reg_loss: 18521.6777; val_edge_recon_loss: 823809.0017; val_cat_covariates_contrastive_loss: 949990.0745; val_gene_expr_recon_loss: 2040418.9696; val_masked_gp_l1_reg_loss: 16679.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15385.8379; val_global_loss: 3864804.7072; val_optim_loss: 3864804.7072
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9279; val_auprc_score: 0.9828; val_best_acc_score: 0.9271; val_best_f1_score: 0.9580; train_kl_reg_loss: 23764.0046; train_edge_recon_loss: 788046.9662; train_cat_covariates_contrastive_loss: 950013.6022; train_gene_expr_recon_loss: 2031075.2843; train_masked_gp_l1_reg_loss: 16395.7627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15206.1724; train_global_loss: 3824501.7936; train_optim_loss: 3824501.7936; val_kl_reg_loss: 18743.4973; val_edge_recon_loss: 817011.1118; val_cat_covariates_contrastive_loss: 949462.6018; val_gene_expr_recon_loss: 2035158.8456; val_masked_gp_l1_reg_loss: 16122.0146; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15026.0879; val_global_loss: 3851524.0608; val_optim_loss: 3851524.0608
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9270; val_auprc_score: 0.9822; val_best_acc_score: 0.9274; val_best_f1_score: 0.9583; train_kl_reg_loss: 23160.2404; train_edge_recon_loss: 786886.3372; train_cat_covariates_contrastive_loss: 949834.5656; train_gene_expr_recon_loss: 2028178.9085; train_masked_gp_l1_reg_loss: 15842.4481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14849.1674; train_global_loss: 3818751.6637; train_optim_loss: 3818751.6637; val_kl_reg_loss: 18936.8175; val_edge_recon_loss: 819640.4644; val_cat_covariates_contrastive_loss: 950181.2664; val_gene_expr_recon_loss: 2033463.5752; val_masked_gp_l1_reg_loss: 15563.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14689.9707; val_global_loss: 3852475.3725; val_optim_loss: 3852475.3725
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9288; val_auprc_score: 0.9830; val_best_acc_score: 0.9267; val_best_f1_score: 0.9580; train_kl_reg_loss: 22949.1747; train_edge_recon_loss: 783832.1080; train_cat_covariates_contrastive_loss: 949711.0550; train_gene_expr_recon_loss: 2025614.3912; train_masked_gp_l1_reg_loss: 15304.6403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14547.7564; train_global_loss: 3811959.1286; train_optim_loss: 3811959.1286; val_kl_reg_loss: 19062.3837; val_edge_recon_loss: 817883.0543; val_cat_covariates_contrastive_loss: 950064.1260; val_gene_expr_recon_loss: 2029796.0792; val_masked_gp_l1_reg_loss: 15076.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14421.6025; val_global_loss: 3846303.1384; val_optim_loss: 3846303.1384
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9289; val_auprc_score: 0.9828; val_best_acc_score: 0.9276; val_best_f1_score: 0.9585; train_kl_reg_loss: 22406.8207; train_edge_recon_loss: 784412.4812; train_cat_covariates_contrastive_loss: 949645.7289; train_gene_expr_recon_loss: 2022929.8365; train_masked_gp_l1_reg_loss: 14918.2384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14279.6331; train_global_loss: 3808592.7379; train_optim_loss: 3808592.7379; val_kl_reg_loss: 19200.5983; val_edge_recon_loss: 813650.7756; val_cat_covariates_contrastive_loss: 949689.3357; val_gene_expr_recon_loss: 2024684.0244; val_masked_gp_l1_reg_loss: 14829.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14173.7598; val_global_loss: 3836227.4821; val_optim_loss: 3836227.4821
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9300; val_auprc_score: 0.9830; val_best_acc_score: 0.9285; val_best_f1_score: 0.9589; train_kl_reg_loss: 22163.0516; train_edge_recon_loss: 787830.8115; train_cat_covariates_contrastive_loss: 949693.9153; train_gene_expr_recon_loss: 2019650.8360; train_masked_gp_l1_reg_loss: 14790.8988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14054.3987; train_global_loss: 3808183.9152; train_optim_loss: 3808183.9152; val_kl_reg_loss: 19412.4473; val_edge_recon_loss: 815668.5468; val_cat_covariates_contrastive_loss: 949278.0807; val_gene_expr_recon_loss: 2022742.7465; val_masked_gp_l1_reg_loss: 14752.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13929.8789; val_global_loss: 3835784.5687; val_optim_loss: 3835784.5687
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9304; val_auprc_score: 0.9830; val_best_acc_score: 0.9270; val_best_f1_score: 0.9580; train_kl_reg_loss: 22035.8607; train_edge_recon_loss: 785004.0956; train_cat_covariates_contrastive_loss: 949527.1460; train_gene_expr_recon_loss: 2018393.1850; train_masked_gp_l1_reg_loss: 14720.2798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13835.4188; train_global_loss: 3803515.9894; train_optim_loss: 3803515.9894; val_kl_reg_loss: 19514.3700; val_edge_recon_loss: 824826.8329; val_cat_covariates_contrastive_loss: 950242.6728; val_gene_expr_recon_loss: 2020668.8018; val_masked_gp_l1_reg_loss: 14693.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13741.3887; val_global_loss: 3843687.9353; val_optim_loss: 3843687.9353
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9300; val_auprc_score: 0.9829; val_best_acc_score: 0.9290; val_best_f1_score: 0.9591; train_kl_reg_loss: 21871.2640; train_edge_recon_loss: 784380.1381; train_cat_covariates_contrastive_loss: 949422.2888; train_gene_expr_recon_loss: 2017027.3905; train_masked_gp_l1_reg_loss: 14664.8178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13666.9314; train_global_loss: 3801032.8278; train_optim_loss: 3801032.8278; val_kl_reg_loss: 19642.8790; val_edge_recon_loss: 817719.4168; val_cat_covariates_contrastive_loss: 949489.6559; val_gene_expr_recon_loss: 2020518.0767; val_masked_gp_l1_reg_loss: 14641.2627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13580.7803; val_global_loss: 3835592.0209; val_optim_loss: 3835592.0209
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9303; val_auprc_score: 0.9832; val_best_acc_score: 0.9283; val_best_f1_score: 0.9588; train_kl_reg_loss: 21833.1754; train_edge_recon_loss: 783556.2626; train_cat_covariates_contrastive_loss: 949562.2674; train_gene_expr_recon_loss: 2015789.2528; train_masked_gp_l1_reg_loss: 14616.7290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13506.7457; train_global_loss: 3798864.4297; train_optim_loss: 3798864.4297; val_kl_reg_loss: 19843.8219; val_edge_recon_loss: 820427.7049; val_cat_covariates_contrastive_loss: 949957.5573; val_gene_expr_recon_loss: 2020860.6150; val_masked_gp_l1_reg_loss: 14590.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13432.9014; val_global_loss: 3839113.1942; val_optim_loss: 3839113.1942
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9314; val_auprc_score: 0.9834; val_best_acc_score: 0.9298; val_best_f1_score: 0.9597; train_kl_reg_loss: 21794.9517; train_edge_recon_loss: 783645.4028; train_cat_covariates_contrastive_loss: 949370.4934; train_gene_expr_recon_loss: 2015629.8981; train_masked_gp_l1_reg_loss: 14572.0240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13373.5392; train_global_loss: 3798386.3121; train_optim_loss: 3798386.3121; val_kl_reg_loss: 19821.4178; val_edge_recon_loss: 813563.8780; val_cat_covariates_contrastive_loss: 949682.2829; val_gene_expr_recon_loss: 2019128.8202; val_masked_gp_l1_reg_loss: 14557.1143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13335.9385; val_global_loss: 3830089.3974; val_optim_loss: 3830089.3974
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9305; val_auprc_score: 0.9830; val_best_acc_score: 0.9292; val_best_f1_score: 0.9593; train_kl_reg_loss: 21712.6846; train_edge_recon_loss: 781555.0940; train_cat_covariates_contrastive_loss: 949313.8196; train_gene_expr_recon_loss: 2014385.1254; train_masked_gp_l1_reg_loss: 14548.2234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13287.2807; train_global_loss: 3794802.2282; train_optim_loss: 3794802.2282; val_kl_reg_loss: 19678.5044; val_edge_recon_loss: 815260.8663; val_cat_covariates_contrastive_loss: 949335.9049; val_gene_expr_recon_loss: 2019012.4392; val_masked_gp_l1_reg_loss: 14540.3896; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13247.0664; val_global_loss: 3831075.2211; val_optim_loss: 3831075.2211
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9329; val_auprc_score: 0.9836; val_best_acc_score: 0.9290; val_best_f1_score: 0.9592; train_kl_reg_loss: 21683.5555; train_edge_recon_loss: 783933.9654; train_cat_covariates_contrastive_loss: 949528.8823; train_gene_expr_recon_loss: 2012756.4098; train_masked_gp_l1_reg_loss: 14528.2080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13222.1042; train_global_loss: 3795653.1248; train_optim_loss: 3795653.1248; val_kl_reg_loss: 19884.0873; val_edge_recon_loss: 821805.8073; val_cat_covariates_contrastive_loss: 949128.6688; val_gene_expr_recon_loss: 2018149.5762; val_masked_gp_l1_reg_loss: 14514.5791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13215.6162; val_global_loss: 3836698.1315; val_optim_loss: 3836698.1315
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9321; val_auprc_score: 0.9837; val_best_acc_score: 0.9305; val_best_f1_score: 0.9601; train_kl_reg_loss: 21665.6043; train_edge_recon_loss: 783240.5348; train_cat_covariates_contrastive_loss: 949574.4113; train_gene_expr_recon_loss: 2012818.3451; train_masked_gp_l1_reg_loss: 14514.3367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13201.7647; train_global_loss: 3795015.0028; train_optim_loss: 3795015.0028; val_kl_reg_loss: 19922.3102; val_edge_recon_loss: 808574.5007; val_cat_covariates_contrastive_loss: 948945.4731; val_gene_expr_recon_loss: 2017585.7017; val_masked_gp_l1_reg_loss: 14518.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13183.6963; val_global_loss: 3822730.4801; val_optim_loss: 3822730.4801
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9299; val_auprc_score: 0.9828; val_best_acc_score: 0.9300; val_best_f1_score: 0.9597; train_kl_reg_loss: 21604.7919; train_edge_recon_loss: 783094.4640; train_cat_covariates_contrastive_loss: 949386.3807; train_gene_expr_recon_loss: 2012417.4583; train_masked_gp_l1_reg_loss: 14525.7791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13195.9089; train_global_loss: 3794224.7831; train_optim_loss: 3794224.7831; val_kl_reg_loss: 20038.7584; val_edge_recon_loss: 816474.7784; val_cat_covariates_contrastive_loss: 948992.4890; val_gene_expr_recon_loss: 2018264.6892; val_masked_gp_l1_reg_loss: 14532.2705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13199.0186; val_global_loss: 3831501.9641; val_optim_loss: 3831501.9641
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9324; val_auprc_score: 0.9836; val_best_acc_score: 0.9301; val_best_f1_score: 0.9599; train_kl_reg_loss: 21545.4164; train_edge_recon_loss: 781615.9007; train_cat_covariates_contrastive_loss: 949478.3818; train_gene_expr_recon_loss: 2011987.8565; train_masked_gp_l1_reg_loss: 14549.3731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13194.4209; train_global_loss: 3792371.3502; train_optim_loss: 3792371.3502; val_kl_reg_loss: 20028.1608; val_edge_recon_loss: 812880.9582; val_cat_covariates_contrastive_loss: 949719.0598; val_gene_expr_recon_loss: 2016189.3785; val_masked_gp_l1_reg_loss: 14567.4434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13202.6348; val_global_loss: 3826587.8098; val_optim_loss: 3826587.8098
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9327; val_auprc_score: 0.9836; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 21445.8606; train_edge_recon_loss: 784554.3287; train_cat_covariates_contrastive_loss: 949228.7346; train_gene_expr_recon_loss: 2011801.8100; train_masked_gp_l1_reg_loss: 14589.5069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13200.3692; train_global_loss: 3794820.6110; train_optim_loss: 3794820.6110; val_kl_reg_loss: 20055.0429; val_edge_recon_loss: 812842.7515; val_cat_covariates_contrastive_loss: 949753.4893; val_gene_expr_recon_loss: 2015952.2644; val_masked_gp_l1_reg_loss: 14607.3691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13216.1621; val_global_loss: 3826427.0478; val_optim_loss: 3826427.0478
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9320; val_auprc_score: 0.9834; val_best_acc_score: 0.9304; val_best_f1_score: 0.9601; train_kl_reg_loss: 21390.1385; train_edge_recon_loss: 781622.6493; train_cat_covariates_contrastive_loss: 949301.3452; train_gene_expr_recon_loss: 2010854.1001; train_masked_gp_l1_reg_loss: 14626.4839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13204.1689; train_global_loss: 3790998.8835; train_optim_loss: 3790998.8835; val_kl_reg_loss: 20072.5847; val_edge_recon_loss: 813852.0309; val_cat_covariates_contrastive_loss: 948819.2712; val_gene_expr_recon_loss: 2016743.1101; val_masked_gp_l1_reg_loss: 14641.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13208.2764; val_global_loss: 3827336.2410; val_optim_loss: 3827336.2410

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9332; val_auprc_score: 0.9837; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 21379.2449; train_edge_recon_loss: 784282.6077; train_cat_covariates_contrastive_loss: 949099.0882; train_gene_expr_recon_loss: 2011010.7656; train_masked_gp_l1_reg_loss: 14540.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13058.3090; train_global_loss: 3793370.2557; train_optim_loss: 3793370.2557; val_kl_reg_loss: 20059.5608; val_edge_recon_loss: 810069.5423; val_cat_covariates_contrastive_loss: 949520.9355; val_gene_expr_recon_loss: 2013794.8720; val_masked_gp_l1_reg_loss: 14541.8311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13051.7539; val_global_loss: 3821038.4124; val_optim_loss: 3821038.4124
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9316; val_auprc_score: 0.9832; val_best_acc_score: 0.9306; val_best_f1_score: 0.9602; train_kl_reg_loss: 21368.8100; train_edge_recon_loss: 782030.9966; train_cat_covariates_contrastive_loss: 949054.3937; train_gene_expr_recon_loss: 2010872.5784; train_masked_gp_l1_reg_loss: 14543.4913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13047.9490; train_global_loss: 3790918.2251; train_optim_loss: 3790918.2251; val_kl_reg_loss: 20017.2132; val_edge_recon_loss: 813228.1624; val_cat_covariates_contrastive_loss: 949324.8882; val_gene_expr_recon_loss: 2014065.3282; val_masked_gp_l1_reg_loss: 14544.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13047.0957; val_global_loss: 3824227.3406; val_optim_loss: 3824227.3406
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9340; val_auprc_score: 0.9840; val_best_acc_score: 0.9316; val_best_f1_score: 0.9607; train_kl_reg_loss: 21358.2106; train_edge_recon_loss: 782863.8129; train_cat_covariates_contrastive_loss: 949287.1479; train_gene_expr_recon_loss: 2010725.8160; train_masked_gp_l1_reg_loss: 14546.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13046.9456; train_global_loss: 3791828.8021; train_optim_loss: 3791828.8021; val_kl_reg_loss: 20053.8518; val_edge_recon_loss: 812910.6101; val_cat_covariates_contrastive_loss: 949208.7122; val_gene_expr_recon_loss: 2014323.8312; val_masked_gp_l1_reg_loss: 14548.0596; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13045.6484; val_global_loss: 3824090.7490; val_optim_loss: 3824090.7490
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9329; val_auprc_score: 0.9838; val_best_acc_score: 0.9304; val_best_f1_score: 0.9601; train_kl_reg_loss: 21367.1598; train_edge_recon_loss: 782175.4535; train_cat_covariates_contrastive_loss: 949406.3772; train_gene_expr_recon_loss: 2010439.7639; train_masked_gp_l1_reg_loss: 14550.3406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13045.8553; train_global_loss: 3790984.9562; train_optim_loss: 3790984.9562; val_kl_reg_loss: 20075.7168; val_edge_recon_loss: 810071.8680; val_cat_covariates_contrastive_loss: 949494.9485; val_gene_expr_recon_loss: 2015895.8536; val_masked_gp_l1_reg_loss: 14551.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13048.2598; val_global_loss: 3823138.6404; val_optim_loss: 3823138.6404
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9347; val_auprc_score: 0.9846; val_best_acc_score: 0.9309; val_best_f1_score: 0.9603; train_kl_reg_loss: 21374.2969; train_edge_recon_loss: 781727.9959; train_cat_covariates_contrastive_loss: 949336.5188; train_gene_expr_recon_loss: 2011349.8746; train_masked_gp_l1_reg_loss: 14553.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13046.3217; train_global_loss: 3791388.0819; train_optim_loss: 3791388.0819; val_kl_reg_loss: 20112.6936; val_edge_recon_loss: 810499.7321; val_cat_covariates_contrastive_loss: 949710.4788; val_gene_expr_recon_loss: 2016000.2082; val_masked_gp_l1_reg_loss: 14554.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13044.2754; val_global_loss: 3823921.6096; val_optim_loss: 3823921.6096

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9320; val_auprc_score: 0.9834; val_best_acc_score: 0.9306; val_best_f1_score: 0.9602; train_kl_reg_loss: 21380.4639; train_edge_recon_loss: 783091.7741; train_cat_covariates_contrastive_loss: 949369.5300; train_gene_expr_recon_loss: 2011036.3958; train_masked_gp_l1_reg_loss: 14544.0041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13029.3265; train_global_loss: 3792451.5119; train_optim_loss: 3792451.5119; val_kl_reg_loss: 20114.7568; val_edge_recon_loss: 815865.0538; val_cat_covariates_contrastive_loss: 949867.4848; val_gene_expr_recon_loss: 2017255.8765; val_masked_gp_l1_reg_loss: 14544.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13028.1484; val_global_loss: 3830675.4104; val_optim_loss: 3830675.4104
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9318; val_auprc_score: 0.9832; val_best_acc_score: 0.9310; val_best_f1_score: 0.9604; train_kl_reg_loss: 21382.6948; train_edge_recon_loss: 783192.1104; train_cat_covariates_contrastive_loss: 949212.9512; train_gene_expr_recon_loss: 2011913.1724; train_masked_gp_l1_reg_loss: 14544.1568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13027.6952; train_global_loss: 3793272.7931; train_optim_loss: 3793272.7931; val_kl_reg_loss: 20094.2027; val_edge_recon_loss: 817102.6128; val_cat_covariates_contrastive_loss: 949561.3329; val_gene_expr_recon_loss: 2016493.2555; val_masked_gp_l1_reg_loss: 14544.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13027.2676; val_global_loss: 3830822.9094; val_optim_loss: 3830822.9094
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9318; val_auprc_score: 0.9832; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 21389.2198; train_edge_recon_loss: 782771.0048; train_cat_covariates_contrastive_loss: 949175.3470; train_gene_expr_recon_loss: 2012039.4151; train_masked_gp_l1_reg_loss: 14544.3522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13027.1993; train_global_loss: 3792946.5484; train_optim_loss: 3792946.5484; val_kl_reg_loss: 20085.2021; val_edge_recon_loss: 816706.3536; val_cat_covariates_contrastive_loss: 949299.0326; val_gene_expr_recon_loss: 2014829.0493; val_masked_gp_l1_reg_loss: 14544.5127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13027.1074; val_global_loss: 3828491.1325; val_optim_loss: 3828491.1325
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9309; val_auprc_score: 0.9831; val_best_acc_score: 0.9288; val_best_f1_score: 0.9593; train_kl_reg_loss: 21382.6362; train_edge_recon_loss: 783474.9064; train_cat_covariates_contrastive_loss: 949249.5577; train_gene_expr_recon_loss: 2011575.9996; train_masked_gp_l1_reg_loss: 14544.5972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13027.0882; train_global_loss: 3793254.7541; train_optim_loss: 3793254.7541; val_kl_reg_loss: 20096.3097; val_edge_recon_loss: 821488.7844; val_cat_covariates_contrastive_loss: 949719.3623; val_gene_expr_recon_loss: 2017002.1389; val_masked_gp_l1_reg_loss: 14544.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13026.9951; val_global_loss: 3835878.3416; val_optim_loss: 3835878.3416

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 656 min 38 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9180
val AUPRC score: 0.9765
val best accuracy score: 0.9283
val best F1 score: 0.9588
val target rna MSE score: 0.4954
val source rna MSE score: 0.2333
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0440
Val cat covariate2 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
