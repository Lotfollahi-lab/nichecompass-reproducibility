[True, False, True]
Run timestamp: 28092023_161247_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 405224
Number of validation nodes: 45025
Number of training edges: 958516
Number of validation edges: 106501
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8942; val_auprc_score: 0.9710; val_best_acc_score: 0.8970; val_best_f1_score: 0.9399; train_kl_reg_loss: 16946.0999; train_edge_recon_loss: 964708.7225; train_cat_covariates_contrastive_loss: 947098.4126; train_gene_expr_recon_loss: 2930987.7049; train_masked_gp_l1_reg_loss: 29364.6013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113582.4381; train_global_loss: 5002687.9875; train_optim_loss: 5002687.9875; val_kl_reg_loss: 14692.1465; val_edge_recon_loss: 969445.6217; val_cat_covariates_contrastive_loss: 948485.8864; val_gene_expr_recon_loss: 2799146.8373; val_masked_gp_l1_reg_loss: 19440.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21235.2383; val_global_loss: 4772446.5072; val_optim_loss: 4772446.5072
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9179; val_auprc_score: 0.9778; val_best_acc_score: 0.9117; val_best_f1_score: 0.9483; train_kl_reg_loss: 15515.6477; train_edge_recon_loss: 925917.7141; train_cat_covariates_contrastive_loss: 944653.2314; train_gene_expr_recon_loss: 2736270.6389; train_masked_gp_l1_reg_loss: 19532.4503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21634.6691; train_global_loss: 4663524.3532; train_optim_loss: 4663524.3532; val_kl_reg_loss: 17242.8091; val_edge_recon_loss: 945911.5751; val_cat_covariates_contrastive_loss: 952588.8627; val_gene_expr_recon_loss: 2652484.2572; val_masked_gp_l1_reg_loss: 19921.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21968.0312; val_global_loss: 4610116.5167; val_optim_loss: 4610116.5167
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9191; val_auprc_score: 0.9769; val_best_acc_score: 0.9151; val_best_f1_score: 0.9502; train_kl_reg_loss: 19298.9337; train_edge_recon_loss: 918706.6093; train_cat_covariates_contrastive_loss: 948399.4921; train_gene_expr_recon_loss: 2583085.8979; train_masked_gp_l1_reg_loss: 20779.5990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22553.2693; train_global_loss: 4512823.8019; train_optim_loss: 4512823.8019; val_kl_reg_loss: 20753.2150; val_edge_recon_loss: 953173.5715; val_cat_covariates_contrastive_loss: 950204.1322; val_gene_expr_recon_loss: 2540913.4713; val_masked_gp_l1_reg_loss: 21747.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22837.9043; val_global_loss: 4509629.8816; val_optim_loss: 4509629.8816
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9290; val_auprc_score: 0.9797; val_best_acc_score: 0.9214; val_best_f1_score: 0.9535; train_kl_reg_loss: 20596.2630; train_edge_recon_loss: 920236.6782; train_cat_covariates_contrastive_loss: 948887.0629; train_gene_expr_recon_loss: 2520123.4119; train_masked_gp_l1_reg_loss: 22809.6198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23285.6957; train_global_loss: 4455938.7329; train_optim_loss: 4455938.7329; val_kl_reg_loss: 21239.9962; val_edge_recon_loss: 948116.0338; val_cat_covariates_contrastive_loss: 953045.9393; val_gene_expr_recon_loss: 2507907.1699; val_masked_gp_l1_reg_loss: 23810.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23459.3516; val_global_loss: 4477579.6411; val_optim_loss: 4477579.6411
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9329; val_auprc_score: 0.9812; val_best_acc_score: 0.9222; val_best_f1_score: 0.9540; train_kl_reg_loss: 21346.0464; train_edge_recon_loss: 917811.7988; train_cat_covariates_contrastive_loss: 949063.8454; train_gene_expr_recon_loss: 2493788.4086; train_masked_gp_l1_reg_loss: 24512.4746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23877.6581; train_global_loss: 4430400.2320; train_optim_loss: 4430400.2320; val_kl_reg_loss: 21713.7170; val_edge_recon_loss: 950290.1902; val_cat_covariates_contrastive_loss: 948946.2105; val_gene_expr_recon_loss: 2488062.7057; val_masked_gp_l1_reg_loss: 25141.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23916.6953; val_global_loss: 4458070.7847; val_optim_loss: 4458070.7847
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9310; val_auprc_score: 0.9793; val_best_acc_score: 0.9255; val_best_f1_score: 0.9560; train_kl_reg_loss: 22139.3751; train_edge_recon_loss: 912347.9951; train_cat_covariates_contrastive_loss: 949544.6747; train_gene_expr_recon_loss: 2475804.5008; train_masked_gp_l1_reg_loss: 25846.4197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24463.3071; train_global_loss: 4410146.2651; train_optim_loss: 4410146.2651; val_kl_reg_loss: 22881.5951; val_edge_recon_loss: 947717.2045; val_cat_covariates_contrastive_loss: 949191.1705; val_gene_expr_recon_loss: 2473859.1699; val_masked_gp_l1_reg_loss: 26416.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24955.6504; val_global_loss: 4445021.1423; val_optim_loss: 4445021.1423
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9247; val_auprc_score: 0.9771; val_best_acc_score: 0.9214; val_best_f1_score: 0.9535; train_kl_reg_loss: 23030.0782; train_edge_recon_loss: 914235.8482; train_cat_covariates_contrastive_loss: 949866.9439; train_gene_expr_recon_loss: 2461696.7236; train_masked_gp_l1_reg_loss: 26750.4368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25470.3713; train_global_loss: 4401050.4030; train_optim_loss: 4401050.4030; val_kl_reg_loss: 24681.0590; val_edge_recon_loss: 960799.8499; val_cat_covariates_contrastive_loss: 951110.7342; val_gene_expr_recon_loss: 2462110.1591; val_masked_gp_l1_reg_loss: 26972.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25696.3691; val_global_loss: 4451370.7943; val_optim_loss: 4451370.7943
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9360; val_auprc_score: 0.9814; val_best_acc_score: 0.9271; val_best_f1_score: 0.9569; train_kl_reg_loss: 23792.6096; train_edge_recon_loss: 916917.2890; train_cat_covariates_contrastive_loss: 950360.9444; train_gene_expr_recon_loss: 2448689.6590; train_masked_gp_l1_reg_loss: 27375.5757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26160.1645; train_global_loss: 4393296.2359; train_optim_loss: 4393296.2359; val_kl_reg_loss: 23965.2184; val_edge_recon_loss: 945323.8828; val_cat_covariates_contrastive_loss: 951277.8278; val_gene_expr_recon_loss: 2452744.5132; val_masked_gp_l1_reg_loss: 27710.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26265.9453; val_global_loss: 4427288.4450; val_optim_loss: 4427288.4450
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9392; val_auprc_score: 0.9821; val_best_acc_score: 0.9280; val_best_f1_score: 0.9574; train_kl_reg_loss: 24439.0047; train_edge_recon_loss: 914932.9448; train_cat_covariates_contrastive_loss: 950514.4981; train_gene_expr_recon_loss: 2439420.7710; train_masked_gp_l1_reg_loss: 27986.5195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26536.4895; train_global_loss: 4383830.2277; train_optim_loss: 4383830.2277; val_kl_reg_loss: 24349.4568; val_edge_recon_loss: 948004.7978; val_cat_covariates_contrastive_loss: 953785.1121; val_gene_expr_recon_loss: 2438450.4821; val_masked_gp_l1_reg_loss: 28075.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26740.7988; val_global_loss: 4419406.8517; val_optim_loss: 4419406.8517
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9393; val_auprc_score: 0.9821; val_best_acc_score: 0.9280; val_best_f1_score: 0.9573; train_kl_reg_loss: 24955.3426; train_edge_recon_loss: 914174.2078; train_cat_covariates_contrastive_loss: 950675.5869; train_gene_expr_recon_loss: 2431844.0320; train_masked_gp_l1_reg_loss: 28189.1862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26739.6509; train_global_loss: 4376578.0088; train_optim_loss: 4376578.0088; val_kl_reg_loss: 25509.3856; val_edge_recon_loss: 962664.5051; val_cat_covariates_contrastive_loss: 958034.3645; val_gene_expr_recon_loss: 2435163.1950; val_masked_gp_l1_reg_loss: 28293.1855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26959.2129; val_global_loss: 4436623.4498; val_optim_loss: 4436623.4498
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9408; val_auprc_score: 0.9829; val_best_acc_score: 0.9294; val_best_f1_score: 0.9582; train_kl_reg_loss: 25334.7244; train_edge_recon_loss: 915457.1575; train_cat_covariates_contrastive_loss: 951059.5330; train_gene_expr_recon_loss: 2427576.2750; train_masked_gp_l1_reg_loss: 28367.2950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26961.8433; train_global_loss: 4374756.8253; train_optim_loss: 4374756.8253; val_kl_reg_loss: 26441.8556; val_edge_recon_loss: 944015.7632; val_cat_covariates_contrastive_loss: 952774.2712; val_gene_expr_recon_loss: 2430930.2763; val_masked_gp_l1_reg_loss: 28413.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26707.0078; val_global_loss: 4409283.1663; val_optim_loss: 4409283.1663
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9394; val_auprc_score: 0.9818; val_best_acc_score: 0.9292; val_best_f1_score: 0.9580; train_kl_reg_loss: 25674.5662; train_edge_recon_loss: 913677.7511; train_cat_covariates_contrastive_loss: 950872.6223; train_gene_expr_recon_loss: 2420905.4885; train_masked_gp_l1_reg_loss: 28528.4382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27069.0361; train_global_loss: 4366727.9126; train_optim_loss: 4366727.9126; val_kl_reg_loss: 26200.5686; val_edge_recon_loss: 951063.8544; val_cat_covariates_contrastive_loss: 955171.4429; val_gene_expr_recon_loss: 2429029.1160; val_masked_gp_l1_reg_loss: 28568.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27321.3965; val_global_loss: 4417354.9677; val_optim_loss: 4417354.9677
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9435; val_auprc_score: 0.9831; val_best_acc_score: 0.9334; val_best_f1_score: 0.9605; train_kl_reg_loss: 25884.2706; train_edge_recon_loss: 912773.3973; train_cat_covariates_contrastive_loss: 951025.2583; train_gene_expr_recon_loss: 2417502.8561; train_masked_gp_l1_reg_loss: 28628.6033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27344.6781; train_global_loss: 4363159.0649; train_optim_loss: 4363159.0649; val_kl_reg_loss: 25914.7655; val_edge_recon_loss: 951102.7587; val_cat_covariates_contrastive_loss: 956308.9557; val_gene_expr_recon_loss: 2419915.6364; val_masked_gp_l1_reg_loss: 28535.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27600.8066; val_global_loss: 4409378.1112; val_optim_loss: 4409378.1112
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9414; val_auprc_score: 0.9821; val_best_acc_score: 0.9334; val_best_f1_score: 0.9604; train_kl_reg_loss: 26185.5582; train_edge_recon_loss: 914552.8782; train_cat_covariates_contrastive_loss: 951057.8522; train_gene_expr_recon_loss: 2412626.1005; train_masked_gp_l1_reg_loss: 28770.4188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27519.5136; train_global_loss: 4360712.3173; train_optim_loss: 4360712.3173; val_kl_reg_loss: 26565.9524; val_edge_recon_loss: 952217.2312; val_cat_covariates_contrastive_loss: 951192.2569; val_gene_expr_recon_loss: 2415380.5144; val_masked_gp_l1_reg_loss: 28840.3848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27925.7734; val_global_loss: 4402122.4378; val_optim_loss: 4402122.4378
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9467; val_auprc_score: 0.9845; val_best_acc_score: 0.9330; val_best_f1_score: 0.9602; train_kl_reg_loss: 26338.8006; train_edge_recon_loss: 913807.7863; train_cat_covariates_contrastive_loss: 951175.1533; train_gene_expr_recon_loss: 2409489.2995; train_masked_gp_l1_reg_loss: 28909.4989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27705.7154; train_global_loss: 4357426.2507; train_optim_loss: 4357426.2507; val_kl_reg_loss: 25995.0778; val_edge_recon_loss: 946412.0305; val_cat_covariates_contrastive_loss: 956468.6746; val_gene_expr_recon_loss: 2411421.6471; val_masked_gp_l1_reg_loss: 28980.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27990.4297; val_global_loss: 4397268.9043; val_optim_loss: 4397268.9043
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9407; val_auprc_score: 0.9823; val_best_acc_score: 0.9295; val_best_f1_score: 0.9580; train_kl_reg_loss: 26662.5485; train_edge_recon_loss: 914671.1181; train_cat_covariates_contrastive_loss: 951421.2689; train_gene_expr_recon_loss: 2404234.8879; train_masked_gp_l1_reg_loss: 29103.6068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27957.3674; train_global_loss: 4354050.8061; train_optim_loss: 4354050.8061; val_kl_reg_loss: 26949.7819; val_edge_recon_loss: 955772.8517; val_cat_covariates_contrastive_loss: 953914.6749; val_gene_expr_recon_loss: 2406863.1411; val_masked_gp_l1_reg_loss: 29129.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28077.9648; val_global_loss: 4400707.9498; val_optim_loss: 4400707.9498
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9362; val_auprc_score: 0.9807; val_best_acc_score: 0.9294; val_best_f1_score: 0.9582; train_kl_reg_loss: 26856.9226; train_edge_recon_loss: 912648.8229; train_cat_covariates_contrastive_loss: 951166.0849; train_gene_expr_recon_loss: 2400360.9317; train_masked_gp_l1_reg_loss: 29274.4019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28201.0912; train_global_loss: 4348508.2455; train_optim_loss: 4348508.2455; val_kl_reg_loss: 28457.3385; val_edge_recon_loss: 948347.4228; val_cat_covariates_contrastive_loss: 951454.9330; val_gene_expr_recon_loss: 2408674.6100; val_masked_gp_l1_reg_loss: 29318.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28420.9902; val_global_loss: 4394673.7967; val_optim_loss: 4394673.7967
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9417; val_auprc_score: 0.9821; val_best_acc_score: 0.9327; val_best_f1_score: 0.9600; train_kl_reg_loss: 27113.7530; train_edge_recon_loss: 914301.9897; train_cat_covariates_contrastive_loss: 951451.5741; train_gene_expr_recon_loss: 2398153.8320; train_masked_gp_l1_reg_loss: 29370.8367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28425.8461; train_global_loss: 4348817.8304; train_optim_loss: 4348817.8304; val_kl_reg_loss: 28251.5505; val_edge_recon_loss: 956458.4175; val_cat_covariates_contrastive_loss: 953563.5631; val_gene_expr_recon_loss: 2401910.5490; val_masked_gp_l1_reg_loss: 29210.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28389.9922; val_global_loss: 4397784.5730; val_optim_loss: 4397784.5730
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9422; val_auprc_score: 0.9825; val_best_acc_score: 0.9312; val_best_f1_score: 0.9592; train_kl_reg_loss: 27670.8430; train_edge_recon_loss: 912300.6909; train_cat_covariates_contrastive_loss: 951813.1505; train_gene_expr_recon_loss: 2395748.6383; train_masked_gp_l1_reg_loss: 29405.3636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28753.9081; train_global_loss: 4345692.6012; train_optim_loss: 4345692.6012; val_kl_reg_loss: 28442.5622; val_edge_recon_loss: 951143.4109; val_cat_covariates_contrastive_loss: 953208.1187; val_gene_expr_recon_loss: 2399474.0191; val_masked_gp_l1_reg_loss: 29513.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28827.7891; val_global_loss: 4390609.5945; val_optim_loss: 4390609.5945
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9375; val_auprc_score: 0.9809; val_best_acc_score: 0.9299; val_best_f1_score: 0.9584; train_kl_reg_loss: 29958.4552; train_edge_recon_loss: 915078.9382; train_cat_covariates_contrastive_loss: 952500.1085; train_gene_expr_recon_loss: 2412452.4503; train_masked_gp_l1_reg_loss: 29781.3578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28881.2284; train_global_loss: 4368652.5374; train_optim_loss: 4368652.5374; val_kl_reg_loss: 30676.7216; val_edge_recon_loss: 944636.7022; val_cat_covariates_contrastive_loss: 951921.6597; val_gene_expr_recon_loss: 2395686.1244; val_masked_gp_l1_reg_loss: 29510.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28796.4590; val_global_loss: 4381227.6950; val_optim_loss: 4381227.6950
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9448; val_auprc_score: 0.9836; val_best_acc_score: 0.9341; val_best_f1_score: 0.9610; train_kl_reg_loss: 149925889.6586; train_edge_recon_loss: 913001.3543; train_cat_covariates_contrastive_loss: 952159.6049; train_gene_expr_recon_loss: 2394136.2859; train_masked_gp_l1_reg_loss: 29870.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28991.3170; train_global_loss: 154244053.0722; train_optim_loss: 154244053.0722; val_kl_reg_loss: 30943.9912; val_edge_recon_loss: 944820.5278; val_cat_covariates_contrastive_loss: 957169.9094; val_gene_expr_recon_loss: 2406308.4294; val_masked_gp_l1_reg_loss: 29748.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28988.0430; val_global_loss: 4397979.3648; val_optim_loss: 4397979.3648
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9295; val_auprc_score: 0.9784; val_best_acc_score: 0.9272; val_best_f1_score: 0.9569; train_kl_reg_loss: 52444.1726; train_edge_recon_loss: 914214.7748; train_cat_covariates_contrastive_loss: 952860.1992; train_gene_expr_recon_loss: 2394953.0784; train_masked_gp_l1_reg_loss: 29867.8716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29102.1351; train_global_loss: 4373442.2388; train_optim_loss: 4373442.2388; val_kl_reg_loss: 34902.8890; val_edge_recon_loss: 953432.0185; val_cat_covariates_contrastive_loss: 953628.5810; val_gene_expr_recon_loss: 2410863.7883; val_masked_gp_l1_reg_loss: 29874.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29208.6836; val_global_loss: 4411910.2691; val_optim_loss: 4411910.2691
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9467; val_auprc_score: 0.9837; val_best_acc_score: 0.9368; val_best_f1_score: 0.9626; train_kl_reg_loss: 31196.2156; train_edge_recon_loss: 916596.5881; train_cat_covariates_contrastive_loss: 952644.6323; train_gene_expr_recon_loss: 2392111.0178; train_masked_gp_l1_reg_loss: 30075.8952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29318.9976; train_global_loss: 4351943.3484; train_optim_loss: 4351943.3484; val_kl_reg_loss: 31161.1704; val_edge_recon_loss: 942863.4943; val_cat_covariates_contrastive_loss: 959048.6606; val_gene_expr_recon_loss: 2390364.1651; val_masked_gp_l1_reg_loss: 30114.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29528.2715; val_global_loss: 4383080.4940; val_optim_loss: 4383080.4940
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9395; val_auprc_score: 0.9817; val_best_acc_score: 0.9328; val_best_f1_score: 0.9601; train_kl_reg_loss: 1436050205.8200; train_edge_recon_loss: 915935.8348; train_cat_covariates_contrastive_loss: 952850.4230; train_gene_expr_recon_loss: 2401447.9369; train_masked_gp_l1_reg_loss: 30111.6107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29536.7165; train_global_loss: 1440380106.7883; train_optim_loss: 1440380106.7883; val_kl_reg_loss: 35497.5913; val_edge_recon_loss: 950424.0523; val_cat_covariates_contrastive_loss: 956517.8597; val_gene_expr_recon_loss: 2415883.9055; val_masked_gp_l1_reg_loss: 29997.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29451.6719; val_global_loss: 4417772.4246; val_optim_loss: 4417772.4246

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9463; val_auprc_score: 0.9835; val_best_acc_score: 0.9364; val_best_f1_score: 0.9622; train_kl_reg_loss: 34211.3141; train_edge_recon_loss: 913115.0873; train_cat_covariates_contrastive_loss: 952973.3871; train_gene_expr_recon_loss: 2389799.5414; train_masked_gp_l1_reg_loss: 19526.7264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16292.0994; train_global_loss: 4325918.1542; train_optim_loss: 4325918.1542; val_kl_reg_loss: 33903.7428; val_edge_recon_loss: 943338.2984; val_cat_covariates_contrastive_loss: 952170.7500; val_gene_expr_recon_loss: 2388396.7596; val_masked_gp_l1_reg_loss: 19473.0332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16179.9717; val_global_loss: 4353462.5347; val_optim_loss: 4353462.5347
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9269; val_auprc_score: 0.9785; val_best_acc_score: 0.9203; val_best_f1_score: 0.9531; train_kl_reg_loss: 29572.4045; train_edge_recon_loss: 923797.0106; train_cat_covariates_contrastive_loss: 952483.8802; train_gene_expr_recon_loss: 2098011.3092; train_masked_gp_l1_reg_loss: 17023.3309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15333.5844; train_global_loss: 4036221.5224; train_optim_loss: 4036221.5224; val_kl_reg_loss: 22310.2399; val_edge_recon_loss: 952172.5798; val_cat_covariates_contrastive_loss: 950829.6522; val_gene_expr_recon_loss: 2096539.1459; val_masked_gp_l1_reg_loss: 15156.0674; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14534.1113; val_global_loss: 4051541.6256; val_optim_loss: 4051541.6256
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9296; val_auprc_score: 0.9801; val_best_acc_score: 0.9216; val_best_f1_score: 0.9539; train_kl_reg_loss: 27077.1147; train_edge_recon_loss: 918859.8046; train_cat_covariates_contrastive_loss: 951310.0750; train_gene_expr_recon_loss: 2087971.1519; train_masked_gp_l1_reg_loss: 14362.3751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14058.3043; train_global_loss: 4013638.8265; train_optim_loss: 4013638.8265; val_kl_reg_loss: 22560.0899; val_edge_recon_loss: 947801.5440; val_cat_covariates_contrastive_loss: 954976.2252; val_gene_expr_recon_loss: 2091974.6501; val_masked_gp_l1_reg_loss: 13952.6045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13872.4287; val_global_loss: 4045137.5000; val_optim_loss: 4045137.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9313; val_auprc_score: 0.9799; val_best_acc_score: 0.9227; val_best_f1_score: 0.9543; train_kl_reg_loss: 25591.8955; train_edge_recon_loss: 918171.4191; train_cat_covariates_contrastive_loss: 950733.5558; train_gene_expr_recon_loss: 2085221.1776; train_masked_gp_l1_reg_loss: 13797.6843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13860.3940; train_global_loss: 4007376.1209; train_optim_loss: 4007376.1209; val_kl_reg_loss: 22536.9604; val_edge_recon_loss: 955589.0380; val_cat_covariates_contrastive_loss: 952898.6758; val_gene_expr_recon_loss: 2086716.9013; val_masked_gp_l1_reg_loss: 13716.8340; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13894.9795; val_global_loss: 4045353.3182; val_optim_loss: 4045353.3182
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9342; val_auprc_score: 0.9809; val_best_acc_score: 0.9240; val_best_f1_score: 0.9550; train_kl_reg_loss: 24647.7553; train_edge_recon_loss: 919227.1148; train_cat_covariates_contrastive_loss: 950781.0293; train_gene_expr_recon_loss: 2081597.7597; train_masked_gp_l1_reg_loss: 13652.0097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13859.2301; train_global_loss: 4003764.8988; train_optim_loss: 4003764.8988; val_kl_reg_loss: 22812.5922; val_edge_recon_loss: 959005.5144; val_cat_covariates_contrastive_loss: 953772.8702; val_gene_expr_recon_loss: 2085633.4671; val_masked_gp_l1_reg_loss: 13663.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13842.5088; val_global_loss: 4048729.9426; val_optim_loss: 4048729.9426
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9367; val_auprc_score: 0.9816; val_best_acc_score: 0.9267; val_best_f1_score: 0.9566; train_kl_reg_loss: 24178.1231; train_edge_recon_loss: 914787.7926; train_cat_covariates_contrastive_loss: 950925.2681; train_gene_expr_recon_loss: 2078409.9031; train_masked_gp_l1_reg_loss: 13655.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13867.2301; train_global_loss: 3995823.6442; train_optim_loss: 3995823.6442; val_kl_reg_loss: 22530.7819; val_edge_recon_loss: 955624.0314; val_cat_covariates_contrastive_loss: 953879.4222; val_gene_expr_recon_loss: 2080999.1998; val_masked_gp_l1_reg_loss: 13679.3418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13882.4541; val_global_loss: 4040595.1806; val_optim_loss: 4040595.1806
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9333; val_auprc_score: 0.9804; val_best_acc_score: 0.9258; val_best_f1_score: 0.9562; train_kl_reg_loss: 23941.2994; train_edge_recon_loss: 916250.1893; train_cat_covariates_contrastive_loss: 950614.7940; train_gene_expr_recon_loss: 2076483.0189; train_masked_gp_l1_reg_loss: 13696.0569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13855.3203; train_global_loss: 3994840.6805; train_optim_loss: 3994840.6805; val_kl_reg_loss: 23059.4081; val_edge_recon_loss: 948029.3947; val_cat_covariates_contrastive_loss: 957101.1316; val_gene_expr_recon_loss: 2080903.0520; val_masked_gp_l1_reg_loss: 13733.3184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13825.0498; val_global_loss: 4036651.2476; val_optim_loss: 4036651.2476
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9363; val_auprc_score: 0.9811; val_best_acc_score: 0.9255; val_best_f1_score: 0.9560; train_kl_reg_loss: 23721.6873; train_edge_recon_loss: 914328.7821; train_cat_covariates_contrastive_loss: 950426.0320; train_gene_expr_recon_loss: 2074671.3003; train_masked_gp_l1_reg_loss: 13749.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13854.8687; train_global_loss: 3990752.2153; train_optim_loss: 3990752.2153; val_kl_reg_loss: 22510.9949; val_edge_recon_loss: 961048.4713; val_cat_covariates_contrastive_loss: 954385.2261; val_gene_expr_recon_loss: 2077891.7285; val_masked_gp_l1_reg_loss: 13780.0576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13892.7354; val_global_loss: 4043509.1579; val_optim_loss: 4043509.1579
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9361; val_auprc_score: 0.9810; val_best_acc_score: 0.9271; val_best_f1_score: 0.9568; train_kl_reg_loss: 23554.1096; train_edge_recon_loss: 911312.4899; train_cat_covariates_contrastive_loss: 950301.4473; train_gene_expr_recon_loss: 2074411.3867; train_masked_gp_l1_reg_loss: 13800.5757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13872.9312; train_global_loss: 3987252.9414; train_optim_loss: 3987252.9414; val_kl_reg_loss: 22908.3470; val_edge_recon_loss: 949823.9225; val_cat_covariates_contrastive_loss: 952728.7835; val_gene_expr_recon_loss: 2077528.7757; val_masked_gp_l1_reg_loss: 13829.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13870.1348; val_global_loss: 4030689.3313; val_optim_loss: 4030689.3313
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9394; val_auprc_score: 0.9820; val_best_acc_score: 0.9273; val_best_f1_score: 0.9570; train_kl_reg_loss: 23418.3951; train_edge_recon_loss: 913601.5361; train_cat_covariates_contrastive_loss: 950284.9596; train_gene_expr_recon_loss: 2072316.1440; train_masked_gp_l1_reg_loss: 13852.9938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13890.2771; train_global_loss: 3987364.3089; train_optim_loss: 3987364.3089; val_kl_reg_loss: 22720.4763; val_edge_recon_loss: 965077.2117; val_cat_covariates_contrastive_loss: 956332.2479; val_gene_expr_recon_loss: 2075793.8481; val_masked_gp_l1_reg_loss: 13845.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13869.5996; val_global_loss: 4047639.0311; val_optim_loss: 4047639.0311
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9391; val_auprc_score: 0.9823; val_best_acc_score: 0.9289; val_best_f1_score: 0.9581; train_kl_reg_loss: 23208.4387; train_edge_recon_loss: 913728.6177; train_cat_covariates_contrastive_loss: 950174.9574; train_gene_expr_recon_loss: 2071925.6614; train_masked_gp_l1_reg_loss: 13885.2059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13898.7314; train_global_loss: 3986821.6095; train_optim_loss: 3986821.6095; val_kl_reg_loss: 22747.9045; val_edge_recon_loss: 936464.0640; val_cat_covariates_contrastive_loss: 955827.0760; val_gene_expr_recon_loss: 2074921.1992; val_masked_gp_l1_reg_loss: 13875.8340; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13888.6338; val_global_loss: 4017724.7500; val_optim_loss: 4017724.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9379; val_auprc_score: 0.9813; val_best_acc_score: 0.9292; val_best_f1_score: 0.9580; train_kl_reg_loss: 23024.1719; train_edge_recon_loss: 912932.6335; train_cat_covariates_contrastive_loss: 950146.7758; train_gene_expr_recon_loss: 2071279.4996; train_masked_gp_l1_reg_loss: 13930.1593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13931.8221; train_global_loss: 3985245.0618; train_optim_loss: 3985245.0618; val_kl_reg_loss: 22388.6614; val_edge_recon_loss: 956400.8442; val_cat_covariates_contrastive_loss: 954243.3242; val_gene_expr_recon_loss: 2075585.7171; val_masked_gp_l1_reg_loss: 13937.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13919.8057; val_global_loss: 4036475.5443; val_optim_loss: 4036475.5443
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9383; val_auprc_score: 0.9815; val_best_acc_score: 0.9289; val_best_f1_score: 0.9578; train_kl_reg_loss: 22942.6592; train_edge_recon_loss: 912424.5837; train_cat_covariates_contrastive_loss: 950101.0837; train_gene_expr_recon_loss: 2070547.9813; train_masked_gp_l1_reg_loss: 13985.2897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13935.2363; train_global_loss: 3983936.8360; train_optim_loss: 3983936.8360; val_kl_reg_loss: 22427.3885; val_edge_recon_loss: 948047.6633; val_cat_covariates_contrastive_loss: 957492.9040; val_gene_expr_recon_loss: 2073867.7093; val_masked_gp_l1_reg_loss: 13979.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13992.5879; val_global_loss: 4029808.1675; val_optim_loss: 4029808.1675
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9387; val_auprc_score: 0.9816; val_best_acc_score: 0.9296; val_best_f1_score: 0.9584; train_kl_reg_loss: 22809.1457; train_edge_recon_loss: 912043.3810; train_cat_covariates_contrastive_loss: 950054.0730; train_gene_expr_recon_loss: 2070565.4255; train_masked_gp_l1_reg_loss: 14022.8882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13937.9537; train_global_loss: 3983432.8735; train_optim_loss: 3983432.8735; val_kl_reg_loss: 22216.6921; val_edge_recon_loss: 953766.3684; val_cat_covariates_contrastive_loss: 954008.3212; val_gene_expr_recon_loss: 2072968.5921; val_masked_gp_l1_reg_loss: 14030.4619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13994.1680; val_global_loss: 4030984.7129; val_optim_loss: 4030984.7129
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9409; val_auprc_score: 0.9826; val_best_acc_score: 0.9297; val_best_f1_score: 0.9584; train_kl_reg_loss: 22815.7227; train_edge_recon_loss: 912077.1743; train_cat_covariates_contrastive_loss: 950002.0133; train_gene_expr_recon_loss: 2068991.1084; train_masked_gp_l1_reg_loss: 14056.3765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13932.7061; train_global_loss: 3981875.1053; train_optim_loss: 3981875.1053; val_kl_reg_loss: 31884.9922; val_edge_recon_loss: 944343.5404; val_cat_covariates_contrastive_loss: 951216.2010; val_gene_expr_recon_loss: 2070418.7751; val_masked_gp_l1_reg_loss: 14107.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14001.4219; val_global_loss: 4025972.7440; val_optim_loss: 4025972.7440

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9384; val_auprc_score: 0.9817; val_best_acc_score: 0.9295; val_best_f1_score: 0.9583; train_kl_reg_loss: 22691.6667; train_edge_recon_loss: 910344.7678; train_cat_covariates_contrastive_loss: 949792.2241; train_gene_expr_recon_loss: 2067405.5918; train_masked_gp_l1_reg_loss: 13183.8001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12698.7435; train_global_loss: 3976116.7956; train_optim_loss: 3976116.7956; val_kl_reg_loss: 28617.7102; val_edge_recon_loss: 939559.8535; val_cat_covariates_contrastive_loss: 950947.7584; val_gene_expr_recon_loss: 2072482.2147; val_masked_gp_l1_reg_loss: 13182.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12652.8623; val_global_loss: 4017442.5371; val_optim_loss: 4017442.5371
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9397; val_auprc_score: 0.9818; val_best_acc_score: 0.9292; val_best_f1_score: 0.9581; train_kl_reg_loss: 22682.5506; train_edge_recon_loss: 911140.1964; train_cat_covariates_contrastive_loss: 949758.0279; train_gene_expr_recon_loss: 2067891.7816; train_masked_gp_l1_reg_loss: 13182.3827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12658.7991; train_global_loss: 3977313.7405; train_optim_loss: 3977313.7405; val_kl_reg_loss: 22311.6685; val_edge_recon_loss: 956932.3556; val_cat_covariates_contrastive_loss: 951612.4348; val_gene_expr_recon_loss: 2071652.4276; val_masked_gp_l1_reg_loss: 13182.6943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12657.1133; val_global_loss: 4028348.6376; val_optim_loss: 4028348.6376
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9399; val_auprc_score: 0.9821; val_best_acc_score: 0.9300; val_best_f1_score: 0.9586; train_kl_reg_loss: 22671.0552; train_edge_recon_loss: 913123.0514; train_cat_covariates_contrastive_loss: 949711.3111; train_gene_expr_recon_loss: 2067536.5936; train_masked_gp_l1_reg_loss: 13182.1694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12649.0038; train_global_loss: 3978873.1873; train_optim_loss: 3978873.1873; val_kl_reg_loss: 22330.6919; val_edge_recon_loss: 947171.1379; val_cat_covariates_contrastive_loss: 952574.2467; val_gene_expr_recon_loss: 2069767.7416; val_masked_gp_l1_reg_loss: 13182.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12639.0918; val_global_loss: 4017665.0730; val_optim_loss: 4017665.0730
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9392; val_auprc_score: 0.9821; val_best_acc_score: 0.9298; val_best_f1_score: 0.9585; train_kl_reg_loss: 22624.2883; train_edge_recon_loss: 912627.6869; train_cat_covariates_contrastive_loss: 949637.7271; train_gene_expr_recon_loss: 2066926.6718; train_masked_gp_l1_reg_loss: 13188.7782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12649.3701; train_global_loss: 3977654.5166; train_optim_loss: 3977654.5166; val_kl_reg_loss: 22298.1493; val_edge_recon_loss: 944349.5676; val_cat_covariates_contrastive_loss: 953489.5389; val_gene_expr_recon_loss: 2072452.6782; val_masked_gp_l1_reg_loss: 13187.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12653.1016; val_global_loss: 4018430.4342; val_optim_loss: 4018430.4342
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9370; val_auprc_score: 0.9809; val_best_acc_score: 0.9301; val_best_f1_score: 0.9585; train_kl_reg_loss: 22631.6038; train_edge_recon_loss: 910395.1507; train_cat_covariates_contrastive_loss: 949632.6954; train_gene_expr_recon_loss: 2066961.5968; train_masked_gp_l1_reg_loss: 13189.5932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12642.7831; train_global_loss: 3975453.4180; train_optim_loss: 3975453.4180; val_kl_reg_loss: 22215.9880; val_edge_recon_loss: 945616.3059; val_cat_covariates_contrastive_loss: 952398.4566; val_gene_expr_recon_loss: 2071602.1722; val_masked_gp_l1_reg_loss: 13195.4502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12637.5352; val_global_loss: 4017665.9306; val_optim_loss: 4017665.9306

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9410; val_auprc_score: 0.9824; val_best_acc_score: 0.9299; val_best_f1_score: 0.9584; train_kl_reg_loss: 22587.9131; train_edge_recon_loss: 912803.9967; train_cat_covariates_contrastive_loss: 949870.5741; train_gene_expr_recon_loss: 2066686.1364; train_masked_gp_l1_reg_loss: 13094.3396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12498.8179; train_global_loss: 3977541.7794; train_optim_loss: 3977541.7794; val_kl_reg_loss: 22191.7767; val_edge_recon_loss: 957340.0167; val_cat_covariates_contrastive_loss: 952631.6244; val_gene_expr_recon_loss: 2071502.3469; val_masked_gp_l1_reg_loss: 13092.6553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12492.2119; val_global_loss: 4029250.7644; val_optim_loss: 4029250.7644
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9396; val_auprc_score: 0.9821; val_best_acc_score: 0.9294; val_best_f1_score: 0.9582; train_kl_reg_loss: 22616.9063; train_edge_recon_loss: 910556.2564; train_cat_covariates_contrastive_loss: 949910.8882; train_gene_expr_recon_loss: 2066181.5448; train_masked_gp_l1_reg_loss: 13092.5460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12492.1625; train_global_loss: 3974850.3041; train_optim_loss: 3974850.3041; val_kl_reg_loss: 22233.2203; val_edge_recon_loss: 945219.9513; val_cat_covariates_contrastive_loss: 950976.6785; val_gene_expr_recon_loss: 2069060.4952; val_masked_gp_l1_reg_loss: 13092.3369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12494.0254; val_global_loss: 4013076.6112; val_optim_loss: 4013076.6112
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9411; val_auprc_score: 0.9828; val_best_acc_score: 0.9301; val_best_f1_score: 0.9586; train_kl_reg_loss: 23762.7706; train_edge_recon_loss: 910520.8946; train_cat_covariates_contrastive_loss: 950046.9383; train_gene_expr_recon_loss: 2066658.9793; train_masked_gp_l1_reg_loss: 13092.7441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12493.1759; train_global_loss: 3976575.5020; train_optim_loss: 3976575.5020; val_kl_reg_loss: 22192.3091; val_edge_recon_loss: 944424.8627; val_cat_covariates_contrastive_loss: 954382.9572; val_gene_expr_recon_loss: 2071206.0987; val_masked_gp_l1_reg_loss: 13093.4854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12490.7256; val_global_loss: 4017790.4725; val_optim_loss: 4017790.4725
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9404; val_auprc_score: 0.9820; val_best_acc_score: 0.9304; val_best_f1_score: 0.9587; train_kl_reg_loss: 22635.6279; train_edge_recon_loss: 910641.8842; train_cat_covariates_contrastive_loss: 949959.3193; train_gene_expr_recon_loss: 2067034.1730; train_masked_gp_l1_reg_loss: 13093.8167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12490.8886; train_global_loss: 3975855.7124; train_optim_loss: 3975855.7124; val_kl_reg_loss: 22236.0470; val_edge_recon_loss: 952402.0461; val_cat_covariates_contrastive_loss: 950772.3346; val_gene_expr_recon_loss: 2070728.4599; val_masked_gp_l1_reg_loss: 13094.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12490.2969; val_global_loss: 4021723.3923; val_optim_loss: 4021723.3923
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9419; val_auprc_score: 0.9829; val_best_acc_score: 0.9314; val_best_f1_score: 0.9594; train_kl_reg_loss: 22616.0191; train_edge_recon_loss: 912845.0386; train_cat_covariates_contrastive_loss: 950077.8340; train_gene_expr_recon_loss: 2066139.8115; train_masked_gp_l1_reg_loss: 13094.0818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12489.6822; train_global_loss: 3977262.4728; train_optim_loss: 3977262.4728; val_kl_reg_loss: 22248.6572; val_edge_recon_loss: 935851.7641; val_cat_covariates_contrastive_loss: 954975.3490; val_gene_expr_recon_loss: 2071076.4408; val_masked_gp_l1_reg_loss: 13094.7803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12489.1699; val_global_loss: 4009736.2093; val_optim_loss: 4009736.2093
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9418; val_auprc_score: 0.9831; val_best_acc_score: 0.9299; val_best_f1_score: 0.9586; train_kl_reg_loss: 22598.5628; train_edge_recon_loss: 911753.7479; train_cat_covariates_contrastive_loss: 949727.7636; train_gene_expr_recon_loss: 2067596.7819; train_masked_gp_l1_reg_loss: 13095.2128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12489.6927; train_global_loss: 3977261.7690; train_optim_loss: 3977261.7690; val_kl_reg_loss: 22194.6019; val_edge_recon_loss: 943413.8651; val_cat_covariates_contrastive_loss: 953090.3858; val_gene_expr_recon_loss: 2070430.9306; val_masked_gp_l1_reg_loss: 13094.9502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12488.4551; val_global_loss: 4014713.2811; val_optim_loss: 4014713.2811
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9389; val_auprc_score: 0.9819; val_best_acc_score: 0.9296; val_best_f1_score: 0.9583; train_kl_reg_loss: 22586.6808; train_edge_recon_loss: 911254.5641; train_cat_covariates_contrastive_loss: 949820.0431; train_gene_expr_recon_loss: 2067053.5654; train_masked_gp_l1_reg_loss: 13095.9692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12490.3578; train_global_loss: 3976301.1763; train_optim_loss: 3976301.1763; val_kl_reg_loss: 30315.9734; val_edge_recon_loss: 938416.1767; val_cat_covariates_contrastive_loss: 950363.2638; val_gene_expr_recon_loss: 2071887.5126; val_masked_gp_l1_reg_loss: 13095.4307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12488.0166; val_global_loss: 4016566.4294; val_optim_loss: 4016566.4294
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9394; val_auprc_score: 0.9819; val_best_acc_score: 0.9287; val_best_f1_score: 0.9578; train_kl_reg_loss: 22608.5869; train_edge_recon_loss: 911836.3952; train_cat_covariates_contrastive_loss: 949920.5896; train_gene_expr_recon_loss: 2066017.9869; train_masked_gp_l1_reg_loss: 13095.7408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12487.9035; train_global_loss: 3975967.1987; train_optim_loss: 3975967.1987; val_kl_reg_loss: 22243.6412; val_edge_recon_loss: 950482.5580; val_cat_covariates_contrastive_loss: 949409.4818; val_gene_expr_recon_loss: 2071577.7045; val_masked_gp_l1_reg_loss: 13095.9111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12484.6201; val_global_loss: 4019293.8792; val_optim_loss: 4019293.8792
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9396; val_auprc_score: 0.9817; val_best_acc_score: 0.9295; val_best_f1_score: 0.9583; train_kl_reg_loss: 22589.3920; train_edge_recon_loss: 913334.5778; train_cat_covariates_contrastive_loss: 949803.2139; train_gene_expr_recon_loss: 2067250.4020; train_masked_gp_l1_reg_loss: 13096.0961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12488.1480; train_global_loss: 3978561.8309; train_optim_loss: 3978561.8309; val_kl_reg_loss: 22181.0606; val_edge_recon_loss: 943872.2213; val_cat_covariates_contrastive_loss: 953535.7096; val_gene_expr_recon_loss: 2070114.3325; val_masked_gp_l1_reg_loss: 13096.8057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12492.4297; val_global_loss: 4015292.5742; val_optim_loss: 4015292.5742

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9429; val_auprc_score: 0.9833; val_best_acc_score: 0.9302; val_best_f1_score: 0.9587; train_kl_reg_loss: 22639.8452; train_edge_recon_loss: 911358.1282; train_cat_covariates_contrastive_loss: 950077.4131; train_gene_expr_recon_loss: 2066238.3713; train_masked_gp_l1_reg_loss: 13086.7389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12478.7536; train_global_loss: 3975879.2826; train_optim_loss: 3975879.2826; val_kl_reg_loss: 22206.7198; val_edge_recon_loss: 951017.1241; val_cat_covariates_contrastive_loss: 955988.6429; val_gene_expr_recon_loss: 2071109.2895; val_masked_gp_l1_reg_loss: 13086.5879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12477.9141; val_global_loss: 4025886.2656; val_optim_loss: 4025886.2656
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9425; val_auprc_score: 0.9829; val_best_acc_score: 0.9303; val_best_f1_score: 0.9587; train_kl_reg_loss: 22587.1472; train_edge_recon_loss: 913712.6623; train_cat_covariates_contrastive_loss: 949854.8791; train_gene_expr_recon_loss: 2066333.6526; train_masked_gp_l1_reg_loss: 13086.5781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12477.4574; train_global_loss: 3978052.3265; train_optim_loss: 3978052.3265; val_kl_reg_loss: 22211.7511; val_edge_recon_loss: 959935.6438; val_cat_covariates_contrastive_loss: 953511.4722; val_gene_expr_recon_loss: 2070772.2596; val_masked_gp_l1_reg_loss: 13086.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12477.1230; val_global_loss: 4031994.6364; val_optim_loss: 4031994.6364
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9394; val_auprc_score: 0.9820; val_best_acc_score: 0.9305; val_best_f1_score: 0.9590; train_kl_reg_loss: 23426.1943; train_edge_recon_loss: 911431.0437; train_cat_covariates_contrastive_loss: 949609.2389; train_gene_expr_recon_loss: 2065787.9212; train_masked_gp_l1_reg_loss: 13086.5595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12476.8471; train_global_loss: 3975817.7481; train_optim_loss: 3975817.7481; val_kl_reg_loss: 22186.4160; val_edge_recon_loss: 953395.0278; val_cat_covariates_contrastive_loss: nan; val_gene_expr_recon_loss: 2070745.5975; val_masked_gp_l1_reg_loss: 13086.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12476.5645; val_global_loss: nan; val_optim_loss: nan
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9396; val_auprc_score: 0.9816; val_best_acc_score: 0.9301; val_best_f1_score: 0.9586; train_kl_reg_loss: 22587.0244; train_edge_recon_loss: 913275.8425; train_cat_covariates_contrastive_loss: 949488.0101; train_gene_expr_recon_loss: 2065981.3491; train_masked_gp_l1_reg_loss: 13086.6268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12476.4626; train_global_loss: 3976895.3155; train_optim_loss: 3976895.3155; val_kl_reg_loss: 22204.1017; val_edge_recon_loss: 952058.0144; val_cat_covariates_contrastive_loss: 956517.7898; val_gene_expr_recon_loss: 2070618.2111; val_masked_gp_l1_reg_loss: 13086.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12476.3740; val_global_loss: 4026961.1208; val_optim_loss: 4026961.1208
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9405; val_auprc_score: 0.9821; val_best_acc_score: 0.9300; val_best_f1_score: 0.9585; train_kl_reg_loss: 22579.9070; train_edge_recon_loss: 914230.4212; train_cat_covariates_contrastive_loss: 949783.0626; train_gene_expr_recon_loss: 2066697.7913; train_masked_gp_l1_reg_loss: 13086.7405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12476.2688; train_global_loss: 3978854.2062; train_optim_loss: 3978854.2062; val_kl_reg_loss: 22197.9573; val_edge_recon_loss: 950190.2330; val_cat_covariates_contrastive_loss: 954880.3403; val_gene_expr_recon_loss: 2070405.0783; val_masked_gp_l1_reg_loss: 13086.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12476.0039; val_global_loss: 4023236.3457; val_optim_loss: 4023236.3457
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9411; val_auprc_score: 0.9827; val_best_acc_score: 0.9300; val_best_f1_score: 0.9586; train_kl_reg_loss: 22576.8682; train_edge_recon_loss: 913189.5458; train_cat_covariates_contrastive_loss: 949791.7531; train_gene_expr_recon_loss: 2066385.9021; train_masked_gp_l1_reg_loss: 13086.7427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12476.0226; train_global_loss: 3977506.8585; train_optim_loss: 3977506.8585; val_kl_reg_loss: 22178.1762; val_edge_recon_loss: 942999.9297; val_cat_covariates_contrastive_loss: 954895.0227; val_gene_expr_recon_loss: 2070144.0837; val_masked_gp_l1_reg_loss: 13086.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12475.9248; val_global_loss: 4015779.9498; val_optim_loss: 4015779.9498
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9398; val_auprc_score: 0.9819; val_best_acc_score: 0.9299; val_best_f1_score: 0.9585; train_kl_reg_loss: 22581.1215; train_edge_recon_loss: 909001.1327; train_cat_covariates_contrastive_loss: 949969.2059; train_gene_expr_recon_loss: 2066793.3519; train_masked_gp_l1_reg_loss: 13086.7984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12475.9177; train_global_loss: 3973907.4972; train_optim_loss: 3973907.4972; val_kl_reg_loss: 31012.6331; val_edge_recon_loss: 945843.2010; val_cat_covariates_contrastive_loss: 953228.2910; val_gene_expr_recon_loss: 2070700.4091; val_masked_gp_l1_reg_loss: 13086.7832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12475.6855; val_global_loss: 4026347.0239; val_optim_loss: 4026347.0239

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9408; val_auprc_score: 0.9826; val_best_acc_score: 0.9301; val_best_f1_score: 0.9586; train_kl_reg_loss: 22577.1655; train_edge_recon_loss: 910723.5088; train_cat_covariates_contrastive_loss: 949668.3422; train_gene_expr_recon_loss: 2066720.4138; train_masked_gp_l1_reg_loss: 13085.7729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12474.2967; train_global_loss: 3975249.4670; train_optim_loss: 3975249.4670; val_kl_reg_loss: 22214.0611; val_edge_recon_loss: 946294.7952; val_cat_covariates_contrastive_loss: 953060.9764; val_gene_expr_recon_loss: 2070924.6824; val_masked_gp_l1_reg_loss: 13085.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12474.2539; val_global_loss: 4018054.5287; val_optim_loss: 4018054.5287
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9414; val_auprc_score: 0.9827; val_best_acc_score: 0.9300; val_best_f1_score: 0.9586; train_kl_reg_loss: 22585.2913; train_edge_recon_loss: 911862.2098; train_cat_covariates_contrastive_loss: 949684.8014; train_gene_expr_recon_loss: 2066635.3966; train_masked_gp_l1_reg_loss: 13085.7572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12474.2296; train_global_loss: 3976327.6991; train_optim_loss: 3976327.6991; val_kl_reg_loss: 22226.7815; val_edge_recon_loss: 945709.2608; val_cat_covariates_contrastive_loss: 952868.2111; val_gene_expr_recon_loss: 2070313.4862; val_masked_gp_l1_reg_loss: 13085.7529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12474.2119; val_global_loss: 4016677.7428; val_optim_loss: 4016677.7428
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9401; val_auprc_score: 0.9821; val_best_acc_score: 0.9297; val_best_f1_score: 0.9584; train_kl_reg_loss: 22570.6387; train_edge_recon_loss: 910501.1200; train_cat_covariates_contrastive_loss: 949944.0369; train_gene_expr_recon_loss: 2066969.2499; train_masked_gp_l1_reg_loss: 13085.7510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12474.1862; train_global_loss: 3975545.0463; train_optim_loss: 3975545.0463; val_kl_reg_loss: 22208.9616; val_edge_recon_loss: 955096.0909; val_cat_covariates_contrastive_loss: 953620.7500; val_gene_expr_recon_loss: 2071003.3337; val_masked_gp_l1_reg_loss: 13085.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12474.1631; val_global_loss: 4027489.1352; val_optim_loss: 4027489.1352
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9394; val_auprc_score: 0.9819; val_best_acc_score: 0.9292; val_best_f1_score: 0.9580; train_kl_reg_loss: 22587.2338; train_edge_recon_loss: 913687.2627; train_cat_covariates_contrastive_loss: 949860.5416; train_gene_expr_recon_loss: 2065990.4895; train_masked_gp_l1_reg_loss: 13085.7429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12474.1510; train_global_loss: 3977685.5260; train_optim_loss: 3977685.5260; val_kl_reg_loss: 22230.8183; val_edge_recon_loss: 960840.3729; val_cat_covariates_contrastive_loss: 953699.5673; val_gene_expr_recon_loss: 2071950.9205; val_masked_gp_l1_reg_loss: 13085.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12474.1533; val_global_loss: 4034281.6675; val_optim_loss: 4034281.6675

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 679 min 35 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9251
val AUPRC score: 0.9727
val best accuracy score: 0.9268
val best F1 score: 0.9566
val target rna MSE score: 0.4626
val source rna MSE score: 0.2269
Val cat covariate0 mean sim diff: -0.0015
Val cat covariate1 mean sim diff: -0.0493
Val cat covariate2 mean sim diff: -0.0011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
